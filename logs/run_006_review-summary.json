{
  "timestamp" : "2025-11-03T12:54:58.8798537",
  "index" : 6,
  "file" : "review-summary",
  "prompt" : {
    "role" : "user",
    "content" : "===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\DataFile.java =====\n```\npackage com.hom.ebmw.jpa.model;\r\n\r\nimport javax.persistence.Entity;\r\n\r\n/**\r\n * The persistent class for the AST_DATAFILE database table.\r\n */\r\n@Entity\r\npublic class DataFile extends AstFile {\r\n    private static final long serialVersionUID = 1L;\r\n}\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\DataFile.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\Filter.java =====\n```\npackage com.hom.ebmw.jpa.model;\r\n\r\nimport com.hom.ebmw.pojo.Context;\r\nimport com.hom.ebmw.utilities.enums.ObjectType;\r\nimport com.hom.ebmw.utilities.enums.SessionParams;\r\nimport lombok.Data;\r\n\r\nimport javax.persistence.*;\r\nimport java.io.Serializable;\r\nimport java.time.LocalDateTime;\r\nimport java.util.Objects;\r\nimport java.util.Optional;\r\n\r\nimport static com.hom.ebmw.utilities.constans.ASTConst.*;\r\n\r\n@Entity\r\n@Table(name = \"AST_FILTER\")\r\n@NamedQuery(name = \"Filter.findAll\", query = \"SELECT a FROM Filter a\")\r\n@Data\r\npublic class Filter implements Serializable {\r\n\r\n    private static final long serialVersionUID = 8584639550763633434L;\r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    @Column(name = \"ID\")\r\n    private int id;\r\n    @Column(name = \"NAME\")\r\n    private String name = \"\";\r\n    @OneToOne\r\n    @JoinColumn(name = \"CREATEBY\")\r\n    private User createBy = null;\r\n    @Column(name = \"CREATEON\")\r\n    private LocalDateTime createOn = null;\r\n    @OneToOne\r\n    @JoinColumn(name = \"UPDATEBY\")\r\n    private User updateBy = null;\r\n    @Column(name = \"UPDATEON\")\r\n    private LocalDateTime updateOn = null;\r\n    @OneToOne\r\n    @JoinColumn(name = \"DELETEBY\")\r\n    private User deleteBy = null;\r\n    @Column(name = \"DELETEON\")\r\n    private LocalDateTime deleteOn = null;\r\n    @Column(name = \"ACTIVE\")\r\n    private boolean active = false;\r\n    @Column(name = \"SORT_TYPE\")\r\n    private String sortType = \"\";\r\n    @OneToOne\r\n    @JoinColumn(name = \"PRV_ID\")\r\n    private User prvId = null;\r\n    @OneToOne\r\n    @JoinColumn(name = \"TM_ID\")\r\n    private Role team = null;\r\n    @Column(name = \"GLOBAL\")\r\n    private int global = -1;\r\n\r\n    public ObjectType getSortType() {\r\n        ObjectType type = null;\r\n        try {\r\n            type = ObjectType.valueOf(sortType.toUpperCase());\r\n        } catch (Exception e) {\r\n            type = ObjectType.EMPTY;\r\n        }\r\n        return type;\r\n    }\r\n\r\n    public void setSortType(ObjectType type) {\r\n        sortType = type.name();\r\n    }\r\n\r\n    public void setDate(User user) {\r\n        if (Objects.isNull(createBy)) {\r\n            createBy = user;\r\n            createOn = LocalDateTime.now();\r\n        }\r\n        updateBy = user;\r\n        updateOn = LocalDateTime.now();\r\n    }\r\n\r\n    public void setDelete(User user) {\r\n        deleteBy = user;\r\n        deleteOn = LocalDateTime.now();\r\n    }\r\n\r\n    public void setPrivate(User prvId) {\r\n        this.prvId = prvId;\r\n    }\r\n\r\n    public User getPrivate() {\r\n        return prvId;\r\n    }\r\n\r\n    public void setTeam(Role team) {\r\n        this.team = team;\r\n    }\r\n\r\n    public Role getTeam() {\r\n        return team;\r\n    }\r\n\r\n    public void setPrefix(String value, Context ctx) {\r\n        User current = ctx.getSession().getCurrentUser(ctx);\r\n        Role currentRole = ctx.getSession().get(SessionParams.ACTIVE_ROLE);\r\n        Optional<Role> adminRole = ctx.getServices().getRoleService().findById(1);\r\n        switch (value) {\r\n            case FILTER_PRV:\r\n                setGlobal(2);\r\n                setPrivate(current);\r\n                setTeam(null);\r\n                break;\r\n            case FILTER_GLB:\r\n                setGlobal(0);\r\n                setPrivate(null);\r\n                setTeam(null);\r\n                break;\r\n            case FILTER_TEAM:\r\n                setGlobal(1);\r\n                setPrivate(null);\r\n                setTeam(currentRole);\r\n                break;\r\n            case FILTER_ADM:\r\n                setGlobal(4);\r\n                setPrivate(null);\r\n                setTeam(adminRole.get());\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    public String getPrefix() {\r\n        String result = \"\";\r\n        if (global < 0) {\r\n            result = \"\";\r\n        } else if (Objects.isNull(prvId) && Objects.isNull(team)) {\r\n            result = FILTER_GLB;\r\n        } else if (Objects.isNull(prvId) && Objects.nonNull(team)) {\r\n            if (team.getName().equals(\"admin\")) {\r\n                result = FILTER_ADM;\r\n            } else {\r\n                result = team.getName() + \"_\";\r\n            }\r\n        } else if (Objects.nonNull(prvId) && Objects.isNull(team)) {\r\n            result = FILTER_PRV;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    public String getNameWithPrefix() {\r\n        return getPrefix() + name;\r\n    }\r\n\r\n    public void setGlobal(int global) {\r\n        this.global = global;\r\n    }\r\n\r\n    public int getGlobal() {\r\n        return global;\r\n    }\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\Filter.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\Filterbase.java =====\n```\npackage com.hom.ebmw.jpa.model;\r\n\r\nimport com.fasterxml.jackson.annotation.JsonIgnore;\r\nimport com.hom.ebmw.utilities.enums.FilterType;\r\nimport lombok.AllArgsConstructor;\r\nimport lombok.Getter;\r\nimport lombok.NoArgsConstructor;\r\nimport lombok.Setter;\r\n\r\nimport javax.persistence.*;\r\nimport java.io.Serializable;\r\nimport java.util.ArrayList;\r\nimport java.util.Collection;\r\nimport java.util.List;\r\nimport java.util.Objects;\r\n\r\n/**\r\n * The persistent class for the AST_FILTERBASE database table.\r\n */\r\n@Entity\r\n@Table(name = \"AST_FILTERBASE\")\r\n@NamedQuery(name = \"Filterbase.findAll\", query = \"SELECT a FROM Filterbase a\")\r\n@AllArgsConstructor\r\n@NoArgsConstructor\r\npublic class Filterbase implements Serializable {\r\n    private static final long serialVersionUID = 1L;\r\n\r\n    public static final int REMOVE = -1;\r\n    public static final int REMOVE_INDIVIDUAL = -2;\r\n    public static final int ADD = 1;\r\n    public static final int ADD_INDIVIDUAL = 2;\r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    @Column(name = \"ID\")\r\n    private int id;\r\n\r\n    @Column(name = \"CHILD_COUNT\")\r\n    private int childCount;\r\n\r\n    @Column(name = \"DIRECTION\")\r\n    private int direction;\r\n\r\n    // ENTITY_IDENTIFIER\r\n\r\n    @Column(name = \"ENTITY_IDENTIFIER\")\r\n    private String entityIdentifier;\r\n\r\n    @Column(name = \"IDENTIFIER\")\r\n    private String identifier;\r\n\r\n    @Column(name = \"[LABEL]\")\r\n    private String label;\r\n\r\n    @Column(name = \"[SORT]\")\r\n    private Integer sort;\r\n\r\n    @Column(name = \"STRUCTURE_GROUP_ID\")\r\n    private int structureGroupId;\r\n\r\n    @Column(name = \"STRUCTURE_TYPE\")\r\n    private String structureType = \"\";\r\n\r\n    @Column(name = \"[TYPE]\")\r\n    private String type;\r\n\r\n    @Column(name = \"[DELETE]\")\r\n    private @Getter\r\n    @Setter boolean delete;\r\n\r\n    @OneToOne\r\n    @JoinColumn(name = \"[FILTER_ID]\")\r\n    private Filter filter;\r\n\r\n    @OneToOne\r\n    @JoinColumn(name = \"ASSORTMENT_ID\")\r\n    private Assortment assortment;\r\n\r\n    // bi-directional many-to-one association to child\r\n    @ManyToOne\r\n    @JsonIgnore\r\n    @JoinColumn(name = \"PARENT_ID\")\r\n    private Filterbase parent;\r\n\r\n    // bi-directional many-to-one association to parent\r\n    @OneToMany(mappedBy = \"parent\")\r\n    private List<Filterbase> childs;\r\n\r\n    public int getId() {\r\n        return this.id;\r\n    }\r\n\r\n    public void setId(int id) {\r\n        this.id = id;\r\n    }\r\n\r\n    public int getChildCount() {\r\n        return childCount;\r\n    }\r\n\r\n    public void setChildCount(int childCount) {\r\n        this.childCount = childCount;\r\n    }\r\n\r\n    public int getDirection() {\r\n        return this.direction;\r\n    }\r\n\r\n    public void setDirection(int direction) {\r\n        this.direction = direction;\r\n    }\r\n\r\n    public String getIdentifier() {\r\n        return this.identifier;\r\n    }\r\n\r\n    public void setIdentifier(String identifier) {\r\n        this.identifier = identifier;\r\n    }\r\n\r\n    public String getEntityIdentifier() {\r\n        return entityIdentifier;\r\n    }\r\n\r\n    public void setEntityIdentifier(String entityIdentifier) {\r\n        this.entityIdentifier = entityIdentifier;\r\n    }\r\n\r\n    public String getLabel() {\r\n        return this.label;\r\n    }\r\n\r\n    public void setLabel(String label) {\r\n        this.label = label;\r\n    }\r\n\r\n    public Integer getSort() {\r\n        return this.sort;\r\n    }\r\n\r\n    public void setSort(Integer sort) {\r\n        this.sort = sort;\r\n    }\r\n\r\n    public int getStructureGroupId() {\r\n        return this.structureGroupId;\r\n    }\r\n\r\n    public void setStructureGroupId(int structureGroupId) {\r\n        this.structureGroupId = structureGroupId;\r\n    }\r\n\r\n    public String getStructureType() {\r\n        return structureType;\r\n    }\r\n\r\n    public void setStructureType(String structureType) {\r\n        this.structureType = structureType;\r\n    }\r\n\r\n    public String getType() {\r\n        return this.type;\r\n    }\r\n\r\n    public void setType(String type) {\r\n        this.type = type;\r\n    }\r\n\r\n    public void setType(FilterType type) {\r\n        this.type = type.name();\r\n    }\r\n\r\n    public Assortment getAssortment() {\r\n        return this.assortment;\r\n    }\r\n\r\n    public void setAssortment(Assortment assortment) {\r\n        this.assortment = assortment;\r\n    }\r\n\r\n    public Filterbase getParent() {\r\n        return this.parent;\r\n    }\r\n\r\n    public void setParent(Filterbase parent) {\r\n        this.parent = parent;\r\n    }\r\n\r\n    public Filter getFilter() {\r\n        return filter;\r\n    }\r\n\r\n    public void setFilter(Filter filter) {\r\n        this.filter = filter;\r\n    }\r\n\r\n    public List<Filterbase> getChilds() {\r\n        if (Objects.isNull(childs)) {\r\n            childs = new ArrayList<>();\r\n        } else {\r\n            childs.sort((o1, o2) -> o1.getSort().compareTo(o2.getSort()));\r\n        }\r\n        return this.childs;\r\n    }\r\n\r\n    public void setChilds(List<Filterbase> childs) {\r\n        this.childs = childs;\r\n    }\r\n\r\n    public void setChilds(Collection<Filterbase> childs) {\r\n        this.childs.clear();\r\n        this.childs.addAll(childs);\r\n    }\r\n}\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\Filterbase.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\ImpexExport.java =====\n```\npackage com.hom.ebmw.jpa.model;\r\n\r\nimport javax.persistence.Entity;\r\n\r\n/**\r\n * The persistent class for the AST_ASSORTMENT database table.\r\n */\r\n@Entity\r\npublic class ImpexExport extends AstFile {\r\n    private static final long serialVersionUID = 1L;\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\ImpexExport.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\LocalCustomer.java =====\n```\npackage com.hom.ebmw.jpa.model;\r\n\r\nimport com.fasterxml.jackson.annotation.JsonIgnore;\r\nimport com.hom.ebmw.ipim.model.Currency;\r\nimport com.hom.ebmw.ipim.model.Language;\r\nimport com.hom.ebmw.ipim.model.Territory;\r\nimport com.hom.ebmw.utilities.FilterUtils;\r\nimport com.hom.ebmw.utilities.constans.ASTConst;\r\nimport lombok.Data;\r\n\r\nimport javax.persistence.*;\r\nimport java.io.Serializable;\r\nimport java.util.Locale;\r\n\r\n\r\n/**\r\n * The persistent class for the AST_CUSTOMER database table.\r\n */\r\n@Entity\r\n@Data\r\n@Table(name = \"AST_CUSTOMER\")\r\n@NamedQuery(name = \"LocalCustomer.findAll\", query = \"SELECT a FROM LocalCustomer a\")\r\npublic class LocalCustomer implements Serializable {\r\n    private static final long serialVersionUID = 1L;\r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    @Column(name = \"ID\")\r\n    private int id;\r\n\r\n    @Column(name = \"CITY\")\r\n    private String city;\r\n\r\n    @Column(name = \"COMPANY_BRANCH\")\r\n    private String companyBranch;\r\n\r\n    @Column(name = \"COUNTRY\")\r\n    private String country;\r\n\r\n    @Column(name = \"CURRENCY\")\r\n    private String currency;\r\n\r\n    @Column(name = \"CUSTOMERID\")\r\n    private String customerId;\r\n\r\n    @Column(name = \"E_BUSINESS\")\r\n    private String eBusiness;\r\n\r\n    @Column(name = \"IS_BUYER\")\r\n    private boolean buyer;\r\n\r\n    @Column(name = \"IS_PROVIDER\")\r\n    private boolean provider;\r\n\r\n    @Column(name = \"IS_SUPPLIER\")\r\n    private boolean supplier;\r\n\r\n    @Column(name = \"ISDELETE\")\r\n    private boolean delete;\r\n\r\n    @Column(name = \"KAM\")\r\n    private String kam;\r\n\r\n    @Column(name = \"[LANGUAGE]\")\r\n    private String language;\r\n\r\n    @Column(name = \"NAME\")\r\n    private String name;\r\n\r\n    @Column(name = \"POSTAL\")\r\n    private String postal;\r\n\r\n    @Column(name = \"PRICELIST\")\r\n    private String pricelist;\r\n\r\n    @Column(name = \"STREET\")\r\n    private String street;\r\n\r\n    public void setCountryByEnum(Territory country) {\r\n        this.country = country.getKey();\r\n    }\r\n\r\n    public void setCurrencyByName(String currencyName) {\r\n        this.currency = FilterUtils.getCurrencyCode(currencyName, Locale.GERMANY);\r\n    }\r\n\r\n    public void setCurrencyByEnum(Currency currency) {\r\n        this.currency = currency.getKey();\r\n    }\r\n\r\n    public void setLanguageByEnum(Language language) {\r\n        this.language = language.getKey();\r\n    }\r\n\r\n    public void setPricelistByEnum(Territory pricelist) {\r\n        this.pricelist = pricelist.getKey();\r\n    }\r\n\r\n\r\n    @JsonIgnore\r\n    public String getCodeName() {\r\n        return \"(\" + customerId + \") \" + name;\r\n    }\r\n\r\n    @JsonIgnore\r\n    public String getFileContent() {\r\n        String content = \"\";\r\n        content += ASTConst.CUSTOMERFILEHEADER;\r\n        content += ASTConst.NL;\r\n        content += name + ASTConst.TAB;\r\n        content += customerId + ASTConst.TAB;\r\n        content += postal + ASTConst.TAB;\r\n        content += country + ASTConst.TAB;\r\n        content += companyBranch + ASTConst.TAB;\r\n        content += street + ASTConst.TAB;\r\n        content += eBusiness + ASTConst.TAB;\r\n        content += city + ASTConst.TAB;\r\n        content += language + ASTConst.TAB;\r\n        content += pricelist + ASTConst.TAB;\r\n        content += currency + ASTConst.TAB;\r\n        content += kam + ASTConst.TAB;\r\n\r\n        return content;\r\n    }\r\n}\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\LocalCustomer.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\Parameter.java =====\n```\npackage com.hom.ebmw.jpa.model;\r\n\r\nimport com.fasterxml.jackson.annotation.JsonIgnore;\r\nimport com.hom.ebmw.exceptions.ConvertException;\r\nimport com.hom.ebmw.utilities.Blob;\r\nimport lombok.Getter;\r\nimport lombok.Setter;\r\n\r\nimport javax.persistence.*;\r\nimport java.io.Serializable;\r\n\r\n@Entity\r\n@Table(name = \"AST_PARAMETER\")\r\n@NamedQuery(name = \"Parameter.findAll\", query = \"SELECT a FROM Parameter a\")\r\npublic class Parameter {\r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    @Column(name = \"ID\")\r\n    private @Getter\r\n    @Setter int id;\r\n\r\n    @Column(name = \"PARAM\")\r\n    private @Getter\r\n    @Setter String param = \"\";\r\n\r\n\r\n    @JsonIgnore\r\n    @Column(name = \"VALUE\") // save as Blob\r\n    private byte[] value = new byte[0];\r\n\r\n\r\n    @JsonIgnore\r\n    public <E> E getValue() {\r\n        return Blob.convertByte2Object(value);\r\n    }\r\n\r\n    public Object getParamValue() {\r\n        Object object = getValue();\r\n        try {\r\n            if (object.getClass().getCanonicalName().startsWith(\"com.hom.ebmw.\")) {\r\n                object = object.toString();\r\n            }\r\n            return object;\r\n        } catch (Exception e) {\r\n            return \"\";\r\n        }\r\n    }\r\n\r\n    @ManyToOne\r\n    @JoinColumn(name = \"FILE_ID\")\r\n    private @Getter\r\n    @Setter AstFile file;\r\n\r\n    @JsonIgnore\r\n    public <E> void setValue(E value) throws ConvertException {\r\n        if (value instanceof Serializable)\r\n            this.value = Blob.convertObject2Byte(value);\r\n        else {\r\n            throw new ConvertException(\"[\" + value.getClass().getName() + \"] Not Serializable\");\r\n        }\r\n    }\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\Parameter.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\Permission.java =====\n```\npackage com.hom.ebmw.jpa.model;\r\n\r\nimport javax.persistence.*;\r\nimport java.io.Serializable;\r\n\r\n\r\n/**\r\n * The persistent class for the AST_PERMISSION database table.\r\n */\r\n@Entity\r\n@Table(name = \"AST_PERMISSION\")\r\n@NamedQuery(name = \"Permission.findAll\", query = \"SELECT a FROM Permission a\")\r\npublic class Permission implements Serializable {\r\n    private static final long serialVersionUID = 1L;\r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    @Column(name = \"ID\")\r\n    private int id;\r\n\r\n    @Column(name = \"NAME\")\r\n    private String name;\r\n\r\n    public Permission() {\r\n    }\r\n\r\n    public Permission(String name) {\r\n        this.name = name;\r\n    }\r\n\r\n    public int getId() {\r\n        return this.id;\r\n    }\r\n\r\n    public void setId(int id) {\r\n        this.id = id;\r\n    }\r\n\r\n    public String getName() {\r\n        return this.name;\r\n    }\r\n\r\n    public void setName(String name) {\r\n        this.name = name;\r\n    }\r\n\r\n    public void setName(Class<?> clazz) {\r\n        this.name = clazz.getName();\r\n    }\r\n}\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\Permission.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\Project.java =====\n```\npackage com.hom.ebmw.jpa.model;\r\n\r\nimport lombok.Data;\r\n\r\nimport javax.persistence.*;\r\nimport java.io.Serializable;\r\n\r\n/**\r\n * The persistent class for the AST_PROJECT database table.\r\n */\r\n@Entity\r\n@Data\r\n@Table(name = \"AST_PROJECT\")\r\n@NamedQuery(name = \"Project.findAll\", query = \"SELECT a FROM Project a\")\r\npublic class Project implements Serializable {\r\n    private static final long serialVersionUID = 1L;\r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    @Column(name = \"ID\")\r\n    private long id;\r\n\r\n    @Column(name = \"CUSTOMER_NR\")\r\n    private String customerNr;\r\n}\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\Project.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\ProjectRole.java =====\n```\npackage com.hom.ebmw.jpa.model;\r\n\r\nimport javax.persistence.*;\r\nimport java.io.Serializable;\r\n\r\n\r\n/**\r\n * The persistent class for the AST_PROJECT_ROLE database table.\r\n */\r\n@Entity\r\n@Table(name = \"AST_PROJECT_ROLE\")\r\n@NamedQuery(name = \"ProjectRole.findAll\", query = \"SELECT a FROM ProjectRole a\")\r\npublic class ProjectRole implements Serializable {\r\n    private static final long serialVersionUID = 1L;\r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    @Column(name = \"ID\")\r\n    private int id;\r\n\r\n    //bi-directional many-to-one association to Project\r\n    @ManyToOne\r\n    @JoinColumn(name = \"PROJECT_ID\")\r\n    private Project project;\r\n\r\n    //bi-directional many-to-one association to Role\r\n    @ManyToOne\r\n    @JoinColumn(name = \"ROLE_ID\")\r\n    private Role role;\r\n\r\n    public ProjectRole() {\r\n    }\r\n\r\n    public int getId() {\r\n        return this.id;\r\n    }\r\n\r\n    public void setId(int id) {\r\n        this.id = id;\r\n    }\r\n\r\n    public Project getProject() {\r\n        return this.project;\r\n    }\r\n\r\n    public void setProject(Project project) {\r\n        this.project = project;\r\n    }\r\n\r\n    public Role getRole() {\r\n        return this.role;\r\n    }\r\n\r\n    public void setRole(Role role) {\r\n        this.role = role;\r\n    }\r\n\r\n    @Override\r\n    public String toString() {\r\n        return \"ID:\" + id + \"|PROJECT_ID:\" + project.getId() + \"|ROLE:ID\" + role.getId();\r\n    }\r\n}\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\ProjectRole.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\Promotion.java =====\n```\npackage com.hom.ebmw.jpa.model;\r\n\r\nimport javax.persistence.Entity;\r\n\r\n@Entity\r\npublic class Promotion extends AstFile {\r\n    private static final long serialVersionUID = 1L;\r\n\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\Promotion.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\PromotionExport.java =====\n```\npackage com.hom.ebmw.jpa.model;\r\n\r\nimport javax.persistence.Entity;\r\n\r\n@Entity\r\npublic class PromotionExport extends AstFile {\r\n    private static final long serialVersionUID = 1L;\r\n\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\PromotionExport.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\Role.java =====\n```\npackage com.hom.ebmw.jpa.model;\r\n\r\nimport lombok.Data;\r\n\r\nimport javax.persistence.*;\r\nimport java.io.Serializable;\r\n\r\n\r\n/**\r\n * The persistent class for the AST_ROLE database table.\r\n */\r\n@Entity\r\n@Table(name = \"AST_ROLE\")\r\n@Data\r\n@NamedQuery(name = \"Role.findAll\", query = \"SELECT a FROM Role a\")\r\npublic class Role implements Serializable {\r\n    private static final long serialVersionUID = 1L;\r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    @Column(name = \"ID\")\r\n    private int id;\r\n\r\n    @Column(name = \"INHERITS\")\r\n    private boolean inherits;\r\n\r\n    @Column(name = \"NAME\")\r\n    private String name;\r\n}\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\Role.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\RolePermission.java =====\n```\npackage com.hom.ebmw.jpa.model;\r\n\r\nimport lombok.Getter;\r\nimport lombok.Setter;\r\n\r\nimport javax.persistence.*;\r\nimport java.io.Serializable;\r\n\r\n\r\n/**\r\n * The persistent class for the AST_ROLE_PERMISSION database table.\r\n */\r\n@Entity\r\n@Table(name = \"AST_ROLE_PERMISSION\")\r\n@NamedQuery(name = \"RolePermission.findAll\", query = \"SELECT a FROM RolePermission a\")\r\npublic class RolePermission implements Serializable {\r\n    private static final long serialVersionUID = 1L;\r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    @Column(name = \"ID\")\r\n    private @Getter\r\n    @Setter int id;\r\n\r\n    @Column(name = \"ISDELETE\")\r\n    private @Getter\r\n    @Setter boolean delete = false;\r\n\r\n    @Column(name = \"ISREAD\")\r\n    private @Getter\r\n    @Setter boolean read = false;\r\n\r\n    @Column(name = \"ISEDIT\")\r\n    private @Getter\r\n    @Setter boolean edit = false;\r\n\r\n    @Column(name = \"ISWRITE\")\r\n    private @Getter\r\n    @Setter boolean write = false;\r\n\r\n    //bi-directional many-to-one association to Permission\r\n    @ManyToOne\r\n    @JoinColumn(name = \"PERMISSION_ID\")\r\n    private @Getter\r\n    @Setter Permission permission;\r\n\r\n    //bi-directional many-to-one association to Role\r\n    @ManyToOne\r\n    @JoinColumn(name = \"ROLE_ID\")\r\n    private @Getter\r\n    @Setter Role role;\r\n\r\n    public RolePermission() {\r\n    }\r\n}\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\RolePermission.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\RoleUser.java =====\n```\npackage com.hom.ebmw.jpa.model;\r\n\r\nimport javax.persistence.*;\r\nimport java.io.Serializable;\r\n\r\n\r\n/**\r\n * The persistent class for the AST_ROLE_USER database table.\r\n */\r\n@Entity\r\n@Table(name = \"AST_ROLE_USER\")\r\n@NamedQuery(name = \"RoleUser.findAll\", query = \"SELECT a FROM RoleUser a\")\r\npublic class RoleUser implements Serializable {\r\n    private static final long serialVersionUID = 1L;\r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    @Column(name = \"ID\")\r\n    private int id;\r\n\r\n    //bi-directional many-to-one association to Role\r\n    @ManyToOne\r\n    @JoinColumn(name = \"ROLE_ID\")\r\n    private Role role;\r\n\r\n    //bi-directional many-to-one association to User\r\n    @ManyToOne\r\n    @JoinColumn(name = \"USER_ID\")\r\n    private User user;\r\n\r\n    public RoleUser() {\r\n    }\r\n\r\n    public int getId() {\r\n        return this.id;\r\n    }\r\n\r\n    public void setId(int id) {\r\n        this.id = id;\r\n    }\r\n\r\n    public Role getRole() {\r\n        return this.role;\r\n    }\r\n\r\n    public void setRole(Role role) {\r\n        this.role = role;\r\n    }\r\n\r\n    public User getUser() {\r\n        return this.user;\r\n    }\r\n\r\n    public void setUser(User user) {\r\n        this.user = user;\r\n    }\r\n}\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\RoleUser.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\Setting.java =====\n```\npackage com.hom.ebmw.jpa.model;\r\n\r\nimport com.fasterxml.jackson.annotation.JsonIgnore;\r\n\r\nimport javax.persistence.*;\r\nimport java.io.Serializable;\r\nimport java.util.*;\r\n\r\n\r\n/**\r\n * The persistent class for the AST_SETTING database table.\r\n */\r\n@Entity\r\n@Table(name = \"AST_SETTING\")\r\n@NamedQuery(name = \"Setting.findAll\", query = \"SELECT a FROM Setting a\")\r\npublic class Setting implements Serializable {\r\n    private static final long serialVersionUID = 1L;\r\n\r\n    private static final String pattern = \"###\";\r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    @Column(name = \"ID\")\r\n    private int id;\r\n\r\n    @Column(name = \"DATATYPE\")\r\n    private String datatype;\r\n\r\n    @Column(name = \"IDENTIFIER\")\r\n    private String identifier;\r\n\r\n    @Column(name = \"[ROLES]\")\r\n    private String roles;\r\n\r\n    @Lob\r\n    @JsonIgnore\r\n    @Column(name = \"[VALUE]\")\r\n    private String value;\r\n\r\n    public Setting() {\r\n    }\r\n\r\n    public int getId() {\r\n        return this.id;\r\n    }\r\n\r\n    public void setId(int id) {\r\n        this.id = id;\r\n    }\r\n\r\n    public String getDatatype() {\r\n        return this.datatype;\r\n    }\r\n\r\n    public void setDatatype(String datatype) {\r\n        this.datatype = datatype;\r\n    }\r\n\r\n    public String getIdentifier() {\r\n        return this.identifier;\r\n    }\r\n\r\n    public void setIdentifier(String identifier) {\r\n        this.identifier = identifier;\r\n    }\r\n\r\n    public void addRoles(String roleId) {\r\n        List<String> roles = new ArrayList<String>();\r\n        if (!Objects.isNull(getAllRoles()) || !getAllRoles().isEmpty()) {\r\n            roles.addAll(getAllRoles());\r\n        }\r\n        Optional<String> findUser = roles.stream().filter(role -> role.equals(roleId)).findFirst();\r\n        if (!findUser.isPresent()) {\r\n            roles.add(roleId);\r\n        }\r\n        this.roles = \"\";\r\n        roles.forEach(role -> this.roles += (this.roles.length() > 0 ? pattern : \"\") + role);\r\n    }\r\n\r\n    public void setRoles(List<String> roles) {\r\n        this.roles = \"\";\r\n        roles.forEach(role -> this.roles += (this.roles.length() > 0 ? pattern : \"\") + role);\r\n    }\r\n\r\n    public List<String> getAllRoles() {\r\n        List<String> results = new ArrayList<String>();\r\n        if (Objects.isNull(roles)) roles = \"\";\r\n        if (roles.contains(pattern)) {\r\n            results.addAll(Arrays.asList(this.roles.split(pattern)));\r\n        } else {\r\n            if (roles.length() > 0)\r\n                results.add(roles);\r\n            else\r\n                roles = \"\";\r\n        }\r\n\r\n        return results;\r\n    }\r\n\r\n    public String getRoles() {\r\n        return roles;\r\n    }\r\n\r\n    public void setRoles(String roles) {\r\n        this.roles = roles;\r\n    }\r\n\r\n    public String getValue() {\r\n        return this.value;\r\n    }\r\n\r\n    public void setValue(String value) {\r\n        this.value = value;\r\n    }\r\n\r\n}\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\Setting.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\SettingParameter.java =====\n```\npackage com.hom.ebmw.jpa.model;\r\n\r\nimport com.fasterxml.jackson.annotation.JsonIgnore;\r\nimport com.hom.ebmw.exceptions.ConvertException;\r\nimport com.hom.ebmw.utilities.Blob;\r\nimport lombok.Getter;\r\nimport lombok.Setter;\r\n\r\nimport javax.persistence.*;\r\nimport java.io.Serializable;\r\n\r\n@Entity\r\n@Table(name = \"AST_SETTING_PARAMETER\")\r\n@NamedQuery(name = \"SettingParameter.findAll\", query = \"SELECT a FROM SettingParameter a\")\r\npublic class SettingParameter<E> {\r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    @Column(name = \"ID\")\r\n    private @Getter int id;\r\n\r\n    @Column(name = \"PARAM\")\r\n    private @Getter\r\n    @Setter String param = \"\";\r\n\r\n    @JsonIgnore\r\n    @Column(name = \"VALUE\") // save as Blob\r\n    private byte[] value = new byte[0];\r\n\r\n    @Column(name = \"DISPLAY_ORDER\")\r\n    private @Getter\r\n    @Setter Integer displayOrder = -1;\r\n\r\n    @ManyToOne\r\n    @JoinColumn(name = \"SETTING_ID\")\r\n    private @Getter\r\n    @Setter Setting setting;\r\n\r\n    public E getValue() {\r\n        return Blob.convertByte2Object(value);\r\n    }\r\n\r\n    public void setValue(E value) {\r\n        if (value instanceof Serializable) {\r\n            this.value = Blob.convertObject2Byte(value);\r\n        } else {\r\n            new ConvertException(\"[\" + value.getClass().getName() + \"] Not Serializable\");\r\n        }\r\n    }\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\SettingParameter.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\Storage.java =====\n```\npackage com.hom.ebmw.jpa.model;\r\n\r\nimport com.fasterxml.jackson.annotation.JsonIgnore;\r\nimport com.hom.ebmw.pojo.Context;\r\nimport com.hom.ebmw.utilities.Blob;\r\nimport com.hom.ebmw.utilities.SettingUtils;\r\nimport lombok.Data;\r\nimport lombok.extern.slf4j.Slf4j;\r\n\r\nimport javax.persistence.*;\r\nimport java.io.File;\r\nimport java.io.IOException;\r\n\r\n@Slf4j\r\n@Entity\r\n@Table(name = \"AST_STORAGE\")\r\n@NamedQuery(name = \"Storage.findAll\", query = \"SELECT a FROM Storage a\")\r\npublic @Data class Storage {\r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    @Column(name = \"ID\")\r\n    private int id;\r\n\r\n    @JsonIgnore\r\n    @Column(name = \"FILEBLOB\")\r\n    private byte[] fileblob = new byte[0];\r\n\r\n    @OneToOne\r\n    @JoinColumn(name = \"FILE_ID\")\r\n    private AstFile astFile;\r\n\r\n    @JsonIgnore\r\n    public File writeFile(Context ctx, String name) {\r\n        File file = new File(SettingUtils.getTempFolder(ctx) + name);\r\n        Blob.loadFromCompressedFile(fileblob, file);\r\n        return file;\r\n    }\r\n\r\n    @JsonIgnore\r\n    public void readFile(File file) {\r\n        try {\r\n            fileblob = Blob.save(file);\r\n        } catch (IOException e) {\r\n            log.error(e.getLocalizedMessage());\r\n        }\r\n    }\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\Storage.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\TemplateData.java =====\n```\npackage com.hom.ebmw.jpa.model;\r\n\r\nimport lombok.Data;\r\n\r\nimport javax.persistence.*;\r\n\r\n@Entity\r\n@Table(name = \"AST_TEMPLATE_DATA\")\r\n@NamedQuery(name = \"TemplateData.findAll\", query = \"SELECT a FROM TemplateData a\")\r\n@Data\r\npublic class TemplateData {\r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    @Column(name = \"ID\")\r\n    private long id;\r\n\r\n    @Column(name = \"TITLE\")\r\n    private String title = \"\";\r\n\r\n    @Column(name = \"SQL_QUERY\")\r\n    private String sqlQuery = \"SELECT 'CHANGE STATMENT AND RELOAD'\";\r\n\r\n    @Column(name = \"CHART_TYPE\")\r\n    private String chartType = \"TABLE\";\r\n\r\n    @Column(name = \"CHART_SERIES_NAME\")\r\n    private String chartSeriesName = \"\";\r\n\r\n    @Column(name = \"CHART_SERIES_VALUE\")\r\n    private String chartSeriesValue = \"\";\r\n\r\n    @Column(name = \"ACTIVE\")\r\n    private boolean active = false;\r\n\r\n    @Column(name = \"DELETED\")\r\n    private boolean deleted = false;\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\TemplateData.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\User.java =====\n```\npackage com.hom.ebmw.jpa.model;\r\n\r\nimport com.fasterxml.jackson.annotation.JsonIgnore;\r\nimport lombok.Data;\r\n\r\nimport javax.persistence.*;\r\nimport java.io.Serializable;\r\n\r\n/**\r\n * The persistent class for the AST_USER database table.\r\n */\r\n\r\n/**\r\n * @author robergf\r\n */\r\n@Entity\r\n@Table(name = \"AST_USER\")\r\n@NamedQuery(name = \"User.findAll\", query = \"SELECT a FROM User a\")\r\npublic @Data class User implements Serializable {\r\n    private static final long serialVersionUID = 1L;\r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    @Column(name = \"ID\")\r\n    private int id;\r\n\r\n    @Column(name = \"GIVEN_NAME\")\r\n    private String givenName;\r\n\r\n    @Column(name = \"SUR_NAME\")\r\n    private String surName;\r\n\r\n    @JsonIgnore\r\n    @Column(name = \"USER_ID\")\r\n    private String userId;\r\n\r\n    @Column(name = \"LOCALE\")\r\n    private String locale;\r\n\r\n    @JsonIgnore\r\n    @Column(name = \"ACTIVE\")\r\n    private boolean active = true;\r\n\r\n    @OneToOne\r\n    @JsonIgnore\r\n    @JoinColumn(name = \"ROLE_ID\")\r\n    private Role role;\r\n\r\n    @JsonIgnore\r\n    public String getFullName() {\r\n        return getGivenName() + \" \" + getSurName();\r\n    }\r\n}\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\User.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\UserParameter.java =====\n```\npackage com.hom.ebmw.jpa.model;\r\n\r\nimport com.hom.ebmw.exceptions.ConvertException;\r\nimport com.hom.ebmw.utilities.Blob;\r\nimport lombok.Getter;\r\nimport lombok.Setter;\r\n\r\nimport javax.persistence.*;\r\nimport java.io.Serializable;\r\nimport java.util.Objects;\r\n\r\n@Entity\r\n@Table(name = \"AST_USER_PARAMETER\")\r\n@NamedQuery(name = \"UserParameter.findAll\", query = \"SELECT a FROM UserParameter a\")\r\npublic class UserParameter {\r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    @Column(name = \"ID\")\r\n    private @Getter long id;\r\n\r\n\r\n    @Column(name = \"PARAM\")\r\n    private @Getter\r\n    @Setter String param;\r\n\r\n    @Column(name = \"VALUE\") // save as Blob\r\n    private byte[] value = new byte[0];\r\n\r\n    @ManyToOne\r\n    @JoinColumn(name = \"USER_ID\")\r\n    private @Getter\r\n    @Setter User user;\r\n\r\n    public <E> E getValue() {\r\n        return Blob.convertByte2Object(value);\r\n    }\r\n\r\n    public <E> void setValue(E value) {\r\n        if (Objects.isNull(value)) {\r\n            this.value = null;\r\n        } else if (value instanceof Serializable) {\r\n            this.value = Blob.convertObject2Byte(value);\r\n        } else {\r\n            new ConvertException(\"[\" + value.getClass().getName() + \"] Not Serializable\");\r\n        }\r\n    }\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\UserParameter.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\Zinfo.java =====\n```\npackage com.hom.ebmw.jpa.model;\r\n\r\nimport lombok.Getter;\r\nimport lombok.Setter;\r\n\r\nimport javax.persistence.*;\r\nimport java.io.Serializable;\r\n\r\n@Entity\r\n@Table(name = \"AST_ZINFO\")\r\n@NamedQuery(name = \"Zinfo.findAll\", query = \"SELECT a FROM Zinfo a\")\r\npublic class Zinfo\r\n        implements\r\n        Serializable {\r\n    private static final long serialVersionUID = 1L;\r\n\r\n    @Id\r\n    @Column(name = \"ID\")\r\n    private @Getter\r\n    @Setter String id;\r\n\r\n    @Column(name = \"ARTICLE_NR\")\r\n    private @Getter\r\n    @Setter String articleNr = \"\";\r\n\r\n    @Column(name = \"DESCRIPTION\")\r\n    private @Getter\r\n    @Setter String articleDescription = \"\";\r\n\r\n    @Column(name = \"TYPE\")\r\n    private @Getter\r\n    @Setter String type = \"\";\r\n\r\n    @Column(name = \"COMMENT\")\r\n    private @Getter\r\n    @Setter String comment = \"\";\r\n\r\n    @Column(name = \"PREVIEW_COMMENT\")\r\n    private @Getter\r\n    @Setter String preview_comment = \"\";\r\n\r\n    @ManyToOne\r\n    @JoinColumn(name = \"FILE_ID\")\r\n    private @Getter\r\n    @Setter ZinfoFile zinfoFile = null;\r\n\r\n}\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\Zinfo.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\ZinfoFile.java =====\n```\npackage com.hom.ebmw.jpa.model;\r\n\r\nimport javax.persistence.Entity;\r\n\r\n@Entity\r\npublic class ZinfoFile extends AstFile {\r\n    private static final long serialVersionUID = -2894122548763829844L;\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\jpa\\model\\ZinfoFile.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\BoundingBox.java =====\n```\npackage com.hom.ebmw.pojo;\r\n\r\nimport lombok.AllArgsConstructor;\r\nimport lombok.Data;\r\n\r\n@AllArgsConstructor\r\npublic @Data class BoundingBox {\r\n    private String right;\r\n    private String left;\r\n    private String top;\r\n    private String bottom;\r\n    private String width;\r\n    private String height;\r\n    private String x;\r\n    private String y;\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\BoundingBox.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\Context.java =====\n```\npackage com.hom.ebmw.pojo;\r\n\r\nimport com.hom.ebmw.configuration.security.Services;\r\nimport com.hom.ebmw.configuration.security.SessionUtils;\r\nimport com.hom.ebmw.utilities.enums.CTXAttribute;\r\nimport com.hom.ebmw.utilities.enums.Params;\r\nimport com.hom.ebmw.utilities.enums.SessionParams;\r\nimport com.vaadin.flow.server.WrappedSession;\r\nimport lombok.extern.slf4j.Slf4j;\r\nimport org.apache.catalina.session.StandardSessionFacade;\r\n\r\nimport javax.servlet.http.HttpSession;\r\nimport java.io.Serializable;\r\nimport java.util.*;\r\n\r\n@Slf4j\r\npublic class Context implements Serializable {\r\n    private static final long serialVersionUID = 1L;\r\n    private UUID uuid = null;\r\n    private final Map<CTXAttribute, Object> attributes = new EnumMap<>(CTXAttribute.class);\r\n\r\n    public Context() {\r\n        uuid = UUID.randomUUID();\r\n    }\r\n\r\n    public Context(UUID uuid) {\r\n        this.uuid = uuid;\r\n    }\r\n\r\n    public UUID getUuid() {\r\n        return uuid;\r\n    }\r\n\r\n    public void setUuid(UUID uuid) {\r\n        this.uuid = uuid;\r\n    }\r\n\r\n    public boolean isValid() {\r\n        return !attributes.isEmpty();\r\n    }\r\n\r\n    @SuppressWarnings(\"unchecked\")\r\n    public <E> E get(CTXAttribute key) {\r\n        return (E) attributes.get(key);\r\n    }\r\n\r\n    public <E> void put(CTXAttribute key, E value) {\r\n        this.attributes.put(key, value);\r\n    }\r\n\r\n    public SessionUtils getSession() {\r\n        return get(CTXAttribute.SESSION);\r\n    }\r\n\r\n    public Services getServices() {\r\n        return get(CTXAttribute.SERVICES);\r\n    }\r\n\r\n    @SuppressWarnings(\"unchecked\")\r\n    public <E> E getHttpAttribute(CTXAttribute key) {\r\n        E value = null;\r\n\r\n        if (get(CTXAttribute.HTTP_SESSION) instanceof WrappedSession) {\r\n            WrappedSession session = get(CTXAttribute.HTTP_SESSION);\r\n            value = (E) session.getAttribute(key.name());\r\n        }\r\n        if (get(CTXAttribute.HTTP_SESSION) instanceof HttpSession) {\r\n            HttpSession session = get(CTXAttribute.HTTP_SESSION);\r\n            value = (E) session.getAttribute(key.name());\r\n        }\r\n\r\n        return value;\r\n    }\r\n\r\n    public <E> void putHttpAttribute(CTXAttribute key, Object value) {\r\n        if (get(CTXAttribute.HTTP_SESSION) instanceof WrappedSession) {\r\n            WrappedSession session = get(CTXAttribute.HTTP_SESSION);\r\n            session.setAttribute(key.name(), value);\r\n        }\r\n        if (get(CTXAttribute.HTTP_SESSION) instanceof HttpSession) {\r\n            HttpSession session = get(CTXAttribute.HTTP_SESSION);\r\n            session.setAttribute(key.name(), value);\r\n        }\r\n    }\r\n\r\n    public void printAllHttpAttributes() {\r\n        if (get(CTXAttribute.HTTP_SESSION) instanceof WrappedSession) {\r\n            WrappedSession session = get(CTXAttribute.HTTP_SESSION);\r\n            session.getAttributeNames().forEach(k -> {\r\n                log.info(\"WrapperSession: [\" + k + \"] \" + session.getAttribute(k));\r\n            });\r\n        } else if (get(CTXAttribute.HTTP_SESSION) instanceof HttpSession) {\r\n            HttpSession session = get(CTXAttribute.HTTP_SESSION);\r\n            String k = session.getAttributeNames().nextElement();\r\n            while (session.getAttributeNames().hasMoreElements()) {\r\n                log.info(\"WrapperSession: [\" + k + \"] \" + session.getAttribute(k));\r\n                k = session.getAttributeNames().nextElement();\r\n            }\r\n        } else if (get(CTXAttribute.HTTP_SESSION) instanceof StandardSessionFacade) {\r\n            StandardSessionFacade session = get(CTXAttribute.HTTP_SESSION);\r\n            String k = session.getAttributeNames().nextElement();\r\n            while (session.getAttributeNames().hasMoreElements()) {\r\n                log.info(\"WrapperSession: [\" + k + \"] \" + session.getAttribute(k));\r\n                k = session.getAttributeNames().nextElement();\r\n            }\r\n        }\r\n    }\r\n\r\n    @SuppressWarnings(\"unchecked\")\r\n    public <E> E getHttpAttribute(SessionParams key) {\r\n        E value = null;\r\n\r\n        if (get(CTXAttribute.HTTP_SESSION) instanceof WrappedSession) {\r\n            WrappedSession session = get(CTXAttribute.HTTP_SESSION);\r\n            value = (E) session.getAttribute(key.getName());\r\n        } else if (get(CTXAttribute.HTTP_SESSION) instanceof HttpSession) {\r\n            HttpSession session = get(CTXAttribute.HTTP_SESSION);\r\n            value = (E) session.getAttribute(key.getName());\r\n        } else if (get(CTXAttribute.HTTP_SESSION) instanceof StandardSessionFacade) {\r\n            StandardSessionFacade session = get(CTXAttribute.HTTP_SESSION);\r\n            value = (E) session.getAttribute(key.getName());\r\n        }\r\n\r\n        return value;\r\n    }\r\n\r\n    public <E> void putHttpAttribute(SessionParams key, Object value) {\r\n        if (get(CTXAttribute.HTTP_SESSION) instanceof WrappedSession) {\r\n            WrappedSession session = get(CTXAttribute.HTTP_SESSION);\r\n            session.setAttribute(key.getName(), value);\r\n        } else if (get(CTXAttribute.HTTP_SESSION) instanceof HttpSession) {\r\n            HttpSession session = get(CTXAttribute.HTTP_SESSION);\r\n            session.setAttribute(key.getName(), value);\r\n        }\r\n    }\r\n\r\n    public UserSession getUserSession() {\r\n        return get(CTXAttribute.USER_SESSION);\r\n    }\r\n\r\n    public Set<CTXAttribute> keySet() {\r\n        return attributes.keySet();\r\n    }\r\n\r\n    public void refreshLocale() {\r\n        if (Objects.nonNull(getUserSession()))\r\n            getUserSession().put(Params.ACTIVE_LOCALE, getSession().getCurrentLocale(this));\r\n        else\r\n            log.error(\"UserSession not valid\");\r\n\r\n        if (Objects.nonNull(get(CTXAttribute.HTTP_SESSION)))\r\n            putHttpAttribute(SessionParams.LOCALE, getSession().getCurrentLocale(this));\r\n        else\r\n            log.error(\"HttpSession not valid\");\r\n    }\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\Context.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\CustomContainer.java =====\n```\npackage com.hom.ebmw.pojo;\r\n\r\nimport java.util.Collection;\r\nimport java.util.HashMap;\r\nimport java.util.Map;\r\n\r\npublic class CustomContainer<A> {\r\n\r\n    private final Map<Integer, A> article = new HashMap<Integer, A>();\r\n\r\n    public void putInArticle(Integer articleId, A columns) {\r\n        article.put(articleId, columns);\r\n    }\r\n\r\n    public A getArticle(Integer articleId) {\r\n        return article.get(articleId);\r\n    }\r\n\r\n    public Collection<A> getArticleValues() {\r\n        return article.values();\r\n    }\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\CustomContainer.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\CustomerLanguage.java =====\n```\npackage com.hom.ebmw.pojo;\r\n\r\nimport com.hom.ebmw.ipim.model.Language;\r\nimport com.hom.ebmw.jpa.model.LocalCustomer;\r\nimport lombok.Data;\r\n\r\nimport java.io.Serializable;\r\n\r\npublic @Data class CustomerLanguage implements Serializable {\r\n    private static final long serialVersionUID = 1L;\r\n\r\n    private LocalCustomer customer;\r\n    private Language language;\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\CustomerLanguage.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\CustomerPrefix.java =====\n```\npackage com.hom.ebmw.pojo;\r\n\r\nimport com.hom.ebmw.jpa.model.LocalCustomer;\r\nimport lombok.Data;\r\n\r\nimport java.io.Serializable;\r\n\r\npublic @Data class CustomerPrefix implements Serializable {\r\n    private static final long serialVersionUID = 1L;\r\n\r\n    private LocalCustomer customer;\r\n\r\n    private String ecat;\r\n    private String impex;\r\n    private String promotion;\r\n}\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\CustomerPrefix.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\Delay.java =====\n```\npackage com.hom.ebmw.pojo;\r\n\r\nimport com.hom.ebmw.utilities.enums.ObjectType;\r\nimport lombok.Data;\r\n\r\nimport java.io.Serializable;\r\n\r\npublic @Data class Delay implements Serializable {\r\n    private static final long serialVersionUID = -5030684514914319104L;\r\n\r\n    private String prefix;\r\n    private ObjectType type;\r\n    private int days;\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\Delay.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\DelayWrapper.java =====\n```\npackage com.hom.ebmw.pojo;\r\n\r\nimport com.hom.ebmw.jpa.model.LocalCustomer;\r\nimport com.hom.ebmw.utilities.enums.ObjectType;\r\nimport lombok.Data;\r\n\r\nimport java.time.LocalDate;\r\n\r\npublic @Data class DelayWrapper {\r\n    private int id;\r\n    private String name;\r\n    private LocalDate validFrom;\r\n    private ObjectType type;\r\n    private LocalCustomer customer;\r\n    private int queueId;\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\DelayWrapper.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\DelimiterType.java =====\n```\npackage com.hom.ebmw.pojo;\r\n\r\nimport lombok.AllArgsConstructor;\r\nimport lombok.Data;\r\n\r\n@Data\r\n@AllArgsConstructor\r\npublic class DelimiterType {\r\n    private String name = \"\";\r\n    private String type = \"\";\r\n\r\n\r\n}\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\DelimiterType.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\Header.java =====\n```\npackage com.hom.ebmw.pojo;\r\n\r\nimport lombok.AllArgsConstructor;\r\nimport lombok.Data;\r\n\r\n@Data\r\n@AllArgsConstructor\r\npublic class Header {\r\n    private String value = \"\";\r\n    private Integer id = 0;\r\n}\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\Header.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\KatalogVersion.java =====\n```\npackage com.hom.ebmw.pojo;\r\n\r\nimport com.hom.ebmw.utilities.enums.ObjectType;\r\nimport lombok.Data;\r\n\r\nimport java.io.Serializable;\r\nimport java.time.LocalDate;\r\n\r\n@Data\r\npublic class KatalogVersion implements Serializable {\r\n\r\n    private static final long serialVersionUID = 737930566873803335L;\r\n\r\n    private String version;\r\n    private LocalDate validFrom;\r\n    private LocalDate validTo;\r\n    private String pimAssortmentName;\r\n    private String pimAssortmentCategory;\r\n    /* AbwrtsKompatiblitt */\r\n    private ObjectType type = ObjectType.BOTH;\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\KatalogVersion.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\LayoutAutomation.java =====\n```\npackage com.hom.ebmw.pojo;\r\n\r\n\r\nimport com.fasterxml.jackson.annotation.JsonProperty;\r\nimport lombok.Data;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\npublic @Data class LayoutAutomation {\r\n    private String id;\r\n    private String name;\r\n    private String customer;\r\n    @JsonProperty(\"customer-name\")\r\n    private String customerName;\r\n    private String language;\r\n    private String territory;\r\n    private String currency;\r\n    @JsonProperty(\"valid-from\")\r\n    private String validFrom;\r\n    @JsonProperty(\"valid-to\")\r\n    private String validTo;\r\n    @JsonProperty(\"catalog-version\")\r\n    private String catalogVersion;\r\n    private List<String> articles = new ArrayList<>();\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\LayoutAutomation.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\MultiLanguage.java =====\n```\npackage com.hom.ebmw.pojo;\r\n\r\nimport com.hom.ebmw.ipim.model.Language;\r\nimport lombok.Data;\r\n\r\nimport java.io.Serializable;\r\n\r\n@SuppressWarnings(\"serial\")\r\npublic @Data class MultiLanguage implements Serializable {\r\n\r\n    private Language key;\r\n    private String value = \"\";\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\MultiLanguage.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\PartnerShort.java =====\n```\npackage com.hom.ebmw.pojo;\r\n\r\nimport lombok.Getter;\r\nimport lombok.Setter;\r\n\r\nimport java.io.Serializable;\r\n\r\npublic class PartnerShort implements Serializable {\r\n    private static final long serialVersionUID = 1L;\r\n\r\n    private @Getter\r\n    @Setter String id;\r\n    private @Getter\r\n    @Setter String name;\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\PartnerShort.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\Position.java =====\n```\npackage com.hom.ebmw.pojo;\r\n\r\nimport lombok.AllArgsConstructor;\r\nimport lombok.Data;\r\n\r\n@AllArgsConstructor\r\npublic @Data class Position {\r\n    private String top;\r\n    private String left;\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\Position.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\RoleBox.java =====\n```\npackage com.hom.ebmw.pojo;\r\n\r\nimport com.hom.ebmw.jpa.model.Role;\r\nimport com.hom.ebmw.jpa.model.User;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\npublic class RoleBox {\r\n\r\n    private String name = \"\";\r\n    private List<RoleBox> nodes = new ArrayList<RoleBox>();\r\n    private User leaf;\r\n    private Role node;\r\n\r\n    public String getName() {\r\n        return name;\r\n    }\r\n\r\n    public void setName(String name) {\r\n        this.name = name;\r\n    }\r\n\r\n    public List<RoleBox> getNodes() {\r\n        nodes.sort((o1, o2) -> o1.getName().compareTo(o2.getName()));\r\n        return nodes;\r\n    }\r\n\r\n    public void setNodes(List<RoleBox> nodes) {\r\n        this.nodes = nodes;\r\n    }\r\n\r\n    public User getLeaf() {\r\n        return leaf;\r\n    }\r\n\r\n    public void setLeaf(User leaf) {\r\n        this.leaf = leaf;\r\n    }\r\n\r\n    public Role getNode() {\r\n        return node;\r\n    }\r\n\r\n    public void setNode(Role node) {\r\n        this.node = node;\r\n    }\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\RoleBox.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\S3Catalog.java =====\n```\npackage com.hom.ebmw.pojo;\r\n\r\nimport lombok.Data;\r\n\r\nimport java.io.Serializable;\r\n\r\n@SuppressWarnings(\"serial\")\r\n@Data\r\npublic class S3Catalog implements Serializable {\r\n    private String primary;\r\n    private String alternate;\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\S3Catalog.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\Structure.java =====\n```\npackage com.hom.ebmw.pojo;\r\n\r\nimport lombok.Getter;\r\nimport lombok.Setter;\r\n\r\nimport java.io.Serializable;\r\n\r\npublic class Structure implements Serializable {\r\n    private static final long serialVersionUID = 1L;\r\n\r\n    private @Getter\r\n    @Setter String name;\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\Structure.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\Translation.java =====\n```\npackage com.hom.ebmw.pojo;\r\n\r\nimport lombok.Data;\r\n\r\nimport java.util.HashMap;\r\nimport java.util.Map;\r\n\r\npublic @Data class Translation {\r\n\r\n    private String key;\r\n    private Map<String, String> translations = new HashMap<String, String>();\r\n\r\n    @Override\r\n    public String toString() {\r\n        return \"Key: \" + getKey() + \", Translation: \" + translations.toString();\r\n    }\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\Translation.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\UserSession.java =====\n```\npackage com.hom.ebmw.pojo;\r\n\r\nimport com.hom.ebmw.utilities.enums.Params;\r\nimport com.vaadin.flow.spring.annotation.SpringComponent;\r\n\r\nimport java.io.Serializable;\r\nimport java.util.HashMap;\r\nimport java.util.Map;\r\nimport java.util.Objects;\r\nimport java.util.UUID;\r\n\r\n@SpringComponent\r\npublic class UserSession implements Serializable {\r\n    private static final long serialVersionUID = 1L;\r\n\r\n    private final String id = UUID.randomUUID().toString();\r\n\r\n    private final Map<String, Object> attribute = new HashMap<String, Object>();\r\n\r\n    public String getId() {\r\n        return id;\r\n    }\r\n\r\n    public void put(Params key, Object value) {\r\n        put(key.getName(), value);\r\n    }\r\n\r\n    public boolean exists(Params key) {\r\n        return existParams(key.getName());\r\n    }\r\n\r\n    private boolean existParams(String key) {\r\n        Object obj = attribute.get(key);\r\n        return Objects.nonNull(obj);\r\n    }\r\n\r\n    public void put(String key, Object value) {\r\n        attribute.put(key, value);\r\n    }\r\n\r\n    public void remove(Params key) {\r\n        attribute.remove(key.getName());\r\n    }\r\n\r\n    public void remove(String key) {\r\n        attribute.remove(key);\r\n    }\r\n\r\n    @SuppressWarnings(\"unchecked\")\r\n    public <E> E get(Params key) {\r\n        return (E) attribute.get(key.getName());\r\n    }\r\n\r\n    @SuppressWarnings(\"unchecked\")\r\n    public <E> E get(String key) {\r\n        return (E) attribute.get(key);\r\n    }\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\UserSession.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\ZinfoTypeDetail.java =====\n```\npackage com.hom.ebmw.pojo;\r\n\r\nimport lombok.Getter;\r\nimport lombok.Setter;\r\n\r\nimport java.io.Serializable;\r\n\r\npublic class ZinfoTypeDetail implements Serializable {\r\n    private static final long serialVersionUID = 1L;\r\n\r\n    private @Getter\r\n    @Setter String type;\r\n    private @Getter\r\n    @Setter String description;\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\pojo\\ZinfoTypeDetail.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\rest\\AbstractApi.java =====\n```\npackage com.hom.ebmw.rest;\r\n\r\nimport com.hom.ebmw.configuration.security.Services;\r\nimport com.hom.ebmw.configuration.security.SessionUtils;\r\nimport com.hom.ebmw.ipim.model.Currency;\r\nimport com.hom.ebmw.ipim.model.Language;\r\nimport com.hom.ebmw.ipim.model.Territory;\r\nimport com.hom.ebmw.jpa.model.*;\r\nimport com.hom.ebmw.pojo.Context;\r\nimport com.hom.ebmw.pojo.CustomerLanguage;\r\nimport com.hom.ebmw.pojo.KatalogVersion;\r\nimport com.hom.ebmw.pojo.UserSession;\r\nimport com.hom.ebmw.utilities.*;\r\nimport com.hom.ebmw.utilities.constans.ASTConst;\r\nimport com.hom.ebmw.utilities.enums.*;\r\nimport lombok.extern.slf4j.Slf4j;\r\nimport org.apache.commons.io.IOUtils;\r\nimport org.hibernate.validator.internal.util.stereotypes.Lazy;\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\nimport org.springframework.web.multipart.MultipartFile;\r\n\r\nimport javax.servlet.http.HttpServletResponse;\r\nimport javax.servlet.http.HttpSession;\r\nimport javax.ws.rs.BadRequestException;\r\nimport java.io.*;\r\nimport java.util.*;\r\n\r\n\r\n@Slf4j\r\nabstract class AbstractApi {\r\n\r\n    @Autowired\r\n    @Lazy\r\n    protected Services services;\r\n\r\n    /**\r\n     * The initial function is called by the servlet to initialize a context for each request.\r\n     * The context is used to store information about the user's session, and other data that\r\n     * needs to be passed between functions. This function creates a new Context object, and then\r\n     * adds several attributes: SessionUtils (a class that contains methods for interacting with sessions),\r\n     * Services (the services layer of our application), UserSession (an object containing information about the current user's session) and HttpSession(the actual HTTP session). It also catches any exceptions thrown by these objects' constructors. If an exception occurs\r\n     *\r\n     * @param HttpSession session Set the httpsession in the context\r\n     * @return A context object, which is then passed to the next function in the chain\r\n     */\r\n    protected Context initial(HttpSession session) {\r\n        Context ctx = new Context();\r\n        try {\r\n            SessionUtils utils = new SessionUtils(services.getUserServices());\r\n            ctx.put(CTXAttribute.SESSION, utils);\r\n            ctx.put(CTXAttribute.SERVICES, services);\r\n            ctx.put(CTXAttribute.USER_SESSION, new UserSession());\r\n            ctx.put(CTXAttribute.HTTP_SESSION, session);\r\n\r\n        } catch (Exception e) {\r\n            log.error(\"Could not Build Context\", e);\r\n        }\r\n        return ctx;\r\n    }\r\n\r\n    /**\r\n     * The download function is used to download a file from the database.\r\n     * It takes in an HttpServletResponse, HttpSession, AstFile and String as parameters.\r\n     * The function first gets the context of the session using getContent(session).\r\n     * If astFile is not null then it finds a storage object that has an astfile with the same id as astFile's id.\r\n     * If there exists such a storage object then it creates a new File called file which stores all of its data in SettingUtils' temp folder + astFiles name (which should be unique).\r\n     * Then we load\r\n     *\r\n     * @param HttpServletResponse response Send the file to the client\r\n     * @param HttpSession         session Get the context\r\n     *                            protected context getcontent(httpsession session) {\r\n     *                            return (context) session\r\n     * @param AstFile             astFile Get the file from the database\r\n     * @param String              entity Throw an exception if the file is not found\r\n     * @return A file\r\n     */\r\n    protected void download(HttpServletResponse response, HttpSession session, AstFile astFile, String entity)\r\n            throws FileNotFoundException {\r\n        Context ctx = getContent(session);\r\n        if (Objects.nonNull(astFile)) {\r\n            Optional<Storage> optStorage = services.getStorageService().findByAstFile(astFile);\r\n            if (optStorage.isPresent()) {\r\n                File file = new File(SettingUtils.getTempFolder(ctx) + astFile.getName());\r\n                Blob.loadFromCompressedFile(optStorage.get().getFileblob(), file);\r\n                try (InputStream fileInput = new FileInputStream(file)) {\r\n                    response.addHeader(\"Content-disposition\", \"attachment;filename=\\\"\" + file.getName() + \"\\\"\");\r\n                    response.setContentType(\"txt/plain\");\r\n\r\n                    IOUtils.copy(fileInput, response.getOutputStream());\r\n                    response.flushBuffer();\r\n                } catch (Exception e) {\r\n                    log.error(\"Could not write Response\", e);\r\n                }\r\n            } else {\r\n                throw new FileNotFoundException();\r\n            }\r\n        } else {\r\n            throw new javax.persistence.EntityNotFoundException(entity);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * The returnValue function is a helper function that takes an Optional&lt;T&gt; and returns the value of type T if it exists, or null otherwise.\r\n     *\r\n     * @param final Optional&lt;E&gt; value Return a value\r\n     * @return The value of the optional if it is present, or null otherwise\r\n     */\r\n    protected <E> E returnValue(final Optional<E> value) {\r\n        if (value.isPresent()) {\r\n            return value.get();\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * The createDataFile function is used to create a DataFile object from the multipart file that was uploaded by the user.\r\n     * The function first creates a temporary file and then loads it with data from the multipart file.\r\n     * It then uses ConvertUtils to get an ArticleBase object, which is added to an ArrayList of active articles in UserSession.\r\n     * If there are no active articles, or if they have no article number (which would indicate that they were not created properly),\r\n     * BadRequestException is thrown and nothing else happens. Otherwise, saveDataFile() is called on this list of ArticlesBase objects\r\n     *\r\n     * @param Context       ctx Get the current user session\r\n     * @param MultipartFile multipart Get the file from the request\r\n     * @param ProjectRole   projectRole Determine the role of the user who is uploading a file\r\n     * @param Locale        locale Determine the language of the error message\r\n     * @return A datafile object\r\n     */\r\n    protected DataFile createDataFile(Context ctx, MultipartFile multipart, ProjectRole projectRole, Locale locale) {\r\n        File file = null;\r\n        DataFile dataFile = null;\r\n\r\n        ctx.getUserSession().put(Params.ACTIVE_ARTICLES, new ArrayList<ArticleBase>());\r\n        String fileName = SettingUtils.getTempFolder(ctx) + multipart.getOriginalFilename();\r\n        try {\r\n            file = new File(fileName);\r\n            Blob.loadFromFile(IOUtils.toByteArray(multipart.getInputStream()), file);\r\n            // setActive_Articles\r\n            ConvertUtils.getFileType(ctx, file, null);\r\n        } catch (IOException e) {\r\n            log.error(e.getLocalizedMessage());\r\n        } catch (NullPointerException e) {\r\n            log.error(e.getLocalizedMessage());\r\n        }\r\n        List<ArticleBase> articles = ctx.getUserSession().get(Params.ACTIVE_ARTICLES);\r\n        if (Objects.isNull(articles)) {\r\n            throw new BadRequestException();\r\n        } else {\r\n            if (!articles.isEmpty()) {\r\n                if (articles.get(0).getArticleNr().length() == 0) {\r\n                    articles.clear();\r\n                    throw new BadRequestException();\r\n                } else {\r\n                    dataFile = saveDataFile(ctx, articles, projectRole, locale);\r\n                }\r\n            } else {\r\n                throw new BadRequestException();\r\n            }\r\n        }\r\n\r\n        return dataFile;\r\n    }\r\n\r\n    /**\r\n     * The saveDataFile function saves the data file to the database.\r\n     *\r\n     * @param Context                 ctx Get the current user and to set parameters\r\n     * @param List&lt;ArticleBase&gt; articles Create the data file\r\n     * @param ProjectRole             projectRole Set the project role of the data file\r\n     * @param Locale                  locale Get the language of the file\r\n     * @return The datafile object\r\n     */\r\n    protected DataFile saveDataFile(Context ctx, List<ArticleBase> articles, ProjectRole projectRole, Locale locale) {\r\n        DataFile dataFile = new DataFile();\r\n        dataFile.setDate(ctx.getSession().getCurrentUser(ctx));\r\n        dataFile = services.getDataFileService().save(dataFile);\r\n        setDefaultParameterToDataFile(ctx, articles, dataFile);\r\n\r\n        dataFile.setProjectRole(projectRole);\r\n        dataFile = services.getDataFileService().save(dataFile);\r\n        setDefaultParameterToDataFile(ctx, articles, dataFile);\r\n\r\n        if (articles.get(0).getPriceFirst().isEmpty()) {\r\n            CompUtils.setParameter(ctx, FileParam.FILE_TYPE, ObjectType.ECAT_INPUT_POSITIV, dataFile);\r\n            dataFile.setName(ExportFileUtils.buildPositivFileName(ctx, dataFile));\r\n            CompUtils.saveStorage(ctx, dataFile, ExportFileUtils.buildPositivFile(ctx, articles, ASTConst.DEFAULT));\r\n        } else {\r\n            CompUtils.setParameter(ctx, FileParam.FILE_TYPE, ObjectType.ECAT_INPUT, dataFile);\r\n            dataFile.setName(ExportFileUtils.buildPriceFileName(ctx, dataFile));\r\n            CompUtils.saveStorage(ctx, dataFile,\r\n                    ExportFileUtils.buildPriceFile(ctx, articles, ASTConst.DEFAULT, dataFile));\r\n            ArticleBase first = articles.get(0);\r\n\r\n            List<Currency> currencies = services.getEnumerationService().getAllCurrencies();\r\n            List<Language> languages = services.getEnumerationService().getAllLanguages();\r\n            List<Territory> territories = services.getEnumerationService().getAllTerritories();\r\n            DataFile save = dataFile;\r\n\r\n            if (!first.getCurrency().isEmpty()) {\r\n                Optional<Currency> optCurr = currencies.stream()\r\n                        .filter(item -> item.getKey().equals(first.getCurrency())).findFirst();\r\n                optCurr.ifPresent(item -> CompUtils.setParameter(ctx, FileParam.CURRENCY, item, save));\r\n            }\r\n            if (!first.getTerritory().isEmpty()) {\r\n                final String territory = locale.toLanguageTag();\r\n                if (territory.contains(\"-\")) {\r\n                    Optional<Language> optLang = languages.stream().filter(item -> item.getLabel().equals(territory))\r\n                            .findFirst();\r\n                    optLang.ifPresent(item -> CompUtils.setParameter(ctx, FileParam.LANGUAGE, item, save));\r\n                }\r\n                Optional<Territory> optTerr = territories.stream()\r\n                        .filter(item -> item.getKey().equals(territory.split(\"-\")[1])).findFirst();\r\n                optTerr.ifPresent(item -> CompUtils.setParameter(ctx, FileParam.TERRITORY, item, save));\r\n            }\r\n\r\n            KatalogVersion version = CompUtils.getKatalogVersion(ctx, save);\r\n            CompUtils.setParameter(ctx, FileParam.KATALOG_VERSION, version, save);\r\n\r\n            if (!first.getValidFrom().isEmpty()) {\r\n                CompUtils.setParameter(ctx, FileParam.VALID_FROM, first.getValidFromAsLocalDate(), save);\r\n            }\r\n\r\n            if (!first.getValidTo().isEmpty()) {\r\n                CompUtils.setParameter(ctx, FileParam.VALID_TO, first.getValidToAsLocalDate(), save);\r\n            }\r\n        }\r\n        dataFile = services.getDataFileService().save(dataFile);\r\n        setLanguageParamByCustomer(ctx, dataFile);\r\n        return dataFile;\r\n    }\r\n\r\n    /**\r\n     * The setDefaultParameterToDataFile function sets the default parameters for the data file.\r\n     *\r\n     * @param Context                 ctx Access the services and other information of the current context\r\n     * @param List&lt;ArticleBase&gt; articles Get the territory, currency, validfrom and validto parameters\r\n     * @param AstFile                 dataFile Set the parameters to the data file\r\n     */\r\n    protected void setDefaultParameterToDataFile(Context ctx, List<ArticleBase> articles, AstFile dataFile) {\r\n        if (!articles.isEmpty()) {\r\n            ArticleBase article = articles.get(0);\r\n            if (!article.getTerritory().isEmpty()) {\r\n                List<Territory> territories = ctx.getServices().getEnumerationService().getAllTerritories();\r\n                Optional<Territory> optTerritory = territories.stream()\r\n                        .filter(item -> item.getKey().equals(article.getTerritory())).findFirst();\r\n                optTerritory.ifPresent(item -> CompUtils.setParameter(ctx, FileParam.TERRITORY, item, dataFile));\r\n            }\r\n\r\n            if (!article.getCurrency().isEmpty()) {\r\n                List<Currency> currencies = ctx.getServices().getEnumerationService().getAllCurrencies();\r\n                Optional<Currency> optCurrency = currencies.stream()\r\n                        .filter(item -> item.getKey().equals(article.getCurrency())).findFirst();\r\n                optCurrency.ifPresent(item -> CompUtils.setParameter(ctx, FileParam.CURRENCY, item, dataFile));\r\n\r\n            }\r\n\r\n            if (!article.getValidFrom().isEmpty()) {\r\n                CompUtils.setParameter(ctx, FileParam.VALID_FROM, article.getValidFromAsLocalDate(), dataFile);\r\n            }\r\n\r\n            if (!article.getValidTo().isEmpty()) {\r\n                CompUtils.setParameter(ctx, FileParam.VALID_TO, article.getValidToAsLocalDate(), dataFile);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * The setLanguageParamByCustomer function sets the language parameter for a given file.\r\n     *\r\n     * @param Context  ctx Get the session and user session\r\n     * @param DataFile file Set the language parameter\r\n     */\r\n    protected void setLanguageParamByCustomer(Context ctx, DataFile file) {\r\n        LocalCustomer paramCustomer = null;\r\n        try {\r\n            paramCustomer = ctx.getSession().get(SessionParams.ACTIVE_CUSTOMER);\r\n        } catch (NullPointerException e) {\r\n            paramCustomer = ctx.getUserSession().get(Params.ACTIVE_CUSTOMER);\r\n        }\r\n        final LocalCustomer customer = paramCustomer;\r\n        List<CustomerLanguage> customerLanguages = SettingUtils.getAllSettingParameterValuesByType(ctx,\r\n                SettingType.CUSTOMER_LANGUAGE);\r\n        Optional<CustomerLanguage> optCustomerLanguage = customerLanguages.stream()\r\n                .filter(item -> customer.getCustomerId().equals(item.getCustomer().getCustomerId())).findFirst();\r\n        optCustomerLanguage.ifPresent(item -> {\r\n            Language value = item.getLanguage();\r\n            if (Objects.isNull(value)) {\r\n                List<Language> langs = ctx.getServices().getEnumerationService().getAllLanguages();\r\n                Setting settLang = SettingUtils.getSettingByType(ctx, SettingType.CUSTOMER_LANGUAGE_DEFAULT);\r\n                if (Objects.nonNull(settLang)) {\r\n                    value = langs.stream().filter(lang -> lang.getLabel().equals(settLang.getValue())).findFirst()\r\n                            .get();\r\n                } else {\r\n                    value = langs.stream().filter(lang -> lang.getKey().equals(\"7\")).findFirst().get();\r\n                }\r\n            }\r\n            CompUtils.setParameter(ctx, FileParam.LANGUAGE, value, file);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * The getContent function is used to get the content of a page.\r\n     *\r\n     * @param HttpSession session Get the session object\r\n     */\r\n    protected Context getContent(HttpSession session) {\r\n        Context ctx = null;\r\n        try {\r\n            ctx = initial(session);\r\n            return ctx;\r\n        } catch (Exception e) {\r\n            return getContent(session);\r\n        }\r\n    }\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\rest\\AbstractApi.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\rest\\ApiController.java =====\n```\npackage com.hom.ebmw.rest;\r\n\r\nimport com.hom.ebmw.exceptions.EntityNotFoundException;\r\nimport com.hom.ebmw.ipim.model.Currency;\r\nimport com.hom.ebmw.ipim.model.Language;\r\nimport com.hom.ebmw.ipim.model.Territory;\r\nimport com.hom.ebmw.jpa.model.*;\r\nimport com.hom.ebmw.pojo.Context;\r\nimport com.hom.ebmw.pojo.KatalogVersion;\r\nimport com.hom.ebmw.pojo.LayoutAutomation;\r\nimport com.hom.ebmw.utilities.CompUtils;\r\nimport com.hom.ebmw.utilities.FilterRunUtils;\r\nimport com.hom.ebmw.utilities.Parse;\r\nimport com.hom.ebmw.utilities.enums.FileParam;\r\nimport com.hom.ebmw.utilities.enums.ObjectType;\r\nimport com.hom.ebmw.utilities.enums.Params;\r\nimport com.hom.ebmw.utilities.enums.SessionParams;\r\nimport com.hom.ebmw.utilities.interfaces.HasPermission;\r\nimport lombok.extern.slf4j.Slf4j;\r\nimport org.springframework.dao.DataAccessException;\r\nimport org.springframework.http.HttpStatus;\r\nimport org.springframework.http.MediaType;\r\nimport org.springframework.security.access.prepost.PreAuthorize;\r\nimport org.springframework.web.bind.annotation.*;\r\nimport org.springframework.web.multipart.MultipartFile;\r\n\r\nimport javax.servlet.http.HttpServletResponse;\r\nimport javax.servlet.http.HttpSession;\r\nimport javax.ws.rs.BadRequestException;\r\nimport java.io.IOException;\r\nimport java.sql.SQLException;\r\nimport java.time.LocalDate;\r\nimport java.util.*;\r\n\r\n@Slf4j\r\n@RestController\r\n@RequestMapping(\"api\")\r\npublic class ApiController extends AbstractApi implements HasPermission {\r\n\r\n\r\n    /**\r\n     * The hello function is a simple function that returns the string &quot;Hello World!&quot;\r\n     *\r\n     * @param HttpSession session Get the current context\r\n     * @return The current user\r\n     */\r\n    @PreAuthorize(\"hasPermission(1, 'com.hom.ebmw.rest.ApiController.info','read')\")\r\n    @GetMapping(path = \"/info/hello\", produces = {MediaType.APPLICATION_JSON_VALUE})\r\n    public User hello(HttpSession session) {\r\n        Context ctx = getContent(session);\r\n        return ctx.getSession().getCurrentUser(ctx);\r\n    }\r\n\r\n    /**\r\n     * The findCustomerAll function is used to return a list of all the customers in the database.\r\n     *\r\n     * @return A list of localcustomer objects\r\n     */\r\n    @PreAuthorize(\"hasPermission(1, 'com.hom.ebmw.rest.ApiController.list','read')\")\r\n    @GetMapping(path = \"/list/customer\", produces = {MediaType.APPLICATION_JSON_VALUE})\r\n    public List<LocalCustomer> findCustomerAll() {\r\n        List<LocalCustomer> filters = services.getLocalCustomerCustomService().findAll();\r\n        filters.removeIf(LocalCustomer::isDelete);\r\n        return filters;\r\n    }\r\n\r\n    /**\r\n     * The findCustomerById function is used to find a customer by their unique customer number.\r\n     *\r\n     * @param @PathVariable(&quot;customerNr&quot;) String customerNr Get the value of the customernr parameter from\r\n     * @return A localcustomer object\r\n     */\r\n    @PreAuthorize(\"hasPermission(1, 'com.hom.ebmw.rest.ApiController.list','read')\")\r\n    @GetMapping(path = \"/list/customer/{customerNr}\", produces = {MediaType.APPLICATION_JSON_VALUE})\r\n    public LocalCustomer findCustomerById(@PathVariable(\"customerNr\") String customerNr) {\r\n        Optional<LocalCustomer> optFilter = services.getLocalCustomerCustomService().findByCustomerNr(customerNr);\r\n        if (optFilter.isPresent()) {\r\n            return optFilter.get();\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * The buildDefaultAssortment function is used to build an assortment from a set of files.\r\n     *\r\n     * @param @RequestParam(value Specify the name of the parameter in the request\r\n     *                            required Specify whether the parameter is required or not\r\n     * @param @RequestParam(value Specify the parameter name\r\n     *                            required Determine whether the parameter is required or not\r\n     * @param @RequestParam(value Specify the name of the parameter in the request\r\n     *                            required Indicate that the parameter is required\r\n     * @param @RequestParam(value Specify the name of the parameter in the request\r\n     *                            required Make the parameter mandatory\r\n     * @param @RequestParam(value Specify the name of the parameter in the request\r\n     *                            defaultValue Set the default value of a parameter\r\n     *                            required Make the parameter mandatory\r\n     *                            HttpSession session Get the context of the user\r\n     * @return A assortment object\r\n     */\r\n    @PreAuthorize(\"hasPermission(1, 'com.hom.ebmw.rest.ApiController.build','edit')\")\r\n    @PostMapping(path = \"/build/default-assortment\", produces = {MediaType.APPLICATION_JSON_VALUE}, consumes = {\r\n            MediaType.MULTIPART_FORM_DATA_VALUE})\r\n    public Assortment buildDefaultAssortment(@RequestParam(value = \"files\", required = true) MultipartFile[] files,\r\n                                             @RequestParam(value = \"customerId\", required = true) String customerId,\r\n                                             @RequestParam(value = \"role\", required = false) String roleName,\r\n                                             @RequestParam(value = \"filterId\", required = false) String filterId,\r\n                                             @RequestParam(value = \"locale\", defaultValue = \"de-DE\", required = false) String local, HttpSession session)\r\n            throws Exception {\r\n\r\n        Context ctx = getContent(session);\r\n        Locale locale = Locale.forLanguageTag(local);\r\n\r\n        LocalCustomer customer = returnValue(services.getLocalCustomerCustomService().findByCustomerNr(customerId));\r\n        if (Objects.isNull(customer)) {\r\n            throw new EntityNotFoundException(LocalCustomer.class);\r\n        }\r\n        ctx.getUserSession().put(Params.ACTIVE_CUSTOMER, customer);\r\n\r\n        User user = ctx.getSession().getCurrentUser(ctx);\r\n        if (Objects.isNull(user)) {\r\n            throw new NullPointerException(\"Could not find User please try again!!\");\r\n        }\r\n        Role role = returnValue(ctx.getServices().getRoleService().findByName(roleName));\r\n        if (Objects.isNull(roleName)) {\r\n            role = user.getRole();\r\n        }\r\n        if (Objects.isNull(role)) {\r\n            throw new EntityNotFoundException(Role.class);\r\n        }\r\n\r\n        ctx.putHttpAttribute(SessionParams.ACTIVE_ROLE, role);\r\n        // Phase 1 load Project\r\n        log.info(\"Rest: Build DEFAULT - Assortment Phase 1\");\r\n        Project project = returnValue(services.getProjectServices().findByCustomerNr(customerId));\r\n        final ProjectRole projectRole = returnValue(\r\n                services.getProjectRoleServices().findByProjectAndRole(project, role));\r\n\r\n        List<DataFile> loadedFiles = new ArrayList<>();\r\n        // Phase 2 Upload DataFile\r\n        log.info(\"Rest: Build DEFAULT - Assortment Phase 2\");\r\n        Arrays.asList(files).forEach(file -> loadedFiles.add(createDataFile(ctx, file, projectRole, locale)));\r\n\r\n        // Phase 3 create Assortment\r\n        log.info(\"Rest: Build DEFAULT - Assortment Phase 3\");\r\n        Assortment assortment = new Assortment();\r\n        assortment.setDate(user);\r\n        assortment.setProjectRole(projectRole);\r\n        final Assortment saveAssortment = services.getAssortmentService().save(assortment);\r\n        CompUtils.setParameter(ctx, FileParam.FILE_TYPE, ObjectType.ECAT, saveAssortment);\r\n\r\n        loadedFiles.forEach(item -> {\r\n            AssortmentDatafile xCross = new AssortmentDatafile();\r\n            xCross.setAssortment(saveAssortment);\r\n            xCross.setAstFile(item);\r\n            services.getAssortmentDataFileService().save(xCross);\r\n        });\r\n\r\n        ctx.getUserSession().put(Params.ACTIVE_ASSORTMENT, saveAssortment);\r\n\r\n        if (Objects.isNull(filterId)) {\r\n            FilterRunUtils.setDefaultAutoSorting(ctx);\r\n        } else {\r\n            Filter filter = returnValue(ctx.getServices().getFilterService().findById(Parse.toInt(filterId)));\r\n            FilterRunUtils.setFilterToAssortment(ctx, filter);\r\n        }\r\n\r\n\r\n        boolean error = FilterRunUtils.runWork(ctx, saveAssortment, null);\r\n        if (!error) {\r\n            FilterRunUtils.reloadAddFilter(ctx, null);\r\n            FilterRunUtils.reloadRemoveFilter(ctx, null);\r\n            FilterRunUtils.reloadIndividualFilter(ctx, null);\r\n        }\r\n\r\n        // Phase 4 Return Assortment\r\n        // return\r\n        log.info(\"Rest: Build DEFAULT - Assortment Phase 4\");\r\n        return FilterRunUtils.saveAssortment(ctx, null);\r\n    }\r\n\r\n\r\n    /**\r\n     * The findParameterByIdentifier function is a RESTful API endpoint that returns the parameter with the specified identifier.\r\n     *\r\n     * @param @PathVariable(value Specify the name of the variable in the path\r\n     *                            required Indicate whether the parameter is required or not\r\n     * @return A parameter by its identifier\r\n     */\r\n    @PreAuthorize(\"hasPermission(1, 'com.hom.ebmw.rest.ApiController.list','read')\")\r\n    @GetMapping(path = \"/list/parameter/{id}\", produces = {MediaType.APPLICATION_JSON_VALUE})\r\n    public Parameter findParameterByIdentifier(@PathVariable(value = \"id\", required = true) String identifier) {\r\n        Optional<Parameter> optParam = services.getParameterService().findById(Parse.toInt(identifier));\r\n        if (optParam.isPresent()) {\r\n            return optParam.get();\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * The findAllAssortments function returns a list of all Assortment objects in the database.\r\n     *\r\n     * @return A list of all the assortments\r\n     */\r\n    @PreAuthorize(\"hasPermission(1, 'com.hom.ebmw.rest.ApiController.list','read')\")\r\n    @GetMapping(path = \"/list/assortment\", produces = {MediaType.APPLICATION_JSON_VALUE})\r\n    public List<Assortment> findAllAssortments() {\r\n        List<Assortment> result = services.getAssortmentService().findAll();\r\n        result.removeIf(item -> Objects.nonNull(item.getDeleteBy()));\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * The findAssortmentByIdOrName function is a RESTful API endpoint that returns an Assortment object.\r\n     * The function takes in a String parameter, idOrName, which can be either the name of an assortment or its ID number.\r\n     * If the input is not numeric, it will search for assortments with names matching idOrName and return the first one found.\r\n     * If no match is found by name, it will then try to parse idOrName as an integer and search for assortments with IDs matching that value instead.\r\n     *\r\n     * @param @PathVariable(value Specify the name of the variable that is used in the url\r\n     *                            required Indicate whether the parameter is required or not\r\n     * @return An assortment by id or name\r\n     */\r\n    @PreAuthorize(\"hasPermission(1, 'com.hom.ebmw.rest.ApiController.list','read')\")\r\n    @GetMapping(path = \"/list/assortment/{idOrName}\", produces = {MediaType.APPLICATION_JSON_VALUE})\r\n    public Assortment findAssortmentByIdOrName(@PathVariable(value = \"idOrName\", required = true) String idOrName) {\r\n        Optional<Assortment> result = Optional.empty();\r\n\r\n        int id = Parse.toInt(idOrName);\r\n        if (id != 0) {\r\n            result = services.getAssortmentService().findById(id);\r\n        } else {\r\n            result = services.getAssortmentService().findByName(idOrName);\r\n        }\r\n        return returnValue(result);\r\n    }\r\n\r\n    /**\r\n     * The findLayoutAutomationByIdOrName function is used to find a layout automation by its id or name.\r\n     *\r\n     * @param HttpSession         session Get the context\r\n     * @param @PathVariable(value Get the value of the path variable\r\n     *                            required Tell spring that the parameter is required\r\n     * @return A layoutautomation object\r\n     */\r\n    @PreAuthorize(\"hasPermission(1, 'com.hom.ebmw.rest.ApiController.list','read')\")\r\n    @GetMapping(path = \"/list/layout-automation/{idOrName}\", produces = {MediaType.APPLICATION_JSON_VALUE})\r\n    public LayoutAutomation findLayoutAutomationByIdOrName(HttpSession session, @PathVariable(value = \"idOrName\", required = true) String idOrName) {\r\n        Context ctx = getContent(session);\r\n        Optional<Assortment> result = Optional.empty();\r\n        int id = Parse.toInt(idOrName);\r\n        if (id != 0) {\r\n            result = services.getAssortmentService().findById(id);\r\n        } else {\r\n            result = services.getAssortmentService().findByName(idOrName);\r\n        }\r\n        Assortment assortment = returnValue(result);\r\n        final LayoutAutomation la = new LayoutAutomation();\r\n        Territory territory = CompUtils.getParameter(ctx, FileParam.TERRITORY, assortment);\r\n        Language language = CompUtils.getParameter(ctx, FileParam.LANGUAGE, assortment);\r\n        Currency currency = CompUtils.getParameter(ctx, FileParam.CURRENCY, assortment);\r\n        LocalDate validFrom = CompUtils.getParameter(ctx, FileParam.VALID_FROM, assortment);\r\n        LocalDate validTo = CompUtils.getParameter(ctx, FileParam.VALID_TO, assortment);\r\n        KatalogVersion catalogVersion = CompUtils.getParameter(ctx, FileParam.KATALOG_VERSION, assortment);\r\n        long projectId = assortment.getProjectRole().getProject().getId();\r\n        Optional<Project> optProject = ctx.getServices().getProjectServices().findById(projectId);\r\n        optProject.ifPresent(item -> {\r\n            String customerId = item.getCustomerNr();\r\n            Optional<LocalCustomer> optCustomer = ctx.getServices().getLocalCustomerCustomService().findByCustomerNr(customerId);\r\n            optCustomer.ifPresent(customer -> {\r\n                la.setName(assortment.getName());\r\n                la.setId(String.valueOf(assortment.getId()));\r\n                la.setCurrency(currency.getKey());\r\n                la.setLanguage(Locale.forLanguageTag(language.getLabel()).getISO3Language());\r\n                la.setTerritory(territory.getKey());\r\n                la.setCatalogVersion(catalogVersion.getVersion());\r\n                la.setValidFrom(validFrom.toString());\r\n                la.setValidTo(validTo.toString());\r\n                la.setCustomer(customerId);\r\n                la.setCustomerName(customer.getName());\r\n                List<ArticleBase> articleBases = ctx.getServices().getArticleBaseService().findAllByAssortmentAndIsCommet(assortment, false);\r\n                articleBases.forEach(article -> la.getArticles().add(article.getArticleNr()));\r\n            });\r\n        });\r\n        return la;\r\n    }\r\n\r\n    /**\r\n     * The findAssortmentParameterByIdOrName function is a RESTful API endpoint that returns a list of parameters\r\n     * associated with an assortment. The function takes in two arguments: idOrName and entity. The idOrName argument\r\n     * is the name or ID of the assortment, while the entity argument specifies which type of parameter to return (i.e.,\r\n     * &quot;parameter&quot; for all parameters, &quot;input&quot; for input parameters only, or &quot;output&quot; for output parameters only). If no\r\n     * matching parameter can be found by name or ID, then an empty list will be returned instead. This function also\r\n     * requires read permission on com.\r\n     *\r\n     * @param @PathVariable(value Specify the name of the variable in the path\r\n     *                            required Indicate that the parameter is mandatory\r\n     * @param @RequestParam(value Specify the parameter name\r\n     *                            required Indicate whether the parameter is required\r\n     * @return A list of parameters for a given assortment\r\n     */\r\n    @PreAuthorize(\"hasPermission(1, 'com.hom.ebmw.rest.ApiController.list','read')\")\r\n    @GetMapping(path = \"/list/assortment/{idOrName}/parameter\", produces = {MediaType.APPLICATION_JSON_VALUE})\r\n    public List<Parameter> findAssortmentParameterByIdOrName(\r\n            @PathVariable(value = \"idOrName\", required = true) String idOrName,\r\n            @RequestParam(value = \"entity\", required = true) String entity) {\r\n        List<Parameter> parameters = new ArrayList<>();\r\n        Assortment file = findAssortmentByIdOrName(idOrName);\r\n        parameters = services.getParameterService().findAllByFile(file);\r\n        return parameters;\r\n    }\r\n\r\n\r\n    /**\r\n     * The getAssortmentByIdOrName function is a GET request that returns the assortment with the given id or name.\r\n     *\r\n     * @param @PathVariable(&quot;idOrName&quot;) String idOrName Get the id or name of the assortment to be downloaded\r\n     * @param HttpServletResponse                 response Set the response headers and write the file to the output stream\r\n     *                                            HttpSession session Store the file in the session\r\n     * @return An assortment by id or name\r\n     */\r\n    @PreAuthorize(\"hasPermission(1, 'com.hom.ebmw.rest.ApiController.download','read')\")\r\n    @GetMapping(path = \"/download/assortment/{idOrName}\", produces = {MediaType.TEXT_PLAIN_VALUE})\r\n    public void getAssortmentByIdOrName(@PathVariable(\"idOrName\") String idOrName, HttpServletResponse response,\r\n                                        HttpSession session) throws IOException {\r\n        Assortment assortment = findAssortmentByIdOrName(idOrName);\r\n        download(response, session, assortment, \"assortment\");\r\n    }\r\n\r\n    /**\r\n     * The findAllZinfos function returns a list of all ZinfoFile objects in the database.\r\n     *\r\n     * @return A list of all zinfo file objects in the database\r\n     */\r\n    @PreAuthorize(\"hasPermission(1, 'com.hom.ebmw.rest.ApiController.list','read')\")\r\n    @GetMapping(path = \"/list/zinfo\", produces = {MediaType.APPLICATION_JSON_VALUE})\r\n    public List<ZinfoFile> findAllZinfos() {\r\n        List<ZinfoFile> result = services.getZinfoFileService().findAll();\r\n        result.removeIf(item -> Objects.nonNull(item.getDeleteBy()));\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * The findZinfoByIdOrName function is a RESTful API endpoint that returns the ZinfoFile object with the given id or name.\r\n     *\r\n     * @param @PathVariable(value Specify the name of the variable in the path\r\n     *                            required Indicate whether the parameter is required or not\r\n     * @return A zinfofile object\r\n     */\r\n    @PreAuthorize(\"hasPermission(1, 'com.hom.ebmw.rest.ApiController.list','read')\")\r\n    @GetMapping(path = \"/list/zinfo/{idOrName}\", produces = {MediaType.APPLICATION_JSON_VALUE})\r\n    public ZinfoFile findZinfoByIdOrName(@PathVariable(value = \"idOrName\", required = true) String idOrName) {\r\n        Optional<ZinfoFile> result = Optional.empty();\r\n        int id = Parse.toInt(idOrName);\r\n        if (id != 0) {\r\n            result = services.getZinfoFileService().findById(id);\r\n        } else {\r\n            result = services.getZinfoFileService().findByName(idOrName);\r\n        }\r\n        return returnValue(result);\r\n    }\r\n\r\n    /**\r\n     * The findZinfoParameterByIdOrName function is a RESTful API endpoint that returns a list of all parameters\r\n     * associated with the ZinfoFile object whose id or name matches the idOrName parameter.\r\n     *\r\n     * @param @PathVariable(value Specify the name of the variable in the url\r\n     *                            required Specify whether the parameter is required or not\r\n     * @return The list of parameters for the given zinfo file\r\n     */\r\n    @PreAuthorize(\"hasPermission(1, 'com.hom.ebmw.rest.ApiController.list','read')\")\r\n    @GetMapping(path = \"/list/zinfo/{idOrName}/parameter\", produces = {MediaType.APPLICATION_JSON_VALUE})\r\n    public List<Parameter> findZinfoParameterByIdOrName(\r\n            @PathVariable(value = \"idOrName\", required = true) String idOrName) {\r\n        List<Parameter> parameters = new ArrayList<>();\r\n        ZinfoFile file = findZinfoByIdOrName(idOrName);\r\n        parameters = services.getParameterService().findAllByFile(file);\r\n        return parameters;\r\n    }\r\n\r\n    /**\r\n     * The getZinfoByIdOrName function is a GET request that returns the zinfo file associated with the given id or name.\r\n     *\r\n     * @param @PathVariable(&quot;idOrName&quot;) String idOrName Get the idorname from the url\r\n     * @param HttpServletResponse                 response Set the response headers and write the file to the output stream\r\n     * @param HttpSession                         session Store the file name in the session for later use\r\n     * @return A zinfofile object\r\n     */\r\n    @PreAuthorize(\"hasPermission(1, 'com.hom.ebmw.rest.ApiController.download','read')\")\r\n    @GetMapping(path = \"/download/zinfo/{idOrName}\", produces = {MediaType.TEXT_PLAIN_VALUE})\r\n    public void getZinfoByIdOrName(@PathVariable(\"idOrName\") String idOrName, HttpServletResponse response,\r\n                                   HttpSession session) throws IOException {\r\n        ZinfoFile assortment = findZinfoByIdOrName(idOrName);\r\n        download(response, session, assortment, \"zinfo\");\r\n    }\r\n\r\n    /**\r\n     * The findAllDataFile function is used to retrieve all DataFile objects from the database.\r\n     *\r\n     * @return A list of datafile objects\r\n     */\r\n    @PreAuthorize(\"hasPermission(1, 'com.hom.ebmw.rest.ApiController.list','read')\")\r\n    @GetMapping(path = \"/list/datafile\", produces = {MediaType.APPLICATION_JSON_VALUE})\r\n    public List<DataFile> findAllDataFile() {\r\n        List<DataFile> result = services.getDataFileService().findAll();\r\n        result.removeIf(item -> Objects.nonNull(item.getDeleteBy()));\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * The findDataFileByIdOrName function is a RESTful API endpoint that returns a DataFile object.\r\n     * The function accepts an idOrName parameter, which can be either the ID or name of the desired DataFile.\r\n     * If no matching DataFile is found, then null will be returned instead.\r\n     *\r\n     * @param @PathVariable(value Specify the name of the variable in the uri\r\n     *                            required Make the parameter mandatory\r\n     * @return A datafile object\r\n     */\r\n    @PreAuthorize(\"hasPermission(1, 'com.hom.ebmw.rest.ApiController.list','read')\")\r\n    @GetMapping(path = \"/list/datafile/{idOrName}\", produces = {MediaType.APPLICATION_JSON_VALUE})\r\n    public DataFile findDataFileByIdOrName(@PathVariable(value = \"idOrName\", required = true) String idOrName) {\r\n        Optional<DataFile> result = Optional.empty();\r\n        int id = Parse.toInt(idOrName);\r\n        if (id != 0) {\r\n            result = services.getDataFileService().findById(id);\r\n        } else {\r\n            result = services.getDataFileService().findByName(idOrName);\r\n        }\r\n        return returnValue(result);\r\n    }\r\n\r\n    /**\r\n     * The findDataFileParameterByIdOrName function is a RESTful API endpoint that returns a list of parameters\r\n     * associated with the data file specified by the idOrName parameter. The idOrName parameter can be either\r\n     * an integer ID or string name, and will return all parameters associated with that data file. If no such\r\n     * data file exists, then an empty list is returned instead. This function requires read permission on the\r\n     * com.hom.ebmw.rest package in order to execute successfully; otherwise it will throw an AccessDeniedException\r\n     *\r\n     * @param @PathVariable(value Specify the name of the variable in the uri\r\n     *                            required Make sure that the parameter is not null\r\n     * @return The list of parameters for the data file with id or name equal to idorname\r\n     */\r\n    @PreAuthorize(\"hasPermission(1, 'com.hom.ebmw.rest.ApiController.list','read')\")\r\n    @GetMapping(path = \"/list/datafile/{idOrName}/parameter\", produces = {MediaType.APPLICATION_JSON_VALUE})\r\n    public List<Parameter> findDataFileParameterByIdOrName(\r\n            @PathVariable(value = \"idOrName\", required = true) String idOrName) {\r\n        List<Parameter> parameters = new ArrayList<>();\r\n        DataFile file = findDataFileByIdOrName(idOrName);\r\n        parameters = services.getParameterService().findAllByFile(file);\r\n        return parameters;\r\n    }\r\n\r\n    /**\r\n     * The getDataFileByIdOrName function is a GET request that returns the datafile with the given id or name.\r\n     *\r\n     * @param @PathVariable(&quot;idOrName&quot;) String idOrName Get the idorname from the url\r\n     * @param HttpServletResponse                 response Set the response headers\r\n     * @param HttpSession                         session Store the file in the session\r\n     * @return The datafile object by its id or name\r\n     */\r\n    @PreAuthorize(\"hasPermission(1, 'com.hom.ebmw.rest.ApiController.download','read')\")\r\n    @GetMapping(path = \"/download/datafile/{idOrName}\", produces = {MediaType.TEXT_PLAIN_VALUE})\r\n    public void getDataFileByIdOrName(@PathVariable(\"idOrName\") String idOrName, HttpServletResponse response,\r\n                                      HttpSession session) throws IOException {\r\n        DataFile assortment = findDataFileByIdOrName(idOrName);\r\n        download(response, session, assortment, \"datafile\");\r\n    }\r\n\r\n    /**\r\n     * The findFilterAll function is used to find all the filters in the database.\r\n     *\r\n     * @return A list of filters\r\n     */\r\n    @PreAuthorize(\"hasPermission(1, 'com.hom.ebmw.rest.ApiController.list','read')\")\r\n    @GetMapping(path = \"/list/filter\", produces = {MediaType.APPLICATION_JSON_VALUE})\r\n    public List<Filter> findFilterAll() {\r\n        List<Filter> filters = services.getFilterService().findAll();\r\n        filters.removeIf(item -> Objects.nonNull(item.getDeleteBy()));\r\n        return filters;\r\n    }\r\n\r\n    /**\r\n     * The findFilterById function is a GET request that returns the filter with the specified identifier.\r\n     *\r\n     * @param @PathVariable(&quot;Id&quot;) Integer identifier Get the id of the filter that is passed in\r\n     * @return A filter object with the specified identifier\r\n     */\r\n    @PreAuthorize(\"hasPermission(1, 'com.hom.ebmw.rest.ApiController.list','read')\")\r\n    @GetMapping(path = \"/list/filter/{Id}\", produces = {MediaType.APPLICATION_JSON_VALUE})\r\n    public Filter findFilterById(@PathVariable(\"Id\") Integer identifier) {\r\n        return returnValue(services.getFilterService().findById(identifier));\r\n    }\r\n\r\n    /**\r\n     * The requestError function is a method that handles exceptions thrown by the\r\n     * application. It returns an HTTP status code of 400 (Bad Request) and a message\r\n     * explaining what went wrong. This function is called when the application throws\r\n     * either an SQLException, DataAccessException, or BadRequestException. The first two are\r\n     * thrown by Spring's JdbcTemplate class when it encounters errors in SQL queries or data access;\r\n     * the third is thrown by our own code if we encounter invalid input from users of our API. We use this function to return helpful error messages to users who make bad requests to our\r\n     *\r\n     * @return A string, which is converted to a responseentity object by the\r\n     */\r\n    @ExceptionHandler({SQLException.class, DataAccessException.class, BadRequestException.class})\r\n    @ResponseStatus(HttpStatus.BAD_REQUEST)\r\n    public String requestError() {\r\n        return \"Error in the request data\";\r\n    }\r\n\r\n    /**\r\n     * The noElementError function is a function that handles the NoSuchElementException.\r\n     * It returns an HTTP status of 404 (Not Found) and a message saying &quot;Entity not found&quot;.\r\n     *\r\n     * @return A string\r\n     */\r\n    @ExceptionHandler(NoSuchElementException.class)\r\n    @ResponseStatus(HttpStatus.NOT_FOUND)\r\n    public String noElementError() {\r\n        return \"Entity not found\";\r\n    }\r\n\r\n    /**\r\n     * The noEntitiyError function is a function that handles the EntityNotFoundException.\r\n     * It returns an error message to the user if they try to access a resource that does not exist.\r\n     *\r\n     * @param Exception e Get the message from the exception\r\n     * @return A string that contains the message from the exception\r\n     */\r\n    @ExceptionHandler(EntityNotFoundException.class)\r\n    @ResponseStatus(HttpStatus.NOT_FOUND)\r\n    public String noEntitiyError(Exception e) {\r\n        return e.getMessage();\r\n    }\r\n\r\n    /**\r\n     * The internalError function is a catch-all for any exceptions that are not handled by the other exception handlers.\r\n     * It returns an HTTP status code of 500 (Internal Server Error) and a message containing the name of the exception class\r\n     * and its message. This function is used as an\r\n     *\r\n     * @param Exception e Get the exception type and message\r\n     * @return A string\r\n     */\r\n    @ExceptionHandler(Exception.class)\r\n    @ResponseStatus(HttpStatus.INTERNAL_SERVER_ERROR)\r\n    public String internalError(Exception e) {\r\n        return \"Application Error [\" + e.getClass().getSimpleName() + \"] Message: \" + e.getMessage();\r\n    }\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\rest\\ApiController.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\rest\\ClientController.java =====\n```\npackage com.hom.ebmw.rest;\r\n\r\nimport com.hom.ebmw.utilities.JsonMapper;\r\nimport org.springframework.security.oauth2.client.OAuth2AuthorizedClient;\r\nimport org.springframework.security.oauth2.client.annotation.RegisteredOAuth2AuthorizedClient;\r\nimport org.springframework.stereotype.Controller;\r\nimport org.springframework.web.bind.annotation.GetMapping;\r\nimport org.springframework.web.bind.annotation.ResponseBody;\r\n\r\n@Controller\r\npublic class ClientController {\r\n\r\n    /**\r\n     * Call Graph endpoint\r\n     * Demonstrates how to utilize OAuth2AuthorizedClient.\r\n     * Passes that client over to Utilities.graphUserProperties, which creates a GraphServiceClient (GraphSDK v3)\r\n     * For full details, see method: Utilities.graphUserProperties(OAuth2AuthorizedClient graphAuthorizedClient)\r\n     *\r\n     * @param model                 Model used for placing user param and bodyContent param in request before serving UI.\r\n     * @param graphAuthorizedClient OAuth2AuthorizedClient this object contains Graph Access Token. See utilities file.\r\n     * @return String the UI.\r\n     */\r\n\r\n    @GetMapping(\"/graph\")\r\n    @ResponseBody\r\n    public String graph(@RegisteredOAuth2AuthorizedClient(\"graph\") OAuth2AuthorizedClient graphClient) {\r\n        return JsonMapper.toJsonString(graphClient);\r\n    }\r\n\r\n    /**\r\n     * The api function is a controller that returns the access token for the\r\n     * Microsoft Graph API. The\r\n     *\r\n     * @param @RegisteredOAuth2AuthorizedClient(&quot;graph&quot;) OAuth2AuthorizedClient graphClient Get the access token\r\n     * @return The access token\r\n     */\r\n    @GetMapping(\"/token\")\r\n    @ResponseBody\r\n    public String api(@RegisteredOAuth2AuthorizedClient(\"graph\") OAuth2AuthorizedClient graphClient) {\r\n        return graphClient.getAccessToken().getTokenValue();\r\n    }\r\n\r\n\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\rest\\ClientController.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\rest\\ImageController.java =====\n```\npackage com.hom.ebmw.rest;\r\n\r\nimport com.hom.ebmw.configuration.ApplicationProperty;\r\nimport com.hom.ebmw.exceptions.AstFileNotExistsException;\r\nimport com.hom.ebmw.jpa.dao.SettingDAO;\r\nimport com.hom.ebmw.jpa.model.Setting;\r\nimport com.hom.ebmw.utilities.enums.SettingType;\r\nimport org.apache.poi.util.IOUtils;\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\nimport org.springframework.http.HttpStatus;\r\nimport org.springframework.http.MediaType;\r\nimport org.springframework.web.bind.annotation.*;\r\n\r\nimport java.io.File;\r\nimport java.io.FileInputStream;\r\nimport java.io.IOException;\r\nimport java.io.InputStream;\r\nimport java.util.Optional;\r\n\r\n@RestController\r\npublic class ImageController {\r\n\r\n    @Autowired\r\n    private SettingDAO setting;\r\n\r\n    @Autowired\r\n    private ApplicationProperty property;\r\n\r\n    /**\r\n     * The floppyImageLoad function is used to load the floppy image from the path specified in settings.\r\n     *\r\n     * @return A byte array, so it is necessary to specify the mediatype\r\n     */\r\n    @GetMapping(value = \"/tmp/floppy\", produces = {MediaType.IMAGE_GIF_VALUE})\r\n    public @ResponseBody Object floppyImageLoad() throws IOException, AstFileNotExistsException {\r\n        String path = \"\";\r\n        Optional<Setting> optSetting = setting.findByIdentifier(SettingType.MAINTENANCE_SAVE_IMAGE.name());\r\n        if (optSetting.isPresent()) {\r\n            if (!optSetting.get().getValue().isEmpty()) {\r\n                path = optSetting.get().getValue();\r\n            }\r\n        }\r\n\r\n        String filePath = path;\r\n\r\n        File fi = new File(filePath);\r\n        if (!fi.exists()) { // if path not Exists\r\n            new AstFileNotExistsException();\r\n        }\r\n\r\n        InputStream in = new FileInputStream(fi);\r\n        return IOUtils.toByteArray(in);\r\n    }\r\n\r\n    /**\r\n     * The floppyDisabledImageLoad function is used to load the floppy disk image that appears on the\r\n     * maintenance page when a user attempts to save their work. The function first checks if there is\r\n     * a path stored in the database for this image, and if not it uses an empty string as its default.\r\n     * It then creates a new file object using this path, and throws an exception if it does not exist.\r\n     * Finally, it returns an InputStream containing all of the bytes from this file object as byte data.\r\n     *\r\n     * @return The image that is displayed when the system is disabled\r\n     */\r\n    @GetMapping(value = \"/tmp/floppy-disable\", produces = {MediaType.IMAGE_GIF_VALUE})\r\n    public @ResponseBody Object floppyDisabledImageLoad() throws IOException, AstFileNotExistsException {\r\n        String path = \"\";\r\n        Optional<Setting> optSetting = setting.findByIdentifier(SettingType.MAINTENANCE_SAVE_DISABLED_IMAGE.name());\r\n        if (optSetting.isPresent()) {\r\n            if (!optSetting.get().getValue().isEmpty()) {\r\n                path = optSetting.get().getValue();\r\n            }\r\n        }\r\n\r\n        String filePath = path;\r\n\r\n        File fi = new File(filePath);\r\n        if (!fi.exists()) { // if path not Exists\r\n            new AstFileNotExistsException();\r\n        }\r\n\r\n        InputStream in = new FileInputStream(fi);\r\n        return IOUtils.toByteArray(in);\r\n    }\r\n\r\n    /**\r\n     * The progressImageLoad function is used to load the progress image from the database.\r\n     *\r\n     * @return An image, which is displayed in the browser\r\n     */\r\n    @GetMapping(value = \"/tmp/progress\", produces = {MediaType.IMAGE_GIF_VALUE})\r\n    public @ResponseBody Object progressImageLoad() throws IOException, AstFileNotExistsException {\r\n        String path = \"\";\r\n        Optional<Setting> optSetting = setting.findByIdentifier(SettingType.MAINTENANCE_PROGRESS_IMAGE.name());\r\n        if (optSetting.isPresent()) {\r\n            if (!optSetting.get().getValue().isEmpty()) {\r\n                path = optSetting.get().getValue();\r\n            }\r\n        }\r\n\r\n        String filePath = path;\r\n\r\n        File fi = new File(filePath);\r\n        if (!fi.exists()) { // if path not Exists\r\n            new AstFileNotExistsException();\r\n        }\r\n\r\n        InputStream in = new FileInputStream(fi);\r\n        return IOUtils.toByteArray(in);\r\n    }\r\n\r\n    /**\r\n     * The bannerImageLoad function is used to load the banner image from the file system.\r\n     *\r\n     * @return The contents of the file as a byte array\r\n     */\r\n    @GetMapping(value = \"/tmp/banner\", produces = {MediaType.IMAGE_GIF_VALUE, MediaType.IMAGE_JPEG_VALUE, MediaType.IMAGE_PNG_VALUE})\r\n    public @ResponseBody Object bannerImageLoad() throws IOException, AstFileNotExistsException {\r\n        String filePath = property.getBannerImage();\r\n\r\n        Optional<Setting> optSetting = setting.findByIdentifier(SettingType.MAINTENANCE_BANNER_IMAGE.name());\r\n        if (optSetting.isPresent()) {\r\n            if (!optSetting.get().getValue().isEmpty()) {\r\n                filePath = optSetting.get().getValue();\r\n            }\r\n        }\r\n\r\n        File fi = new File(filePath);\r\n        if (!fi.exists()) { // if path not Exists\r\n            new AstFileNotExistsException();\r\n        }\r\n\r\n        InputStream in = new FileInputStream(fi);\r\n        return IOUtils.toByteArray(in);\r\n    }\r\n\r\n    /**\r\n     * The fileNotFound function is a handler for the IOException and AstFileNotExistsException exceptions.\r\n     * It returns an HTTP status code of 404 (NOT_FOUND) with the message &quot;File not found&quot;.\r\n     *\r\n     * @return A string, which is the message that will be displayed to the user\r\n     */\r\n    @ExceptionHandler({IOException.class, AstFileNotExistsException.class})\r\n    @ResponseStatus(HttpStatus.NOT_FOUND)\r\n    public String fileNotFound() {\r\n        return \"File not found\";\r\n    }\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\rest\\ImageController.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\utilities\\annotations\\BreadCrumb.java =====\n```\npackage com.hom.ebmw.utilities.annotations;\r\n\r\nimport java.lang.annotation.Retention;\r\nimport java.lang.annotation.RetentionPolicy;\r\nimport java.lang.annotation.Target;\r\n\r\n@Target({java.lang.annotation.ElementType.TYPE})\r\n@Retention(RetentionPolicy.RUNTIME)\r\npublic @interface BreadCrumb {\r\n    String value();\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\utilities\\annotations\\BreadCrumb.java =====\n\n"
  },
  "response" : {
    "id" : "chatcmpl-2GOHT6k6OwFICSRx58tX29MUWX8OQpEo",
    "created" : 1762170898,
    "model" : "gpt-oss:120b",
    "object" : "chat.completion",
    "system_fingerprint" : "b1-b0d5299",
    "choices" : [ {
      "finish_reason" : "stop",
      "index" : 0,
      "message" : {
        "content" : "{\n  \"file\": \"multiple\",\n  \"issues\": [\n    {\n      \"severity\": \"High\",\n      \"problem\": \"Potential NoSuchElementException in Filter.setPrefix when adminRole is empty\",\n      \"justification\": \"adminRole.get() is called without checking if the Optional contains a value, which can cause a runtime exception and break the request processing.\",\n      \"action\": \"Check adminRole.isPresent() before calling get(); fallback to a default role or return an error; add unit test for missing admin role.\",\n      \"source\": \"Filter.setPrefix, line with adminRole.get()\",\n      \"component\": \"filter-service\",\n      \"impact_scope\": \"prod-relevant\",\n      \"relations\": null,\n      \"evidence\": null\n    },\n    {\n      \"severity\": \"High\",\n      \"problem\": \"ImageController does not actually throw AstFileNotExistsException when file is missing\",\n      \"justification\": \"The code creates a new exception instance but never throws it, so the client receives a 200 response with empty body instead of proper 404.\",\n      \"action\": \"Replace 'new AstFileNotExistsException();' with 'throw new AstFileNotExistsException();'; add integration test for missing file handling.\",\n      \"source\": \"ImageController.floppyImageLoad / floppyDisabledImageLoad / progressImageLoad / bannerImageLoad\",\n      \"component\": \"image-controller\",\n      \"impact_scope\": \"securityrelevant, userexperience\",\n      \"relations\": null,\n      \"evidence\": null\n    },\n    {\n      \"severity\": \"High\",\n      \"problem\": \"Recursive call in AbstractApi.getContent can cause StackOverflow\",\n      \"justification\": \"If initial(session) throws an exception repeatedly, getContent catches it and calls itself again without a termination condition.\",\n      \"action\": \"Log the exception and return a fallback context or rethrow; add test that simulates failure of initial().\",\n      \"source\": \"AbstractApi.getContent\",\n      \"component\": \"rest-framework\",\n      \"impact_scope\": \"prodcritical\",\n      \"relations\": null,\n      \"evidence\": null\n    },\n    {\n      \"severity\": \"Med\",\n      \"problem\": \"Setting.addRoles uses incorrect logical operator causing duplicate role addition\",\n      \"justification\": \"Condition '!Objects.isNull(getAllRoles()) || !getAllRoles().isEmpty()' always true, leading to unnecessary list creation and possible duplicates.\",\n      \"action\": \"Replace '||' with '&&' and simplify logic; add unit test verifying no duplicate roles are added.\",\n      \"source\": \"Setting.addRoles\",\n      \"component\": \"setting-service\",\n      \"impact_scope\": \"lowrisk, dataintegrity\",\n      \"relations\": null,\n      \"evidence\": null\n    },\n    {\n      \"severity\": \"Med\",\n      \"problem\": \"Parameter.getParamValue can throw NullPointerException when value is null\",\n      \"justification\": \"Method calls object.getClass() without null check; also swallows all exceptions returning empty string, hiding errors.\",\n      \"action\": \"Check if object is null before accessing its class; log or rethrow unexpected exceptions; add tests for null and nonserializable values.\",\n      \"source\": \"Parameter.getParamValue\",\n      \"component\": \"parameter-model\",\n      \"impact_scope\": \"prodrelevant\",\n      \"relations\": null,\n      \"evidence\": null\n    },\n    {\n      \"severity\": \"Med\",\n      \"problem\": \"SettingParameter.setValue creates ConvertException but never throws it\",\n      \"justification\": \"When a nonSerializable value is passed, the exception is instantiated and discarded, leaving the value unchanged and causing silent failures.\",\n      \"action\": \"Throw the ConvertException after creation; update callers to handle it; add unit tests for nonserializable inputs.\",\n      \"source\": \"SettingParameter.setValue\",\n      \"component\": \"setting-parameter-model\",\n      \"impact_scope\": \"prodrelevant\",\n      \"relations\": null,\n      \"evidence\": null\n    },\n    {\n      \"severity\": \"Low\",\n      \"problem\": \"ImageController returns generic Object instead of byte[] for images\",\n      \"justification\": \"Using Object reduces type safety and may confuse API consumers; explicit byte[] clarifies contract.\",\n      \"action\": \"Change method signatures to return byte[]; adjust @ResponseBody accordingly; add documentation.\",\n      \"source\": \"ImageController methods (floppyImageLoad, etc.)\",\n      \"component\": \"image-controller\",\n      \"impact_scope\": null,\n      \"relations\": null,\n      \"evidence\": null\n    },\n    {\n      \"severity\": \"Low\",\n      \"problem\": \"Filter.getSortType catches generic Exception and silently defaults to EMPTY\",\n      \"justification\": \"Catching all exceptions hides programming errors (e.g., NullPointerException) and makes debugging harder.\",\n      \"action\": \"Catch only IllegalArgumentException; add nullcheck for sortType; log unexpected exceptions.\",\n      \"source\": \"Filter.getSortType\",\n      \"component\": \"filter-model\",\n      \"impact_scope\": null,\n      \"relations\": null,\n      \"evidence\": null\n    },\n    {\n      \"severity\": \"Low\",\n      \"problem\": \"Setting.getAllRoles modifies the 'roles' field while iterating\",\n      \"justification\": \"Method sets 'roles' to empty string in else branch, which may unintentionally clear stored roles if called on a nonempty string without pattern.\",\n      \"action\": \"Refactor to avoid mutating 'roles' inside getter; provide separate parsing method; add tests for edge cases.\",\n      \"source\": \"Setting.getAllRoles\",\n      \"component\": \"setting-model\",\n      \"impact_scope\": null,\n      \"relations\": null,\n      \"evidence\": null\n    },\n    {\n      \"severity\": \"Low\",\n      \"problem\": \"ApiController.buildDefaultAssortment does not validate 'roleName' before use\",\n      \"justification\": \"If roleName is provided but does not exist, ctx.putHttpAttribute may receive null, leading to later NPEs.\",\n      \"action\": \"Validate role existence; if not found, fallback to user's role or return a clear error; add unit test for invalid roleName.\",\n      \"source\": \"ApiController.buildDefaultAssortment, role handling\",\n      \"component\": \"api-controller\",\n      \"impact_scope\": null,\n      \"relations\": null,\n      \"evidence\": null\n    }\n  ],\n  \"summary\": {\n    \"overall_rating\": \"2\",\n    \"top_todos\": [\n      \"Fix exception handling in ImageController (throw AstFileNotExistsException).\",\n      \"Add presence check before using adminRole.get() in Filter.setPrefix.\",\n      \"Prevent infinite recursion in AbstractApi.getContent by handling initialization failures.\"\n    ]\n  }\n}",
        "role" : "assistant",
        "reasoning_content" : "We need to produce JSON with issues for each file? The instruction: \"Du analysierst jeweils einen Code-Chunk.\" Probably need to output one JSON per file? But schema has \"file\": path, \"issues\": [...]. Likely combine all files? But max 10 issues per file/chunk. Could output aggregated issues for all? Probably produce one JSON per file? The answer must be a single JSON object. So maybe combine all issues across all files, but \"file\" field could be something like \"multiple files\" or first file? The instruction unclear. Probably produce one JSON per file chunk, but only one JSON allowed. Might need to produce a JSON with file as identifier \"multiple\". Could list issues across all. I'll set file as \"multiple\". Provide up to 10 issues overall, focusing on major problems.\n\nIdentify issues:\n\n1. Filter.setPrefix: adminRole.get() without checking presence -> possible NoSuchElementException. Severity High.\n\n2. Setting.addRoles: logic uses getAllRoles() then checks !Objects.isNull(getAllRoles()) || !getAllRoles().isEmpty() - should be &&; also getAllRoles may be null? getAllRoles returns list, never null but method sets roles to \"\" if null, okay. But condition wrong, could add duplicate. Minor.\n\n3. Setting.getAllRoles: uses roles field, modifies it incorrectly: if roles.contains(pattern) else sets roles = \"\" but doesn't update field? Actually modifies local variable? It sets roles = \"\" which shadows field? It's field. fine.\n\n4. In ImageController floppyImageLoad: new AstFileNotExistsException() thrown but not thrown, just created. Should throw exception. Same for other methods. Severity High.\n\n5. In ImageController methods, returning Object but should return byte[]; using Object ok but not typed.\n\n6. In AbstractApi.getContent: recursive call on exception may cause infinite recursion if initial always fails -> StackOverflow. Severity High.\n\n7. In ApiController.buildDefaultAssortment: roleName null check uses Objects.isNull(roleName) after retrieving role = returnValue(...). Logic: if roleName null then role = user.getRole(). but they check Objects.isNull(roleName) not role, maybe fine. Also potential NPE when ctx.getUserSession().get(Params.ACTIVE_CUSTOMER) could be null earlier.\n\n8. In Parameter.getParamValue: catches Exception and returns \"\" losing error info; also object may be null leading NullPointerException on object.getClass(). Should check null. Severity Med.\n\n9. In Filter.getSortType: catches generic Exception, returns EMPTY even if sortType null leads to NPE? sortType.toUpperCase() NPE if sortType null. But sortType default \"\", so okay.\n\n10. In SettingParameter.setValue: creates new ConvertException but not thrown. Should throw. Severity Med.\n\nAlso in Setting.addRoles: building string with pattern may cause concurrency issues? Not.\n\nWe'll list 10 issues.\n\nProvide summary rating maybe 2 stars due many issues.\n\nProvide top todos.\n\nNow produce JSON."
      },
      "provider_specific_fields" : { }
    } ],
    "usage" : {
      "completion_tokens" : 2064,
      "prompt_tokens" : 26418,
      "total_tokens" : 28482
    },
    "timings" : {
      "cache_n" : 62,
      "prompt_n" : 26356,
      "prompt_ms" : 19540.717,
      "prompt_per_token_ms" : 0.7414143648505085,
      "prompt_per_second" : 1348.773435488575,
      "predicted_n" : 2064,
      "predicted_ms" : 24989.682,
      "predicted_per_token_ms" : 12.107404069767442,
      "predicted_per_second" : 82.59408823209515
    }
  }
}