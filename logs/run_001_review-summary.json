{
  "timestamp" : "2025-11-03T12:48:10.7136542",
  "index" : 1,
  "file" : "review-summary",
  "prompt" : {
    "role" : "user",
    "content" : "===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\.idea\\misc.xml =====\n```\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"ProjectRootManager\" version=\"2\" languageLevel=\"JDK_21\" default=\"true\" project-jdk-name=\"21\" project-jdk-type=\"JavaSDK\">\r\n    <output url=\"file://$PROJECT_DIR$/out\" />\r\n  </component>\r\n</project>\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\.idea\\misc.xml =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\.idea\\modules.xml =====\n```\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"ProjectModuleManager\">\r\n    <modules>\r\n      <module fileurl=\"file://$PROJECT_DIR$/.idea/TIP - Assortmenttool_2.iml\" filepath=\"$PROJECT_DIR$/.idea/TIP - Assortmenttool_2.iml\" />\r\n    </modules>\r\n  </component>\r\n</project>\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\.idea\\modules.xml =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\.idea\\vcs.xml =====\n```\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project version=\"4\">\n  <component name=\"VcsDirectoryMappings\">\n    <mapping directory=\"\" vcs=\"Git\" />\n  </component>\n</project>\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\.idea\\vcs.xml =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\.idea\\workspace.xml =====\n```\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project version=\"4\">\n  <component name=\"AutoImportSettings\">\n    <option name=\"autoReloadType\" value=\"SELECTIVE\" />\n  </component>\n  <component name=\"ChangeListManager\">\n    <list default=\"true\" id=\"889cb4dd-f8c8-4936-b3a8-d8b6bdb25298\" name=\"Changes\" comment=\"\" />\n    <option name=\"SHOW_DIALOG\" value=\"false\" />\n    <option name=\"HIGHLIGHT_CONFLICTS\" value=\"true\" />\n    <option name=\"HIGHLIGHT_NON_ACTIVE_CHANGELIST\" value=\"false\" />\n    <option name=\"LAST_RESOLUTION\" value=\"IGNORE\" />\n  </component>\n  <component name=\"Git.Settings\">\n    <option name=\"RECENT_GIT_ROOT_PATH\" value=\"$PROJECT_DIR$\" />\n  </component>\n  <component name=\"ProjectColorInfo\">{\n  &quot;associatedIndex&quot;: 7\n}</component>\n  <component name=\"ProjectId\" id=\"33T60eJ8pzPhE8zyYqupPZlSXXl\" />\n  <component name=\"ProjectLevelVcsManager\" settingsEditedManually=\"true\" />\n  <component name=\"ProjectViewState\">\n    <option name=\"hideEmptyMiddlePackages\" value=\"true\" />\n    <option name=\"showLibraryContents\" value=\"true\" />\n  </component>\n  <component name=\"PropertiesComponent\">{\n  &quot;keyToString&quot;: {\n    &quot;RunOnceActivity.ShowReadmeOnStart&quot;: &quot;true&quot;,\n    &quot;RunOnceActivity.git.unshallow&quot;: &quot;true&quot;,\n    &quot;git-widget-placeholder&quot;: &quot;4.15.5.ACC.R-W0&quot;,\n    &quot;kotlin-language-version-configured&quot;: &quot;true&quot;,\n    &quot;node.js.detected.package.eslint&quot;: &quot;true&quot;,\n    &quot;node.js.detected.package.tslint&quot;: &quot;true&quot;,\n    &quot;node.js.selected.package.eslint&quot;: &quot;(autodetect)&quot;,\n    &quot;node.js.selected.package.tslint&quot;: &quot;(autodetect)&quot;,\n    &quot;nodejs_package_manager_path&quot;: &quot;npm&quot;,\n    &quot;vue.rearranger.settings.migration&quot;: &quot;true&quot;\n  }\n}</component>\n  <component name=\"SharedIndexes\">\n    <attachedChunks>\n      <set>\n        <option value=\"bundled-jdk-9823dce3aa75-fdfe4dae3a2d-intellij.indexing.shared.core-IU-243.22562.145\" />\n        <option value=\"bundled-js-predefined-d6986cc7102b-deb605915726-JavaScript-IU-243.22562.145\" />\n      </set>\n    </attachedChunks>\n  </component>\n  <component name=\"SpellCheckerSettings\" RuntimeDictionaries=\"0\" Folders=\"0\" CustomDictionaries=\"0\" DefaultDictionary=\"application-level\" UseSingleDictionary=\"true\" transferred=\"true\" />\n  <component name=\"TaskManager\">\n    <task active=\"true\" id=\"Default\" summary=\"Default task\">\n      <changelist id=\"889cb4dd-f8c8-4936-b3a8-d8b6bdb25298\" name=\"Changes\" comment=\"\" />\n      <created>1759328493158</created>\n      <option name=\"number\" value=\"Default\" />\n      <option name=\"presentableId\" value=\"Default\" />\n      <updated>1759328493158</updated>\n      <workItem from=\"1759328494397\" duration=\"990000\" />\n      <workItem from=\"1759394777924\" duration=\"994000\" />\n      <workItem from=\"1759396390127\" duration=\"599000\" />\n      <workItem from=\"1760953291897\" duration=\"594000\" />\n      <workItem from=\"1760963162694\" duration=\"671000\" />\n    </task>\n    <servers />\n  </component>\n  <component name=\"TypeScriptGeneratedFilesManager\">\n    <option name=\"version\" value=\"3\" />\n  </component>\n</project>\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\.idea\\workspace.xml =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\bin\\pom.xml =====\n```\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\r\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\r\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\">\r\n    <modelVersion>4.0.0</modelVersion>\r\n\r\n    <groupId>com.hom</groupId>\r\n    <artifactId>Assortmenttool</artifactId>\r\n    <version>2.0.2-SNAPSHOT</version>\r\n    <name>Assortmenttool</name>\r\n    <description>Assortmenttool</description>\r\n\r\n    <properties>\r\n        <java.version>1.8</java.version>\r\n        <spring.version>2.2.1.RELEASE</spring.version>\r\n        <azure.version>2.2.0</azure.version>\r\n        <vaadin.version>14.5.2</vaadin.version>\r\n    </properties>\r\n\r\n    <parent>\r\n        <groupId>org.springframework.boot</groupId>\r\n        <artifactId>spring-boot-starter-parent</artifactId>\r\n        <version>2.2.1.RELEASE</version>\r\n        <relativePath/> <!-- lookup parent from repository -->\r\n    </parent>\r\n\r\n    <repositories>\r\n        <repository>\r\n            <id>vaadin-addons</id>\r\n            <url>https://maven.vaadin.com/vaadin-addons</url>\r\n        </repository>\r\n    </repositories>\r\n\r\n    <dependencyManagement>\r\n        <dependencies>\r\n            <dependency>\r\n                <groupId>com.microsoft.azure</groupId>\r\n                <artifactId>azure-spring-boot-bom</artifactId>\r\n                <version>${azure.version}</version>\r\n                <type>pom</type>\r\n                <scope>import</scope>\r\n            </dependency>\r\n            <dependency>\r\n                <groupId>com.vaadin</groupId>\r\n                <artifactId>vaadin-bom</artifactId>\r\n                <version>${vaadin.version}</version>\r\n                <type>pom</type>\r\n                <scope>import</scope>\r\n            </dependency>\r\n        </dependencies>\r\n    </dependencyManagement>\r\n\r\n    <dependencies>\r\n        <dependency>\r\n            <groupId>org.springframework.boot</groupId>\r\n            <artifactId>spring-boot-starter-data-rest</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.springframework.boot</groupId>\r\n            <artifactId>spring-boot-starter-jersey</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.springframework.boot</groupId>\r\n            <artifactId>spring-boot-starter-oauth2-client</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.springframework.boot</groupId>\r\n            <artifactId>spring-boot-starter-security</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.springframework.boot</groupId>\r\n            <artifactId>spring-boot-starter-actuator</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.springframework.security</groupId>\r\n            <artifactId>spring-security-web</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.springframework.security</groupId>\r\n            <artifactId>spring-security-config</artifactId>\r\n        </dependency>\r\n        <!-- Vaadin -->\r\n        <dependency>\r\n            <groupId>com.vaadin</groupId>\r\n            <artifactId>vaadin-spring-boot-starter</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>com.vaadin</groupId>\r\n            <artifactId>vaadin</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>com.vaadin</groupId>\r\n            <artifactId>vaadin-split-layout-flow</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.vaadin.stefan</groupId>\r\n            <artifactId>lazy-download-button</artifactId>\r\n            <version>1.0.0</version>\r\n        </dependency>\r\n        <!-- use appropriate version -->\r\n        <dependency>\r\n            <groupId>org.vaadin.gatanaso</groupId>\r\n            <artifactId>multiselect-combo-box-flow</artifactId>\r\n            <version>3.0.2</version>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>dev.mett.vaadin</groupId>\r\n            <artifactId>tooltip</artifactId>\r\n            <version>1.7.1</version>\r\n        </dependency>\r\n\r\n        <!-- Informatica Rest-Service-Client -->\r\n        <dependency>\r\n            <groupId>com.heiler.pim</groupId>\r\n            <artifactId>webservice-client</artifactId>\r\n            <version>1.0.0</version>\r\n        </dependency>\r\n        <!-- Informatica Rest-Service-Client needed ressources -->\r\n        <dependency>\r\n            <groupId>com.sun.jersey</groupId>\r\n            <artifactId>jersey-client</artifactId>\r\n            <version>1.19.4</version>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>com.sun.jersey</groupId>\r\n            <artifactId>jersey-core</artifactId>\r\n            <version>1.19.4</version>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>com.sun.jersey</groupId>\r\n            <artifactId>jersey-json</artifactId>\r\n            <version>1.19.4</version>\r\n        </dependency>\r\n\r\n        <!-- Excel import -->\r\n        <dependency>\r\n            <groupId>org.apache.poi</groupId>\r\n            <artifactId>poi</artifactId>\r\n            <version>4.0.0</version>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.apache.poi</groupId>\r\n            <artifactId>poi-ooxml</artifactId>\r\n            <version>4.0.0</version>\r\n        </dependency>\r\n        <!-- embedded DataBase -->\r\n        <dependency>\r\n            <groupId>org.springframework.boot</groupId>\r\n            <artifactId>spring-boot-starter-data-jpa</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>com.microsoft.sqlserver</groupId>\r\n            <artifactId>mssql-jdbc</artifactId>\r\n            <scope>runtime</scope>\r\n        </dependency>\r\n        <!-- Security -->\r\n        <dependency>\r\n            <groupId>com.microsoft.azure</groupId>\r\n            <artifactId>azure-active-directory-spring-boot-starter</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>com.microsoft.graph</groupId>\r\n            <artifactId>microsoft-graph</artifactId>\r\n            <version>1.6.0</version>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>com.microsoft.graph</groupId>\r\n            <artifactId>microsoft-graph-auth</artifactId>\r\n            <version>0.1.0-SNAPSHOT</version>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.projectlombok</groupId>\r\n            <artifactId>lombok</artifactId>\r\n            <scope>provided</scope>\r\n        </dependency>\r\n        <!-- Special Errors :( -->\r\n        <dependency>\r\n            <groupId>org.apache.oltu.oauth2</groupId>\r\n            <artifactId>org.apache.oltu.oauth2.client</artifactId>\r\n            <version>1.0.2</version>\r\n        </dependency>\r\n    </dependencies>\r\n\r\n\r\n    <build>\r\n        <plugins>\r\n            <plugin>\r\n                <groupId>org.springframework.boot</groupId>\r\n                <artifactId>spring-boot-maven-plugin</artifactId>\r\n                <configuration>\r\n                    <!-- <jvmArguments>-Dvaadin.productionMode</jvmArguments> -->\r\n                </configuration>\r\n            </plugin>\r\n            <plugin>\r\n                <groupId>com.vaadin</groupId>\r\n                <artifactId>vaadin-maven-plugin</artifactId>\r\n                <version>${vaadin.version}</version>\r\n                <executions>\r\n                    <execution>\r\n                        <goals>\r\n                            <goal>prepare-frontend</goal>\r\n                        </goals>\r\n                        <phase>compile</phase>\r\n                    </execution>\r\n                </executions>\r\n            </plugin>\r\n        </plugins>\r\n    </build>\r\n    <profiles>\r\n        <profile>\r\n            <!-- Production mode is activated using -Pproduction -->\r\n            <id>production</id>\r\n            <properties>\r\n                <vaadin.productionMode>true</vaadin.productionMode>\r\n            </properties>\r\n\r\n            <dependencies>\r\n                <dependency>\r\n                    <groupId>com.vaadin</groupId>\r\n                    <artifactId>flow-server-production-mode</artifactId>\r\n                </dependency>\r\n            </dependencies>\r\n\r\n            <build>\r\n                <plugins>\r\n                    <plugin>\r\n                        <groupId>org.springframework.boot</groupId>\r\n                        <artifactId>spring-boot-maven-plugin</artifactId>\r\n                        <configuration>\r\n                            <jvmArguments>\r\n                                -Dvaadin.productionMode\r\n                                -XX:NewSize=512m\r\n                                -XX:MaxNewSize=512m -Xms2048m\r\n                                -Xmx2048m -XX:MetaspaceSize=512m\r\n                                -XX:MaxMetaspaceSize=512m\r\n                                -XX:SurvivorRatio=12\r\n                                -XX:TargetSurvivorRatio=90\r\n                                -XX:MaxTenuringThreshold=15\r\n                                -XX:+UseLargePages\r\n                                -XX:LargePageSizeInBytes=256m -XX:+UseParNewGC\r\n                                -XX:ParallelGCThreads=16 -XX:+UseConcMarkSweepGC\r\n                                -XX:+CMSParallelRemarkEnabled\r\n                                -XX:+CMSCompactWhenClearAllSoftRefs\r\n                                -XX:CMSInitiatingOccupancyFraction=85\r\n                                -XX:+CMSScavengeBeforeRemark\r\n                                -XX:+UseLargePages\r\n                                -XX:LargePageSizeInBytes=256m\r\n                                -XX:+UseCompressedOops\r\n                                -XX:+DisableExplicitGC -XX:-UseBiasedLocking\r\n                                -XX:+BindGCTaskThreadsToCPUs -XX:+UseFastAccessorMethods\r\n                                -XX:InitialCodeCacheSize=32m -XX:ReservedCodeCacheSize=96m\r\n                            </jvmArguments>\r\n                        </configuration>\r\n                    </plugin>\r\n                    <plugin>\r\n                        <groupId>com.vaadin</groupId>\r\n                        <artifactId>vaadin-maven-plugin</artifactId>\r\n                        <version>${vaadin.version}</version>\r\n                        <executions>\r\n                            <execution>\r\n                                <goals>\r\n                                    <goal>build-frontend</goal>\r\n                                </goals>\r\n                                <phase>compile</phase>\r\n                            </execution>\r\n                        </executions>\r\n                    </plugin>\r\n                </plugins>\r\n            </build>\r\n        </profile>\r\n    </profiles>\r\n</project>\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\bin\\pom.xml =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\bin\\src\\main\\resources\\META-INF\\persistence.xml =====\n```\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<persistence version=\"2.1\" xmlns=\"http://xmlns.jcp.org/xml/ns/persistence\"\r\n             xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\r\n             xsi:schemaLocation=\"http://xmlns.jcp.org/xml/ns/persistence http://xmlns.jcp.org/xml/ns/persistence/persistence_2_1.xsd\">\r\n    <persistence-unit name=\"Assortmenttool\">\r\n    </persistence-unit>\r\n</persistence>\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\bin\\src\\main\\resources\\META-INF\\persistence.xml =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\pom.xml =====\n```\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\r\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\r\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\">\r\n    <modelVersion>4.0.0</modelVersion>\r\n\r\n    <groupId>com.hom</groupId>\r\n    <artifactId>Assortmenttool</artifactId>\r\n    <name>Assortmenttool</name>\r\n    <description>Assortmenttool</description>\r\n\r\n    <properties>\r\n        <java.version>1.8</java.version>\r\n        <spring.version>2.6.6</spring.version>\r\n        <!-- Version Ã¼ber 3.7.0 verursacht Fehler bei GraphClient Authentification -->\r\n        <azure.version>3.7.0</azure.version>\r\n        <vaadin.version>14.10.1</vaadin.version>\r\n        <!-- LOG4J Exploit Fix? -->\r\n        <log4j2.version>2.15.0</log4j2.version>\r\n    </properties>\r\n\r\n    <parent>\r\n        <groupId>org.springframework.boot</groupId>\r\n        <artifactId>spring-boot-starter-parent</artifactId>\r\n        <version>2.6.6</version>\r\n        <relativePath/> <!-- lookup parent from repository -->\r\n    </parent>\r\n\r\n    <repositories>\r\n        <repository>\r\n            <id>vaadin-addons</id>\r\n            <url>https://maven.vaadin.com/vaadin-addons</url>\r\n        </repository>\r\n    </repositories>\r\n\r\n    <dependencyManagement>\r\n        <dependencies>\r\n            <dependency>\r\n                <groupId>com.azure.spring</groupId>\r\n                <artifactId>azure-spring-boot-bom</artifactId>\r\n                <version>${azure.version}</version>\r\n                <type>pom</type>\r\n                <scope>import</scope>\r\n            </dependency>\r\n            <dependency>\r\n                <groupId>com.vaadin</groupId>\r\n                <artifactId>vaadin-bom</artifactId>\r\n                <version>${vaadin.version}</version>\r\n                <type>pom</type>\r\n                <scope>import</scope>\r\n            </dependency>\r\n        </dependencies>\r\n    </dependencyManagement>\r\n\r\n    <dependencies>\r\n        <dependency>\r\n            <groupId>org.springframework.boot</groupId>\r\n            <artifactId>spring-boot-starter-jersey</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.springframework.boot</groupId>\r\n            <artifactId>spring-boot-starter-actuator</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.springframework.cloud</groupId>\r\n            <artifactId>spring-cloud-starter</artifactId>\r\n            <version>3.1.1</version>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.springframework.boot</groupId>\r\n            <artifactId>spring-boot-starter-validation</artifactId>\r\n        </dependency>\r\n        <!-- MS Azure Active Directory -->\r\n        <dependency>\r\n            <groupId>com.azure.spring</groupId>\r\n            <artifactId>azure-spring-boot-starter-active-directory</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.springframework.boot</groupId>\r\n            <artifactId>spring-boot-starter-oauth2-client</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.springframework.boot</groupId>\r\n            <artifactId>spring-boot-starter-oauth2-resource-server</artifactId>\r\n        </dependency>\r\n        <!-- MS Graph Service -->\r\n        <dependency>\r\n            <groupId>com.microsoft.graph</groupId>\r\n            <artifactId>microsoft-graph</artifactId>\r\n            <version>5.41.0</version>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>com.azure</groupId>\r\n            <artifactId>azure-identity</artifactId>\r\n        </dependency>\r\n\r\n        <!-- Vaadin -->\r\n        <dependency>\r\n            <groupId>com.vaadin</groupId>\r\n            <artifactId>vaadin-spring-boot-starter</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>com.vaadin</groupId>\r\n            <artifactId>vaadin</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>com.vaadin</groupId>\r\n            <artifactId>vaadin-split-layout-flow</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.vaadin.stefan</groupId>\r\n            <artifactId>lazy-download-button</artifactId>\r\n            <version>1.0.0</version>\r\n        </dependency>\r\n        <!-- use appropriate version -->\r\n        <dependency>\r\n            <groupId>org.vaadin.gatanaso</groupId>\r\n            <artifactId>multiselect-combo-box-flow</artifactId>\r\n            <version>3.0.2</version>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>dev.mett.vaadin</groupId>\r\n            <artifactId>tooltip</artifactId>\r\n            <version>2.3.0</version>\r\n        </dependency>\r\n\r\n        <!-- Informatica Rest-Service-Client -->\r\n        <dependency>\r\n            <groupId>com.heiler.pim</groupId>\r\n            <artifactId>webservice-client</artifactId>\r\n            <version>1.0.0</version>\r\n        </dependency>\r\n        <!-- Informatica Rest-Service-Client needed ressources -->\r\n        <dependency>\r\n            <groupId>com.sun.jersey</groupId>\r\n            <artifactId>jersey-client</artifactId>\r\n            <version>1.19.4</version>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>com.sun.jersey</groupId>\r\n            <artifactId>jersey-core</artifactId>\r\n            <version>1.19.4</version>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>com.sun.jersey</groupId>\r\n            <artifactId>jersey-json</artifactId>\r\n            <version>1.19.4</version>\r\n        </dependency>\r\n\r\n        <!-- Excel import -->\r\n        <dependency>\r\n            <groupId>org.apache.poi</groupId>\r\n            <artifactId>poi</artifactId>\r\n            <version>4.1.1</version>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.apache.poi</groupId>\r\n            <artifactId>poi-ooxml</artifactId>\r\n            <version>4.1.1</version>\r\n        </dependency>\r\n        <!-- embedded DataBase -->\r\n        <dependency>\r\n            <groupId>org.springframework.boot</groupId>\r\n            <artifactId>spring-boot-starter-data-jpa</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>com.microsoft.sqlserver</groupId>\r\n            <artifactId>mssql-jdbc</artifactId>\r\n            <scope>runtime</scope>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>com.fasterxml.jackson.datatype</groupId>\r\n            <artifactId>jackson-datatype-hibernate5</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.projectlombok</groupId>\r\n            <artifactId>lombok</artifactId>\r\n            <optional>true</optional>\r\n        </dependency>\r\n        <!-- Java Doc fix -->\r\n        <dependency>\r\n            <groupId>javax.interceptor</groupId>\r\n            <artifactId>javax.interceptor-api</artifactId>\r\n            <version>1.2.2</version>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.springframework.boot</groupId>\r\n            <artifactId>spring-boot-configuration-processor</artifactId>\r\n            <optional>true</optional>\r\n        </dependency>\r\n        <!-- Swagger -->\r\n        <dependency>\r\n            <groupId>io.springfox</groupId>\r\n            <artifactId>springfox-boot-starter</artifactId>\r\n            <version>3.0.0</version>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>io.springfox</groupId>\r\n            <artifactId>springfox-swagger-ui</artifactId>\r\n            <version>3.0.0</version>\r\n        </dependency>\r\n        <!-- Spring boot Admin -->\r\n        <dependency>\r\n            <groupId>org.jolokia</groupId>\r\n            <artifactId>jolokia-core</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.springframework.boot</groupId>\r\n            <artifactId>spring-boot-starter-security</artifactId>\r\n        </dependency>\r\n        <!-- Security 2 -->\r\n        <dependency>\r\n            <groupId>com.github.ulisesbocchio</groupId>\r\n            <artifactId>jasypt-spring-boot-starter</artifactId>\r\n            <version>3.0.5</version>\r\n        </dependency>\r\n        <!-- Test -->\r\n        <dependency>\r\n            <groupId>org.springframework.boot</groupId>\r\n            <artifactId>spring-boot-devtools</artifactId>\r\n            <optional>true</optional>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.springframework.boot</groupId>\r\n            <artifactId>spring-boot-starter-test</artifactId>\r\n            <scope>test</scope>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>com.vaadin</groupId>\r\n            <artifactId>vaadin-testbench</artifactId>\r\n            <scope>test</scope>\r\n        </dependency>\r\n\r\n        <dependency>\r\n            <groupId>io.github.bonigarcia</groupId>\r\n            <artifactId>webdrivermanager</artifactId>\r\n            <version>5.3.1</version>\r\n            <scope>test</scope>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.junit.vintage</groupId>\r\n            <artifactId>junit-vintage-engine</artifactId>\r\n            <scope>test</scope>\r\n            <exclusions>\r\n                <exclusion>\r\n                    <groupId>org.hamcrest</groupId>\r\n                    <artifactId>hamcrest-core</artifactId>\r\n                </exclusion>\r\n            </exclusions>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.mockito</groupId>\r\n            <artifactId>mockito-all</artifactId>\r\n            <version>1.10.19</version>\r\n            <scope>test</scope>\r\n        </dependency>\r\n    </dependencies>\r\n\r\n\r\n    <build>\r\n        <finalName>${project.name}</finalName>\r\n        <plugins>\r\n            <plugin>\r\n                <groupId>org.springframework.boot</groupId>\r\n                <artifactId>spring-boot-maven-plugin</artifactId>\r\n                <configuration>\r\n                    <!-- <jvmArguments>-Dvaadin.productionMode</jvmArguments> -->\r\n                </configuration>\r\n            </plugin>\r\n            <plugin>\r\n                <groupId>com.vaadin</groupId>\r\n                <artifactId>vaadin-maven-plugin</artifactId>\r\n                <version>${vaadin.version}</version>\r\n                <executions>\r\n                    <execution>\r\n                        <goals>\r\n                            <goal>prepare-frontend</goal>\r\n                        </goals>\r\n                        <phase>compile</phase>\r\n                    </execution>\r\n                </executions>\r\n            </plugin>\r\n            <plugin>\r\n                <groupId>com.github.ulisesbocchio</groupId>\r\n                <artifactId>jasypt-maven-plugin</artifactId>\r\n                <version>3.0.5</version>\r\n            </plugin>\r\n        </plugins>\r\n    </build>\r\n    <profiles>\r\n        <profile>\r\n            <!-- Production mode is activated using -Pproduction -->\r\n            <id>production</id>\r\n            <properties>\r\n                <vaadin.productionMode>true</vaadin.productionMode>\r\n            </properties>\r\n\r\n            <dependencies>\r\n                <dependency>\r\n                    <groupId>com.vaadin</groupId>\r\n                    <artifactId>flow-server-production-mode</artifactId>\r\n                </dependency>\r\n            </dependencies>\r\n\r\n            <build>\r\n                <plugins>\r\n                    <plugin>\r\n                        <groupId>org.springframework.boot</groupId>\r\n                        <artifactId>spring-boot-maven-plugin</artifactId>\r\n                        <executions>\r\n                            <execution>\r\n                                <goals>\r\n                                    <goal>build-info</goal>\r\n                                </goals>\r\n                            </execution>\r\n                        </executions>\r\n                        <configuration>\r\n                            <jvmArguments>\r\n                                -Dvaadin.productionMode\r\n                                -XX:NewSize=512m\r\n                                -XX:MaxNewSize=512m -Xms2048m\r\n                                -Xmx2048m -XX:MetaspaceSize=512m\r\n                                -XX:MaxMetaspaceSize=512m\r\n                                -XX:SurvivorRatio=12\r\n                                -XX:TargetSurvivorRatio=90\r\n                                -XX:MaxTenuringThreshold=15\r\n                                -XX:+UseLargePages\r\n                                -XX:LargePageSizeInBytes=256m -XX:+UseParNewGC\r\n                                -XX:ParallelGCThreads=16 -XX:+UseConcMarkSweepGC\r\n                                -XX:+CMSParallelRemarkEnabled\r\n                                -XX:+CMSCompactWhenClearAllSoftRefs\r\n                                -XX:CMSInitiatingOccupancyFraction=85\r\n                                -XX:+CMSScavengeBeforeRemark\r\n                                -XX:+UseLargePages\r\n                                -XX:LargePageSizeInBytes=256m\r\n                                -XX:+UseCompressedOops\r\n                                -XX:+DisableExplicitGC -XX:-UseBiasedLocking\r\n                                -XX:+BindGCTaskThreadsToCPUs -XX:+UseFastAccessorMethods\r\n                                -XX:InitialCodeCacheSize=32m -XX:ReservedCodeCacheSize=96m\r\n                            </jvmArguments>\r\n                        </configuration>\r\n                    </plugin>\r\n                    <plugin>\r\n                        <groupId>pl.project13.maven</groupId>\r\n                        <artifactId>git-commit-id-plugin</artifactId>\r\n                        <version>4.9.10</version>\r\n                    </plugin>\r\n                    <plugin>\r\n                        <groupId>com.vaadin</groupId>\r\n                        <artifactId>vaadin-maven-plugin</artifactId>\r\n                        <version>${vaadin.version}</version>\r\n                        <executions>\r\n                            <execution>\r\n                                <goals>\r\n                                    <goal>build-frontend</goal>\r\n                                </goals>\r\n                                <phase>compile</phase>\r\n                            </execution>\r\n                        </executions>\r\n                    </plugin>\r\n                    <plugin>\r\n                        <groupId>org.apache.maven.plugins</groupId>\r\n                        <artifactId>maven-failsafe-plugin</artifactId>\r\n                        <version>2.19.1</version>\r\n                        <executions>\r\n                            <execution>\r\n                                <goals>\r\n                                    <goal>integration-test</goal>\r\n                                    <goal>verify</goal>\r\n                                </goals>\r\n                            </execution>\r\n                        </executions>\r\n                        <configuration>\r\n                            <trimStackTrace>false</trimStackTrace>\r\n                        </configuration>\r\n                    </plugin>\r\n                </plugins>\r\n            </build>\r\n        </profile>\r\n        <profile>\r\n            <!-- Production mode is activated using -Pdevelopment -->\r\n            <id>development</id>\r\n            <properties>\r\n                <vaadin.productionMode>true</vaadin.productionMode>\r\n            </properties>\r\n\r\n            <dependencies>\r\n                <dependency>\r\n                    <groupId>com.vaadin</groupId>\r\n                    <artifactId>flow-server-production-mode</artifactId>\r\n                </dependency>\r\n            </dependencies>\r\n\r\n            <build>\r\n                <plugins>\r\n                    <plugin>\r\n                        <groupId>org.springframework.boot</groupId>\r\n                        <artifactId>spring-boot-maven-plugin</artifactId>\r\n                        <executions>\r\n                            <execution>\r\n                                <goals>\r\n                                    <goal>build-info</goal>\r\n                                </goals>\r\n                            </execution>\r\n                        </executions>\r\n                        <configuration>\r\n                            <fork>false</fork>\r\n                            <profiles>\r\n                                <profile>developing</profile>\r\n                            </profiles>\r\n                        </configuration>\r\n                    </plugin>\r\n                    <plugin>\r\n                        <groupId>pl.project13.maven</groupId>\r\n                        <artifactId>git-commit-id-plugin</artifactId>\r\n                        <version>4.9.10</version>\r\n                    </plugin>\r\n                    <plugin>\r\n                        <groupId>com.vaadin</groupId>\r\n                        <artifactId>vaadin-maven-plugin</artifactId>\r\n                        <version>${vaadin.version}</version>\r\n                        <executions>\r\n                            <execution>\r\n                                <goals>\r\n                                    <goal>build-frontend</goal>\r\n                                </goals>\r\n                                <phase>compile</phase>\r\n                            </execution>\r\n                        </executions>\r\n                    </plugin>\r\n                    <plugin>\r\n                        <groupId>org.apache.maven.plugins</groupId>\r\n                        <artifactId>maven-failsafe-plugin</artifactId>\r\n                        <version>2.19.1</version>\r\n                        <executions>\r\n                            <execution>\r\n                                <goals>\r\n                                    <goal>integration-test</goal>\r\n                                    <goal>verify</goal>\r\n                                </goals>\r\n                            </execution>\r\n                        </executions>\r\n                        <configuration>\r\n                            <trimStackTrace>false</trimStackTrace>\r\n                            <systemPropertyVariables>\r\n                                <webdriver.chrome.driver>${webdriver.chrome.driver}</webdriver.chrome.driver>\r\n                            </systemPropertyVariables>\r\n                        </configuration>\r\n                    </plugin>\r\n                </plugins>\r\n            </build>\r\n        </profile>\r\n    </profiles>\r\n</project>\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\pom.xml =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\AssortmenttoolApplication.java =====\n```\npackage com.hom.ebmw;\r\n\r\nimport org.springframework.boot.SpringApplication;\r\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\r\nimport org.springframework.boot.autoconfigure.web.servlet.error.ErrorMvcAutoConfiguration;\r\nimport org.springframework.data.jpa.repository.config.EnableJpaRepositories;\r\n\r\n/**\r\n * @author Roberg, Felix\r\n * <p>\r\n * To deactived Spring-Boot default Security its nessassary to use this option\r\n * SpringBootApplication(exclude = ErrorMvcAutoConfiguration.class)\r\n * <p>\r\n * This is needed to use Jpa-Repositories\r\n * EnableJpaRepositories\r\n */\r\n@SpringBootApplication(exclude = ErrorMvcAutoConfiguration.class, scanBasePackages = \"com.hom.ebmw\")\r\n@EnableJpaRepositories\r\npublic class AssortmenttoolApplication {\r\n\r\n    public static void main(String[] args) {\r\n        SpringApplication.run(AssortmenttoolApplication.class, args);\r\n    }\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\AssortmenttoolApplication.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\ApplicationProperty.java =====\n```\npackage com.hom.ebmw.configuration;\r\n\r\nimport lombok.Getter;\r\nimport lombok.Setter;\r\nimport org.springframework.boot.context.properties.ConfigurationProperties;\r\nimport org.springframework.context.annotation.Configuration;\r\nimport org.springframework.validation.annotation.Validated;\r\n\r\nimport javax.validation.constraints.Max;\r\nimport javax.validation.constraints.Min;\r\n\r\n@Getter\r\n@Setter\r\n@Configuration\r\n@ConfigurationProperties(prefix = \"ast\")\r\n@Validated\r\npublic class ApplicationProperty {\r\n    private String startMode;\r\n    private String version;\r\n    private String primaryPort;\r\n\r\n    private String bannerImage;\r\n    private String colorHeader;\r\n    private String colorMenue;\r\n    private String colorButton;\r\n\r\n    private String redirectPort;\r\n\r\n    @Min(1)\r\n    @Max(40)\r\n    private String tempAssortments;\r\n\r\n    private String translationLang;\r\n    private String translationPath;\r\n    private String initialAdmin;\r\n    private String system;\r\n    private String logoutAdress;\r\n    private String specificGroup;\r\n    private boolean exportParam;\r\n    private String homInitial;\r\n}\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\ApplicationProperty.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\ArticleBaseQueueLoader.java =====\n```\npackage com.hom.ebmw.configuration;\r\n\r\nimport com.hom.ebmw.AssortmenttoolApplication;\r\nimport com.hom.ebmw.exceptions.ParamterNotValidException;\r\nimport com.hom.ebmw.jpa.dao.ArticleBaseQueueDAO;\r\nimport com.hom.ebmw.jpa.dao.impl.ArticleBaseRepository;\r\nimport com.hom.ebmw.jpa.model.ArticleBaseQueue;\r\nimport com.hom.ebmw.utilities.Parse;\r\nimport com.vaadin.flow.spring.annotation.SpringComponent;\r\nimport lombok.extern.slf4j.Slf4j;\r\nimport org.springframework.boot.SpringApplication;\r\nimport org.springframework.boot.WebApplicationType;\r\nimport org.springframework.boot.builder.SpringApplicationBuilder;\r\nimport org.springframework.context.ConfigurableApplicationContext;\r\nimport org.springframework.jdbc.core.JdbcTemplate;\r\n\r\nimport javax.annotation.PostConstruct;\r\nimport java.time.LocalDateTime;\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\n\r\n/**\r\n * @author Roberg, Felix\r\n * <p>\r\n * Queue Builder\r\n * initial CacheQueue After Restart\r\n */\r\n@Slf4j\r\n@SpringComponent\r\npublic class ArticleBaseQueueLoader {\r\n    private static final String INSTALL = \"install\";\r\n    private static final String DEBUG = \"debug\";\r\n    private final ApplicationProperty property;\r\n\r\n    private final ArticleBaseQueueDAO articleBaseQueueService;\r\n\r\n    private final ArticleBaseRepository articleBaseCustomeService;\r\n\r\n    private final JdbcTemplate dbService;\r\n\r\n    /**\r\n     * The ArticleBaseQueueLoader function is a function that loads the ArticleBaseQueue table with data from the ArticleBase table.\r\n     * The function will load all of the rows in the ArticleBase table into memory, and then insert them into\r\n     * an empty queue. It will then return this queue to be used by other functions.\r\n     *\r\n     * @param ApplicationProperty   property Get the value of the property in application\r\n     * @param ArticleBaseQueueDAO   articleBaseQueueService Call the getarticlebasequeue() method\r\n     * @param ArticleBaseRepository articleBaseCustomeService Call the findbyarticlebaseid method\r\n     *                              public articlebasequeue load(string articlebaseid) {\r\n     *                              <p>\r\n     *                              articlebasequeue article = null;\r\n     *                              try {\r\n     * @param JdbcTemplate          dbService Call the getarticlebasequeuelist() method\r\n     * @return A function that takes an articlebasequeue and returns a completablefuture&lt;articlebase&gt;\r\n     * @docauthor Trelent\r\n     */\r\n    public ArticleBaseQueueLoader(ApplicationProperty property, ArticleBaseQueueDAO articleBaseQueueService, ArticleBaseRepository articleBaseCustomeService, JdbcTemplate dbService) {\r\n        this.property = property;\r\n        this.articleBaseQueueService = articleBaseQueueService;\r\n        this.articleBaseCustomeService = articleBaseCustomeService;\r\n        this.dbService = dbService;\r\n    }\r\n\r\n\r\n    /**\r\n     * The startQueue function is called by the\r\n     *\r\n     * @return Void\r\n     * @docauthor Trelent\r\n     */\r\n    @PostConstruct\r\n    public void startQueue() {\r\n\r\n        String anzTabels = \"\";\r\n        int anzahl = 0;\r\n        // remove if Temp Table exits\r\n\r\n        property.getStartMode();\r\n\r\n        if (property.getStartMode().equals(INSTALL)) {\r\n            try {\r\n                anzTabels = property.getTempAssortments();\r\n                anzahl = Parse.toInt(anzTabels);\r\n                if (anzahl <= 0 || anzahl > 100) {\r\n                    throw new ParamterNotValidException();\r\n                } else {\r\n                    log.info(\"=======JPA========\");\r\n                    log.info(\"==Initial-Queue===\");\r\n                    log.info(\"==================\");\r\n\r\n                }\r\n                dropCacheTables();\r\n            } catch (ParamterNotValidException e) {\r\n                log.error(\"**********************************\");\r\n                log.error(\"* application.propertie          *\");\r\n                log.error(\"* ast.temp.assortment.anz=10-100 *\");\r\n                log.error(\"**********************************\");\r\n                exit();\r\n            }\r\n        }\r\n        if (property.getStartMode().equals(INSTALL) || property.getStartMode().equals(DEBUG)) {\r\n            articleBaseQueueService.deleteAll();\r\n            List<ArticleBaseQueue> queues = new ArrayList<>();\r\n            for (int i = 1; i <= anzahl; i++) {\r\n                String format = \"%0\" + anzTabels.length() + \"d\";\r\n                String formatId = String.format(format, i);\r\n                createCacheTable(formatId);\r\n                ArticleBaseQueue queue = new ArticleBaseQueue();\r\n                int id = i;\r\n                articleBaseCustomeService.truncateArticleTable(id);\r\n                queue.setTempId(id);\r\n                queue.setSession(\"\");\r\n                queue.setTableName(\"AST_ARTICLE_BASE_\" + formatId);\r\n                queue.setValid(1);\r\n                queue.setLoadOn(LocalDateTime.now());\r\n                queue.setUser(null);\r\n                queues.add(queue);\r\n            }\r\n            articleBaseQueueService.saveAll(queues);\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * The createCacheTable function creates a table in the database with the name AST_ARTICLE_BASE_&lt;tableId&gt;.\r\n     * The table has columns for all of the fields that are present in an article.\r\n     *\r\n     * @param String tableId Create a table with the name ast_article_base_&lt;tableid&gt;\r\n     *               private void createcachetable(string tableid) {\r\n     *               string sqlcreate = &quot;create table ast_article_base&quot; + &quot;_&quot; + tableid + &quot;(&quot; +\r\n     * @return Nothing\r\n     * @docauthor Trelent\r\n     */\r\n    private void createCacheTable(String tableId) {\r\n        String sqlCreate = \"CREATE TABLE AST_ARTICLE_BASE_\" + tableId + \"(\" +\r\n                \"\tID VARCHAR(255) NOT NULL PRIMARY KEY,\" +\r\n                \"\tTERRITORY VARCHAR(255) DEFAULT '',\" +\r\n                \"\tCUSTOMER_NR VARCHAR(255) DEFAULT '',\" +\r\n                \"\tCUSTOMER_ARTICLE_NR VARCHAR(255) DEFAULT '',\" +\r\n                \"\tARTICLE_NR VARCHAR(255) DEFAULT '',\" +\r\n                \"\tCURRENCY VARCHAR(255) DEFAULT '',\" +\r\n                \"\tPRICE_FIRST VARCHAR(255),\" +\r\n                \"\tPRICE_X VARCHAR(255) DEFAULT '',\" +\r\n                \"\tPRICE_TYPE VARCHAR(255) DEFAULT '',\" +\r\n                \"\tVALID_FROM VARCHAR(255) DEFAULT '',\" +\r\n                \"\tVALID_TO VARCHAR(255) DEFAULT '',\" +\r\n                \"\tSCALELIMIT VARCHAR(255) DEFAULT '',\" +\r\n                \"\tFOUND_ARTICLE_STATUS INT DEFAULT 0,\" +\r\n                \"\tSPECIAL INT DEFAULT 0,\" +\r\n                \"\tCOMMENT VARCHAR(1024) DEFAULT '',\" +\r\n                \"\tBASICASSORTMENT INT DEFAULT 0,\" +\r\n                \"\tARTICLE_REVISION_ID INT DEFAULT 0,\" +\r\n                \"\tASSORTMENT_ID INT DEFAULT NULL )\";\r\n        dbService.execute(sqlCreate);\r\n    }\r\n\r\n\r\n    /**\r\n     * The exit function is used to exit the application.\r\n     *\r\n     * @return A configurableapplicationcontext\r\n     * @docauthor Trelent\r\n     */\r\n    private void exit() {\r\n        ConfigurableApplicationContext ctx = new SpringApplicationBuilder(AssortmenttoolApplication.class).web(WebApplicationType.NONE).run();\r\n        SpringApplication.exit(ctx, () -> 0);\r\n    }\r\n\r\n\r\n    /**\r\n     * The dropCacheTables function drops all of the tables that are used to cache article data.\r\n     * <p>\r\n     * The dropCacheTables function is called by the clearCache function, which is called when a user clicks on the &quot;Clear Cache&quot; button in the admin panel.\r\n     *\r\n     * @return A list of tables to drop\r\n     * @docauthor Trelent\r\n     */\r\n    private void dropCacheTables() {\r\n        String sqlSelect = \"Select CONCAT('DROP TABLE ',name) as TABLENAMES from sys.tables where name like 'AST_ARTICLE_BASE_[0-9]%' order by name\";\r\n        List<String> toDrop = dbService.queryForList(sqlSelect, String.class);\r\n        toDrop.forEach(drop -> dbService.execute(drop));\r\n    }\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\ArticleBaseQueueLoader.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\AuthenticationSuccessListener.java =====\n```\npackage com.hom.ebmw.configuration;\r\n\r\nimport com.azure.spring.aad.AADOAuth2AuthenticatedPrincipal;\r\nimport lombok.extern.slf4j.Slf4j;\r\nimport org.springframework.context.ApplicationListener;\r\nimport org.springframework.security.authentication.event.AuthenticationSuccessEvent;\r\nimport org.springframework.security.core.Authentication;\r\nimport org.springframework.security.oauth2.client.authentication.OAuth2LoginAuthenticationToken;\r\nimport org.springframework.security.oauth2.core.user.OAuth2User;\r\nimport org.springframework.security.oauth2.server.resource.authentication.BearerTokenAuthentication;\r\nimport org.springframework.stereotype.Component;\r\n\r\n\r\n/**\r\n * @author Roberg, Felix\r\n * <p>\r\n * Listener to Handle Incoming Logging Request.\r\n */\r\n\r\n@Slf4j\r\n@Component\r\npublic class AuthenticationSuccessListener implements ApplicationListener<AuthenticationSuccessEvent> {\r\n\r\n    /**\r\n     * The onApplicationEvent function is called whenever a user successfully logs in.\r\n     * It checks the type of authentication used and prints out the name of the user who logged in.\r\n     *\r\n     * @param AuthenticationSuccessEvent event Get the authentication object\r\n     * @return A boolean\r\n     * @docauthor Trelent\r\n     */\r\n    @Override\r\n    public void onApplicationEvent(AuthenticationSuccessEvent event) {\r\n        Authentication auth = event.getAuthentication();\r\n        log.debug(\"Authentication class: \" + auth.getClass().toString());\r\n\r\n        //OAuth2LoginAuthenticationToken\r\n        if (auth instanceof OAuth2LoginAuthenticationToken) {\r\n\r\n            OAuth2LoginAuthenticationToken oauth2 = (OAuth2LoginAuthenticationToken) auth;\r\n            OAuth2User oAuth2User = oauth2.getPrincipal();\r\n            log.debug(\"User {} logged in \", oAuth2User.getName());\r\n        } else //BearerTokenAuthentication\r\n            if (auth instanceof BearerTokenAuthentication) {\r\n                BearerTokenAuthentication oauth2 = (BearerTokenAuthentication) auth;\r\n                try {\r\n                    if (oauth2.getPrincipal() instanceof AADOAuth2AuthenticatedPrincipal) {\r\n                        AADOAuth2AuthenticatedPrincipal principal = (AADOAuth2AuthenticatedPrincipal) oauth2.getPrincipal();\r\n                        log.debug(\"User {} logged in \", principal.getAttribute(\"name\").toString());\r\n                    }\r\n                } catch (NullPointerException e) {\r\n                    log.error(\"OAuth2 not Valid\");\r\n                }\r\n\r\n            } else {\r\n                log.warn(\"User authenticated by a non OAuth2 mechanism. Class is \" + auth.getClass());\r\n            }\r\n\r\n    }\r\n\r\n\r\n}\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\AuthenticationSuccessListener.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\InitalConfig.java =====\n```\npackage com.hom.ebmw.configuration;\r\n\r\nimport com.hom.ebmw.configuration.security.Services;\r\nimport com.hom.ebmw.configuration.security.SessionUtils;\r\nimport com.hom.ebmw.jpa.model.*;\r\nimport com.hom.ebmw.pojo.Context;\r\nimport com.hom.ebmw.pojo.UserSession;\r\nimport com.hom.ebmw.utilities.InitialUtils;\r\nimport com.hom.ebmw.utilities.SchedulerUtils;\r\nimport com.hom.ebmw.utilities.constans.ASTConst;\r\nimport com.hom.ebmw.utilities.enums.CTXAttribute;\r\nimport com.hom.ebmw.view.admin.AdminHeader;\r\nimport com.hom.ebmw.view.admin.AdminView;\r\nimport com.vaadin.flow.spring.annotation.SpringComponent;\r\nimport lombok.extern.slf4j.Slf4j;\r\n\r\nimport javax.annotation.PostConstruct;\r\nimport java.util.List;\r\nimport java.util.Optional;\r\n\r\n\r\n/**\r\n * Boot Class to Initial Database Structure\r\n */\r\n@Slf4j\r\n@SpringComponent\r\npublic class InitalConfig {\r\n\r\n    private static final String INSTALL = \"install\";\r\n    private static final String DEBUG = \"debug\";\r\n\r\n    private final Context ctx = new Context();\r\n\r\n    private final Services services;\r\n\r\n    /**\r\n     * The InitalConfig function is used to set up the initial configuration of the game.\r\n     * It sets up a new board, and then places all of the pieces in their starting positions.\r\n     *\r\n     * @param Services services Access the services that are provided by the framework\r\n     * @return A string\r\n     * @docauthor Trelent\r\n     */\r\n    public InitalConfig(Services services) {\r\n        this.services = services;\r\n    }\r\n\r\n\r\n    /**\r\n     * The initialConfig function is called by the Spring Framework after the application context has been initialized.\r\n     * It initializes a number of variables in the application context, including:\r\n     * &lt;ul&gt;\r\n     * &lt;li&gt;The sessionUtils object&lt;/li&gt;\r\n     * &lt;li&gt;The services object&lt;/li&gt;\r\n     * &lt;li&gt;&quot;userSession&quot; - an empty UserSession object&lt;/li&gt;&lt;/ul&gt;&lt;br/&gt;It also checks if there are any roles in the database. If not, it creates a new role with name &quot;admin&quot;, and assigns all permissions to that role.&lt;br/&gt;Finally, it starts up two\r\n     *\r\n     * @return An object of type initialconfig\r\n     * @docauthor Trelent\r\n     */\r\n    @PostConstruct\r\n    public void initialConfig() {\r\n        ctx.put(CTXAttribute.SESSION, new SessionUtils(services.getUserServices()));\r\n        ctx.put(CTXAttribute.SERVICES, services);\r\n        ctx.put(CTXAttribute.USER_SESSION, new UserSession());\r\n\r\n        //System initial\r\n        if (services.getRoleUserService().findAll().isEmpty()) {\r\n            services.getRolePermissionService().deleteAll();\r\n            services.getPermissionService().deleteAll();\r\n            services.getUserServices().deleteAll();\r\n            services.getRoleService().deleteAll();\r\n\r\n\r\n            Role roleJpa = new Role();\r\n            roleJpa.setName(\"admin\");\r\n\r\n            User initUser = new User();\r\n            initUser.setUserId(services.getProperty().getInitialAdmin());\r\n            initUser.setGivenName(\"\");\r\n            initUser.setSurName(\"\");\r\n            services.getUserServices().save(initUser);\r\n            roleJpa = services.getRoleService().save(roleJpa);\r\n\r\n            RoleUser roleUser = new RoleUser();\r\n            services.getRoleUserService().save(roleUser);\r\n\r\n            updatePermissions(roleJpa);\r\n\r\n            log.info(\"=======JPA========\");\r\n            log.info(\"===Root-initial===\");\r\n            log.info(\"==================\");\r\n        } else {\r\n            log.info(\"=======JPA========\");\r\n            log.info(\"====Root-Ready====\");\r\n            log.info(\"==================\");\r\n        }\r\n\r\n        //Scheduler Service User\r\n        Optional<User> optUser = ctx.getServices().getUserServices().findByUserId(ASTConst.FAKE);\r\n        if (!optUser.isPresent()) {\r\n            User user = new User();\r\n            user.setUserId(ASTConst.FAKE);\r\n            user.setGivenName(\"SYSTEM\");\r\n            user.setSurName(\"\");\r\n            Optional<Role> optRole = ctx.getServices().getRoleService().findByName(\"admin\");\r\n            optRole.ifPresent(item -> {\r\n                user.setRole(item);\r\n                user.setLocale(\"en-EN\");\r\n                user.setActive(true);\r\n                ctx.getServices().getUserServices().save(user);\r\n            });\r\n        }\r\n\r\n        //PROMOTION CUSTOMER\r\n        Optional<LocalCustomer> optCustomer = ctx.getServices().getLocalCustomerService().findByCustomerId(ASTConst.PROMOTION_CUSTOMER);\r\n        if (!optCustomer.isPresent()) {\r\n            LocalCustomer customer = new LocalCustomer();\r\n            customer.setCity(\"-FAKE-\");\r\n            customer.setCompanyBranch(\"-TIP/DT-\");\r\n            customer.setCustomerId(ASTConst.PROMOTION_CUSTOMER);\r\n            customer.setCurrencyByName(\"EUR\");\r\n            customer.setEBusiness(\"-TIP/EP-\");\r\n            customer.setLanguage(\"7\");\r\n            customer.setCountry(\"DE\");\r\n            customer.setKam(\"0\");\r\n            customer.setPricelist(\"DE\");\r\n            customer.setName(\"PROMOTION\");\r\n\r\n            ctx.getServices().getLocalCustomerService().save(customer);\r\n        }\r\n\r\n        String startMode = services.getProperty().getStartMode();\r\n        if (startMode.equals(DEBUG) || startMode.equals(INSTALL)) {\r\n            //initial eCat-Structure\r\n            InitialUtils.initialFilterBase(ctx);\r\n            log.info(\"=initial-default==\");\r\n            log.info(\"==Load-Structure==\");\r\n            log.info(\"==================\");\r\n        }\r\n\r\n\r\n        SchedulerUtils.startUploadDelay(ctx);\r\n    }\r\n\r\n\r\n    /**\r\n     * The updatePermissions function is used to update the permissions for a given role.\r\n     *\r\n     * @param final Role currentRole Get the current role\r\n     *              private void updatepermissions(final role currentrole) {\r\n     *              list&lt;permission&gt; permclass = services\r\n     * @return A void\r\n     * @docauthor Trelent\r\n     */\r\n    private void updatePermissions(final Role currentRole) {\r\n        List<Permission> permClass = services.getPermissionService().findAll();\r\n        if (permClass.isEmpty()) {\r\n            permClass.add(services.getPermissionService().save(new Permission(AdminHeader.class.getCanonicalName())));\r\n            permClass.add(services.getPermissionService().save(new Permission(AdminView.class.getCanonicalName())));\r\n        }\r\n\r\n        List<RolePermission> permissions = services.getRolePermissionService().findByRole(currentRole);\r\n        permissions.forEach(perms ->\r\n                permClass.removeIf(permClazz -> permClazz.equals(perms.getPermission()))\r\n        );\r\n\r\n        permClass.forEach(perms -> {\r\n            RolePermission perm = new RolePermission();\r\n            perm.setRead(true);\r\n            perm.setWrite(true);\r\n            perm.setDelete(true);\r\n            perm.setEdit(true);\r\n            perm.setPermission(perms);\r\n            perm.setRole(currentRole);\r\n            services.getRolePermissionService().save(perm);\r\n        });\r\n    }\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\InitalConfig.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\InitProfil.java =====\n```\npackage com.hom.ebmw.configuration;\r\n\r\nimport lombok.extern.slf4j.Slf4j;\r\nimport org.springframework.stereotype.Component;\r\n\r\nimport javax.annotation.PostConstruct;\r\nimport java.util.Objects;\r\n\r\n@Component\r\n@Slf4j\r\npublic class InitProfil {\r\n\r\n    private final ApplicationProperty property;\r\n\r\n    /**\r\n     * The InitProfil function is used to initialize the profil of a user.\r\n     * It creates a new file in the directory &quot;profils&quot; with the name of\r\n     * the user and it initializes all his properties.\r\n     *\r\n     * @param ApplicationProperty property Set the property of the class\r\n     * @return A string\r\n     * @docauthor Trelent\r\n     */\r\n    public InitProfil(ApplicationProperty property) {\r\n        this.property = property;\r\n    }\r\n\r\n    /**\r\n     * The initialConfig function is a PostConstruct function that runs after the application context has been loaded.\r\n     * It prints out the version of the application and loads any initial configuration files specified in\r\n     * src/main/resources/application.properties under homInitial=&lt;path to config file&gt;.\r\n     *\r\n     * @return A string\r\n     * @docauthor Trelent\r\n     */\r\n    @PostConstruct\r\n    public void initialConfig() {\r\n        String homInitial = property.getHomInitial();\r\n        if (Objects.nonNull(homInitial) && !homInitial.isEmpty()) {\r\n            log.info(\"Profile: Load \" + homInitial);\r\n            log.info(\"Version: \" + property.getVersion());\r\n        }\r\n    }\r\n}\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\InitProfil.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\PimProperty.java =====\n```\npackage com.hom.ebmw.configuration;\r\n\r\nimport lombok.Getter;\r\nimport lombok.Setter;\r\nimport org.springframework.boot.context.properties.ConfigurationProperties;\r\nimport org.springframework.context.annotation.Configuration;\r\n\r\n@Setter\r\n@Getter\r\n@Configuration\r\n@ConfigurationProperties(prefix = \"pim.rest.api\")\r\npublic class PimProperty {\r\n    private String url;\r\n    private String username;\r\n    private String password;\r\n    private String locale;\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\PimProperty.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\PIMRestManager.java =====\n```\npackage com.hom.ebmw.configuration;\r\n\r\nimport com.heiler.pim.webservice.client.RestClient;\r\nimport com.heiler.pim.webservice.client.list.ReportQuery;\r\nimport org.springframework.stereotype.Component;\r\n\r\nimport java.util.Locale;\r\n\r\n@Component\r\npublic class PIMRestManager {\r\n\r\n    private final PimProperty pimProperty;\r\n\r\n    /**\r\n     * The PIMRestManager function is responsible for making the REST calls to the PIM.\r\n     * It takes in a String that represents the URL of the endpoint, and an HttpMethod that\r\n     * represents what type of HTTP request it will be (GET, POST, etc.). The function returns\r\n     * a ResponseEntity&lt;String&gt; object which contains information about both the response body and headers.\r\n     *\r\n     * @param PimProperty pimProperty Set the pimproperty object in this class\r\n     * @return An object of type pimrestmanager\r\n     * @docauthor Trelent\r\n     */\r\n    public PIMRestManager(PimProperty pimProperty) {\r\n        this.pimProperty = pimProperty;\r\n    }\r\n\r\n    // Create and login to the client...\r\n\r\n    /**\r\n     * The getBasicClient function is used to create a RestClient object that can be used to make calls\r\n     * to the PIM API. The function takes no parameters and returns a RestClient object.\r\n     *\r\n     * @return A restclient object\r\n     * @docauthor Trelent\r\n     */\r\n    public RestClient getBasicClient() {\r\n        RestClient restClient = new RestClient();\r\n        restClient.loginWithBasicAuth(pimProperty.getUrl(), pimProperty.getUsername(), pimProperty.getPassword(), getLocale());\r\n        return restClient;\r\n    }\r\n\r\n\r\n    /**\r\n     * The bySearch function is used to search for a specific report.\r\n     *\r\n     * @return A reportquery object\r\n     * @docauthor Trelent\r\n     */\r\n    public ReportQuery bySearch() {\r\n        return new ReportQuery(\"bySearch\");\r\n    }\r\n\r\n\r\n    /**\r\n     * The byCatalog function returns a ReportQuery object that can be used to query the catalog.\r\n     *\r\n     * @return A reportquery object that contains a query string\r\n     * @docauthor Trelent\r\n     */\r\n    public ReportQuery byCatalog() {\r\n        return new ReportQuery(\"byCatalog\");\r\n    }\r\n\r\n\r\n    /**\r\n     * The getLocaleClient function is used to create a RestClient object that can be used to make calls\r\n     * to the PIM API. The function takes in a Locale object as an argument, and uses this locale when creating\r\n     * the RestClient. This allows us to use different locales for different tests, which is useful if we want\r\n     * our tests to run on multiple languages of the PIM.\r\n     *\r\n     * @param Locale locale Set the locale of the client\r\n     * @return A restclient object with the locale set to the parameter passed in\r\n     * @docauthor Trelent\r\n     */\r\n    public RestClient getLocaleClient(Locale locale) {\r\n        RestClient restClient = new RestClient();\r\n        restClient.loginWithBasicAuth(pimProperty.getUrl(), pimProperty.getUsername(), pimProperty.getPassword(), locale);\r\n        return restClient;\r\n    }\r\n\r\n\r\n    /**\r\n     * The getLocale function returns the locale of the PIMProperty.\r\n     *\r\n     * @return A locale object\r\n     * @docauthor Trelent\r\n     */\r\n    private Locale getLocale() {\r\n        return Locale.forLanguageTag(pimProperty.getLocale());\r\n    }\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\PIMRestManager.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\security\\AADOWebAndResourceServerConfig.java =====\n```\npackage com.hom.ebmw.configuration.security;\r\n\r\nimport com.azure.spring.aad.webapi.AADResourceServerWebSecurityConfigurerAdapter;\r\nimport com.azure.spring.aad.webapp.AADWebSecurityConfigurerAdapter;\r\nimport com.hom.ebmw.utilities.interfaces.PageConst;\r\nimport org.springframework.context.annotation.Configuration;\r\nimport org.springframework.core.annotation.Order;\r\nimport org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler;\r\nimport org.springframework.security.access.expression.method.MethodSecurityExpressionHandler;\r\nimport org.springframework.security.config.annotation.method.configuration.EnableGlobalMethodSecurity;\r\nimport org.springframework.security.config.annotation.method.configuration.GlobalMethodSecurityConfiguration;\r\nimport org.springframework.security.config.annotation.web.builders.HttpSecurity;\r\nimport org.springframework.security.config.annotation.web.builders.WebSecurity;\r\nimport org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;\r\nimport org.springframework.security.oauth2.client.oidc.userinfo.OidcUserRequest;\r\nimport org.springframework.security.oauth2.client.userinfo.OAuth2UserService;\r\nimport org.springframework.security.oauth2.core.oidc.user.OidcUser;\r\n\r\n@EnableWebSecurity\r\n@EnableGlobalMethodSecurity(prePostEnabled = true)\r\npublic class AADOWebAndResourceServerConfig extends GlobalMethodSecurityConfiguration {\r\n\r\n    private final Services services;\r\n\r\n    /**\r\n     * The AADOWebAndResourceServerConfig function is a constructor that takes in the Services object and sets it to the services variable.\r\n     *\r\n     * @param Services services Access the services of the application\r\n     * @return A new aadowebandresourceserverconfig object\r\n     * @docauthor Trelent\r\n     */\r\n    public AADOWebAndResourceServerConfig(Services services) {\r\n        this.services = services;\r\n    }\r\n\r\n    /**\r\n     * set ownPermission Services\r\n     */\r\n    /**\r\n     * The createExpressionHandler function is used to create a MethodSecurityExpressionHandler.\r\n     * This handler is responsible for evaluating expressions in\r\n     *\r\n     * @return An object of type methodsecurityexpressionhandler\r\n     * @docauthor Trelent\r\n     */\r\n    @Override\r\n    protected MethodSecurityExpressionHandler createExpressionHandler() {\r\n        DefaultMethodSecurityExpressionHandler expressionHandler = new DefaultMethodSecurityExpressionHandler();\r\n        expressionHandler.setPermissionEvaluator(new CustomPermissionEvaluator(services));\r\n        return expressionHandler;\r\n    }\r\n\r\n    @Order(1)\r\n    @Configuration\r\n    public static class APIWebSecurityConfigurationAdapter extends AADResourceServerWebSecurityConfigurerAdapter {\r\n        /**\r\n         * The configure function is used to configure the security of the application.\r\n         * The HttpSecurity object passed in as a parameter allows you to specify which URLs are secured and by what mechanism.\r\n         * In this case, weâre securing all URLs with HTTP Basic authentication.\r\n         *\r\n         * @param HttpSecurity http Configure the security for a specific http request\r\n         * @return A httpsecurity object\r\n         * @docauthor Trelent\r\n         */\r\n        @Override\r\n        protected void configure(HttpSecurity http) throws Exception {\r\n            super.configure(http);\r\n            http.antMatcher(\"/api/**\").authorizeRequests().anyRequest().authenticated();\r\n        }\r\n    }\r\n\r\n    @Configuration\r\n    public static class HtmlWebSecurityConfigurationAdapter extends AADWebSecurityConfigurerAdapter {\r\n\r\n        private final OAuth2UserService<OidcUserRequest, OidcUser> oidcUserService;\r\n\r\n        public HtmlWebSecurityConfigurationAdapter(OAuth2UserService<OidcUserRequest, OidcUser> oidcUserService) {\r\n            this.oidcUserService = oidcUserService;\r\n        }\r\n\r\n        /**\r\n         * The configure function is used to configure the security of the application.\r\n         * The function takes a parameter of type HttpSecurity, which is used to define\r\n         * what resources are public and what are secured. In this case, weâre saying that all resources should be secured by default (any request must be authenticated), but that any requests made internally by Spring Security should be allowed without authentication. We also specify that our login page can be accessed without authentication and configure it as an OpenID Connect login page using oauth2Login().userInfoEndpoint().oidcUserService(oidcUserService). This will cause Spring Security to\r\n         *\r\n         * @param HttpSecurity http Configure the security of web requests\r\n         * @return A httpsecurity object\r\n         * @docauthor Trelent\r\n         */\r\n        @Override\r\n        protected void configure(HttpSecurity http) throws Exception {\r\n            super.configure(http);\r\n\r\n            http\r\n                    // Not using Spring CSRF here to be able to use plain HTML for the login page\r\n                    .csrf().disable()\r\n\r\n                    // Allow all flow internal requests.\r\n                    .authorizeRequests().requestMatchers(SecurityUtils::isFrameworkInternalRequest).permitAll()\r\n\r\n                    // Restrict access to our application.\r\n                    .anyRequest().authenticated()\r\n\r\n                    // Configure the login page.\r\n                    .and().oauth2Login().userInfoEndpoint().oidcUserService(oidcUserService);\r\n        }\r\n\r\n        /**\r\n         * The configure function is used to configure the authentication manager builder.\r\n         * The authentication manager builder is used to create an AuthenticationManager.\r\n         * The AuthenticationManager is the interface that Spring Security uses for all of its security operations,\r\n         * including login and logout.\r\n         *\r\n         * @param WebSecurity web Configure the security of the web application\r\n         * @return An object of type websecurityconfigureradapter\r\n         * @docauthor Trelent\r\n         */\r\n        @Override\r\n        public void configure(WebSecurity web) throws Exception {\r\n            web.ignoring().antMatchers(\r\n                    // Vaadin Flow static resources\r\n                    \"/VAADIN/**\", \"/node_modules/**\",\r\n\r\n                    // the standard favicon URI\r\n                    \"/favicon.ico\",\r\n\r\n                    // the robots exclusion standard\r\n                    \"/robots.txt\",\r\n\r\n                    // web application manifest\r\n                    \"/manifest.webmanifest\", \"/sw.js\", \"/offline-page.html\",\r\n\r\n                    // icons and images\r\n                    \"/icons/**\", \"/images/**\", \"/tmp/**\",\r\n\r\n                    // logout\r\n                    \"/\" + PageConst.PAGE_LOGOUT,\r\n\r\n                    // (development mode) static resources\r\n                    \"/frontend/**\",\r\n\r\n                    // (development mode) webjars\r\n                    \"/webjars/**\",\r\n\r\n                    // spring boot Admin\r\n                    \"/actuator\",\r\n                    \"/actuator/health/**\",\r\n                    \"/actuator/logfile/**\",\r\n                    \"/actuator/metrics/**\",\r\n                    \"/actuator/info\",\r\n\r\n                    // (production mode) static resources\r\n                    \"/frontend-es5/**\", \"/frontend-es6/**\"\r\n\r\n\r\n                    /* FR 05012023\r\n                     * Vaadin 14 MVC frist die Swagger UI\r\n                     * Bekannter Patch erst ab Release 23 Hier kÃ¶nnen Seiten vom MVC ausgeschlossen werden\r\n                     * Tatu Lund | Release: 23.3.0 |  vaadin.excludeUrls=/swagger-ui/**\r\n                     * Quelle: https://stackoverflow.com/questions/71022726/vaadin-blocks-swagger-ui\r\n                     */\r\n\r\n                    // Swagger\r\n                    //, \"/swagger-ui/**\", \"/swagger-ui.html\"\r\n\r\n\r\n            );\r\n        }\r\n    }\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\security\\AADOWebAndResourceServerConfig.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\security\\ConfigureUIServiceInitListener.java =====\n```\npackage com.hom.ebmw.configuration.security;\r\n\r\nimport com.hom.ebmw.exceptions.AccessDeniedException;\r\nimport com.hom.ebmw.graph.service.MSgraphService;\r\nimport com.hom.ebmw.view.logout.LogoutView;\r\nimport com.vaadin.flow.component.UI;\r\nimport com.vaadin.flow.router.BeforeEnterEvent;\r\nimport com.vaadin.flow.server.ServiceInitEvent;\r\nimport com.vaadin.flow.server.VaadinServiceInitListener;\r\nimport com.vaadin.flow.spring.annotation.SpringComponent;\r\n\r\n/**\r\n * Adds before enter listener to check access to views.\r\n */\r\n@SuppressWarnings(\"serial\")\r\n@SpringComponent\r\npublic class ConfigureUIServiceInitListener implements VaadinServiceInitListener {\r\n\r\n    private final MSgraphService graphService;\r\n\r\n    /**\r\n     * The ConfigureUIServiceInitListener function is a listener that listens for the initialization of the ConfigureUIService.\r\n     * When it detects that the ConfigureUIService has been initialized, it calls on its configureUI function to set up all of\r\n     * the UI elements in our application. It also sets up listeners for when certain buttons are clicked and when certain text fields are changed.\r\n     *\r\n     * @param MSgraphService graphService Set the graphservice variable\r\n     * @return A new instance of the configureuiserviceinitlistener class\r\n     * @docauthor Trelent\r\n     */\r\n    public ConfigureUIServiceInitListener(MSgraphService graphService) {\r\n        this.graphService = graphService;\r\n    }\r\n\r\n    /**\r\n     * Init Page Load Listner\r\n     *\r\n     */\r\n    /**\r\n     * The serviceInit function is called when the application starts.\r\n     * It adds a listener to the UI that will be called before each navigation event.\r\n     * The listener calls the beforeEnter function, which checks if there is a user logged in and redirects accordingly.\r\n     *\r\n     * @param ServiceInitEvent event Add a uiinitlistener to the event source\r\n     * @return A uiinitlistener\r\n     * @docauthor Trelent\r\n     */\r\n    @Override\r\n    public void serviceInit(ServiceInitEvent event) {\r\n        event.getSource().addUIInitListener(uiEvent -> {\r\n            final UI ui = uiEvent.getUI();\r\n            ui.addBeforeEnterListener(this::beforeEnter);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Reroutes the user if she is not authorized to access the view.\r\n     *\r\n     * @param event before navigation event with event details\r\n     */\r\n    /**\r\n     * The beforeEnter function is called before the user enters a new view.\r\n     * It checks if the user has access to that view, and if not, it redirects them to an error page.\r\n     *\r\n     * @param BeforeEnterEvent event Get the navigation target\r\n     * @return A boolean\r\n     * @docauthor Trelent\r\n     */\r\n    private void beforeEnter(BeforeEnterEvent event) {\r\n        Class<?> clazz = event.getNavigationTarget();\r\n\r\n        final boolean accessGranted = SecurityUtils.isAccessGranted(clazz, graphService);\r\n        if (!accessGranted) {\r\n            if (clazz.equals(LogoutView.class)) {\r\n                event.rerouteTo(LogoutView.class);\r\n            } else {\r\n                event.rerouteToError(AccessDeniedException.class);\r\n            }\r\n        }\r\n    }\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\security\\ConfigureUIServiceInitListener.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\security\\CustomPermissionEvaluator.java =====\n```\npackage com.hom.ebmw.configuration.security;\r\n\r\nimport com.hom.ebmw.jpa.model.RolePermission;\r\nimport com.hom.ebmw.jpa.model.User;\r\nimport com.hom.ebmw.utilities.interfaces.HasPermission;\r\nimport lombok.extern.slf4j.Slf4j;\r\nimport org.springframework.security.access.PermissionEvaluator;\r\nimport org.springframework.security.core.Authentication;\r\nimport org.springframework.security.oauth2.client.authentication.OAuth2AuthenticationToken;\r\nimport org.springframework.security.oauth2.server.resource.authentication.BearerTokenAuthentication;\r\n\r\nimport java.io.Serializable;\r\nimport java.util.Objects;\r\nimport java.util.Optional;\r\n\r\n@Slf4j\r\npublic class CustomPermissionEvaluator implements PermissionEvaluator, HasPermission {\r\n\r\n    private final Services services;\r\n\r\n    public CustomPermissionEvaluator(Services services) {\r\n        this.services = services;\r\n    }\r\n\r\n    /**\r\n     * The hasPermission function is used to check if a user has permission to perform an action on a given object.\r\n     *\r\n     * @param Authentication authentication Get the user's roles\r\n     * @param Object         targetDomainObject Determine the type of object being passed to the method\r\n     * @param Object         permission Determine what permission the user has\r\n     * @return A boolean value\r\n     * @docauthor Trelent\r\n     */\r\n    @Override\r\n    public boolean hasPermission(Authentication authentication, Object targetDomainObject, Object permission) {\r\n        if ((Objects.isNull(authentication)) || (Objects.isNull(targetDomainObject))\r\n                || !(permission instanceof String)) {\r\n            return false;\r\n        }\r\n\r\n        String targetType = targetDomainObject.getClass().getSimpleName().toUpperCase();\r\n\r\n        return hasPrivilege(authentication, targetType, permission.toString().toUpperCase());\r\n    }\r\n\r\n    /**\r\n     * The hasPermission function is used to determine if the user has a specific permission for an object.\r\n     *\r\n     * @param Authentication authentication Get the user's roles\r\n     *                       private boolean hasprivilege(authentication authentication, string targettype, string permission) {\r\n     *                       <p>\r\n     *                       for (grantedauthority grantedauth : authentication\r\n     * @param Serializable   targetId Identify the target object instance\r\n     * @param String         targetType Determine the type of object that is being accessed\r\n     * @param Object         permission Check if the permission is a string\r\n     * @return True if the user has the privilege to perform an action on a target\r\n     * @docauthor Trelent\r\n     */\r\n    @Override\r\n    public boolean hasPermission(Authentication authentication, Serializable targetId, String targetType,\r\n                                 Object permission) {\r\n\r\n        if ((Objects.isNull(authentication)) || (Objects.isNull(targetType)) || !(permission instanceof String)) {\r\n            return false;\r\n        }\r\n\r\n        return hasPrivilege(authentication, targetType, permission.toString());\r\n    }\r\n\r\n    /**\r\n     * The hasPrivilege function is used to determine if a user has the correct permissions for a given target type.\r\n     * The function takes in an authentication object, which contains information about the current user, and a targetType string.\r\n     * The function then uses this information to find out what role the current user has and returns true or false depending on whether or not they have permission for that action.\r\n     *\r\n     * @param Authentication authentication Get the userid from the token\r\n     *                       private rolepermission getpermission(user user, services services, string targettype) {\r\n     *                       role role = services\r\n     * @param String         targetType Determine the type of object that is being accessed\r\n     * @param String         permission Determine what type of permission to check for\r\n     * @return The value of the hasprivilege function in rolepermission\r\n     * @docauthor Trelent\r\n     */\r\n    private boolean hasPrivilege(Authentication authentication, String targetType, String permission) {\r\n        String userId = null;\r\n        // \"oid\" = USER_ID\r\n        if (authentication instanceof BearerTokenAuthentication) {\r\n            BearerTokenAuthentication auth = (BearerTokenAuthentication) authentication;\r\n            userId = auth.getTokenAttributes().get(\"oid\").toString();\r\n        } else if (authentication instanceof OAuth2AuthenticationToken) {\r\n            OAuth2AuthenticationToken auth = (OAuth2AuthenticationToken) authentication;\r\n            try {\r\n                userId = auth.getPrincipal().getAttribute(\"oid\").toString();\r\n            } catch (NullPointerException e) {\r\n                log.error(\"Could not Find valid User\");\r\n            }\r\n\r\n        }\r\n        Optional<User> optUser = services.getUserServices().findByUserId(userId);\r\n\r\n        if (!optUser.isPresent()) {\r\n            return false;\r\n        } else {\r\n            RolePermission rolePerm = getPermission(optUser.get(), services, targetType);\r\n            switch (permission.toLowerCase()) {\r\n                case \"read\":\r\n                    return rolePerm.isRead();\r\n                case \"write\":\r\n                    return rolePerm.isWrite();\r\n                case \"delete\":\r\n                    return rolePerm.isDelete();\r\n                case \"edit\":\r\n                    return rolePerm.isEdit();\r\n                default:\r\n                    return false;\r\n            }\r\n        }\r\n    }\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\security\\CustomPermissionEvaluator.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\security\\CustomRequestCache.java =====\n```\npackage com.hom.ebmw.configuration.security;\r\n\r\nimport org.springframework.security.web.savedrequest.HttpSessionRequestCache;\r\n\r\nimport javax.servlet.http.HttpServletRequest;\r\nimport javax.servlet.http.HttpServletResponse;\r\n\r\n/**\r\n * HttpSessionRequestCache that avoids saving internal framework requests.\r\n */\r\nclass CustomRequestCache extends HttpSessionRequestCache {\r\n    /**\r\n     * {@inheritDoc}\r\n     * <p>\r\n     * If the method is considered an internal request from the framework, we skip\r\n     * saving it.\r\n     *\r\n     * @see SecurityUtils#isFrameworkInternalRequest(HttpServletRequest)\r\n     */\r\n    @Override\r\n    public void saveRequest(HttpServletRequest request, HttpServletResponse response) {\r\n        if (!SecurityUtils.isFrameworkInternalRequest(request)) {\r\n            super.saveRequest(request, response);\r\n        }\r\n    }\r\n\r\n}\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\security\\CustomRequestCache.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\security\\EnCryptConfiguration.java =====\n```\npackage com.hom.ebmw.configuration.security;\r\n\r\nimport org.jasypt.encryption.StringEncryptor;\r\nimport org.jasypt.encryption.pbe.PooledPBEStringEncryptor;\r\nimport org.jasypt.encryption.pbe.config.SimpleStringPBEConfig;\r\nimport org.springframework.context.annotation.Bean;\r\nimport org.springframework.context.annotation.Configuration;\r\n\r\n@Configuration\r\npublic class EnCryptConfiguration {\r\n\r\n    /**\r\n     * The stringEncryptor function is used to encrypt and decrypt strings.\r\n     *\r\n     * @return A stringencryptor object\r\n     * @docauthor Trelent\r\n     */\r\n    @Bean(\"jasyptStringEncryptor\")\r\n    protected StringEncryptor stringEncryptor() {\r\n        PooledPBEStringEncryptor encryptor = new PooledPBEStringEncryptor();\r\n        SimpleStringPBEConfig config = new SimpleStringPBEConfig();\r\n        config.setPassword(\"FxaEQFT5240l9k0fxLV4\");\r\n        config.setAlgorithm(\"PBEWITHHMACSHA512ANDAES_256\");\r\n        config.setKeyObtentionIterations(\"1000\");\r\n        config.setPoolSize(\"1\");\r\n        config.setProviderName(\"SunJCE\");\r\n        config.setSaltGeneratorClassName(\"org.jasypt.salt.RandomSaltGenerator\");\r\n        config.setIvGeneratorClassName(\"org.jasypt.iv.RandomIvGenerator\");\r\n        config.setStringOutputType(\"base64\");\r\n        encryptor.setConfig(config);\r\n        return encryptor;\r\n    }\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\security\\EnCryptConfiguration.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\security\\GraphAuthenticationProvider.java =====\n```\npackage com.hom.ebmw.configuration.security;\r\n\r\nimport com.hom.ebmw.view.errors.AccessDeniedView;\r\nimport com.microsoft.graph.authentication.BaseAuthenticationProvider;\r\nimport com.vaadin.flow.component.UI;\r\nimport org.springframework.security.oauth2.client.OAuth2AuthorizedClient;\r\n\r\nimport java.net.URL;\r\nimport java.time.Instant;\r\nimport java.util.concurrent.CompletableFuture;\r\n\r\n\r\npublic class GraphAuthenticationProvider extends BaseAuthenticationProvider {\r\n    private final OAuth2AuthorizedClient graphAuthorizedClient;\r\n\r\n    /**\r\n     * Set up the GraphAuthenticationProvider. Allows accessToken to be\r\n     * used by GraphServiceClient through the interface IAuthenticationProvider\r\n     *\r\n     * @param graphAuthorizedClient OAuth2AuthorizedClient created by AAD Boot starter. Used to surface the access token.\r\n     */\r\n    public GraphAuthenticationProvider(OAuth2AuthorizedClient graphAuthorizedClient) {\r\n        if (graphAuthorizedClient == null) {\r\n            UI.getCurrent().navigate(AccessDeniedView.class);\r\n        }\r\n\r\n        this.graphAuthorizedClient = graphAuthorizedClient;\r\n    }\r\n\r\n    /**\r\n     * This implementation of the IAuthenticationProvider helps injects the Graph access\r\n     * token into the headers of the request that GraphServiceClient makes.\r\n     *\r\n     * @param requestUrl the outgoing request URL\r\n     * @return a future with the token\r\n     */\r\n    @Override\r\n    public CompletableFuture<String> getAuthorizationTokenAsync(final URL requestUrl) {\r\n\r\n        return CompletableFuture.completedFuture(getTokenValue());\r\n    }\r\n\r\n\r\n    /**\r\n     * The getTokenValue function returns the token value of either the access or refresh token, depending on which one is currently valid.\r\n     *\r\n     * @return The token value of the access token or refresh token depending on which one is valid\r\n     * @docauthor Trelent\r\n     */\r\n    private String getTokenValue() {\r\n        graphAuthorizedClient.getAccessToken().getExpiresAt();\r\n        Instant current = Instant.now();\r\n        if (current.isAfter(graphAuthorizedClient.getAccessToken().getExpiresAt())) {\r\n            return graphAuthorizedClient.getRefreshToken().getTokenValue();\r\n        } else {\r\n            return graphAuthorizedClient.getAccessToken().getTokenValue();\r\n        }\r\n    }\r\n\r\n}\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\security\\GraphAuthenticationProvider.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\security\\SecurityUtils.java =====\n```\npackage com.hom.ebmw.configuration.security;\r\n\r\nimport com.hom.ebmw.graph.service.MSgraphService;\r\nimport com.hom.ebmw.view.errors.AccessDeniedView;\r\nimport com.vaadin.flow.server.HandlerHelper.RequestType;\r\nimport com.vaadin.flow.shared.ApplicationConstants;\r\nimport lombok.extern.slf4j.Slf4j;\r\nimport org.springframework.core.annotation.AnnotationUtils;\r\nimport org.springframework.security.access.annotation.Secured;\r\nimport org.springframework.security.authentication.AnonymousAuthenticationToken;\r\nimport org.springframework.security.core.Authentication;\r\nimport org.springframework.security.core.GrantedAuthority;\r\nimport org.springframework.security.core.context.SecurityContext;\r\nimport org.springframework.security.core.context.SecurityContextHolder;\r\nimport org.springframework.security.oauth2.core.user.OAuth2User;\r\n\r\nimport javax.servlet.http.HttpServletRequest;\r\nimport java.util.Arrays;\r\nimport java.util.List;\r\nimport java.util.Objects;\r\nimport java.util.stream.Stream;\r\n\r\n/**\r\n * SecurityUtils takes care of all such static operations that have to do with\r\n * security and querying rights from different beans of the UI.\r\n */\r\n@Slf4j\r\npublic final class SecurityUtils {\r\n\r\n    /**\r\n     * The SecurityUtils function is a static method that returns the current user's username.\r\n     *\r\n     * @return An instance of the securityutils class\r\n     * @docauthor Trelent\r\n     */\r\n    private SecurityUtils() {\r\n        log.info(\"private Constructor\");\r\n    }\r\n\r\n    /**\r\n     * The getAttributeValue function is used to retrieve the value of a specific attribute from the OAuth2User object.\r\n     * The SecurityContextHolder class provides access to security information related to the current application user.\r\n     * The getAuthentication method returns an Authentication object that represents a fully authenticated user, and\r\n     * contains details about that user's identity and authorities (roles).\r\n     *\r\n     * @param String attributeKey Get the value of a specific attribute from the user's profile\r\n     * @return A string, but we need an integer\r\n     * @docauthor Trelent\r\n     */\r\n    private static String getAttributeValue(String attributeKey) {\r\n        if (!Objects.isNull(SecurityContextHolder.getContext())) {\r\n            try {\r\n                SecurityContext context = SecurityContextHolder.getContext();\r\n                Object principal = context.getAuthentication().getPrincipal();\r\n                if (principal instanceof OAuth2User) {\r\n                    OAuth2User oAuth2User = (OAuth2User) principal;\r\n\r\n                    return oAuth2User.getAttribute(attributeKey);\r\n                }\r\n            } catch (Exception e) {\r\n                log.warn(\"Session not Valid\");\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Gets the user name of the currently signed in user.\r\n     *\r\n     * @return the user name of the current user or <code>null</code> if the user\r\n     * has not signed in\r\n     */\r\n    // Anonymous or no authentication.\r\n    public static String getUsername() {\r\n        String givenName = getGivenName();\r\n        String surname = getSurName();\r\n        if (Objects.nonNull(givenName) && Objects.nonNull(surname)) {\r\n            return givenName + \" \" + surname;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    // Anonymous or no authentication.\r\n\r\n    /**\r\n     * The getGivenName function returns the value of the given_name attribute.\r\n     *\r\n     * @return The value of the given_name attribute\r\n     * @docauthor Trelent\r\n     */\r\n    public static String getGivenName() {\r\n        return getAttributeValue(\"given_name\");\r\n    }\r\n\r\n    // Anonymous or no authentication.\r\n\r\n    /**\r\n     * The getSurName function returns the value of the family_name attribute.\r\n     *\r\n     * @return The value of the family_name attribute\r\n     * @docauthor Trelent\r\n     */\r\n    public static String getSurName() {\r\n        return getAttributeValue(\"family_name\");\r\n    }\r\n\r\n    // Anonymous or no authentication.\r\n\r\n    /**\r\n     * The getUserID function returns the user's ID.\r\n     *\r\n     * @return The value of the oid attribute\r\n     * @docauthor Trelent\r\n     */\r\n    public static String getUserID() {\r\n        return getAttributeValue(\"oid\");\r\n    }\r\n\r\n    /**\r\n     * Checks if access is granted for the current user for the given secured view,\r\n     * defined by the view class.\r\n     *\r\n     * @param securedClass View class\r\n     * @return true if access is granted, false otherwise.\r\n     */\r\n    public static boolean isAccessGranted(Class<?> securedClass, MSgraphService service) {\r\n\r\n        // Always allow access to public views\r\n        if (AccessDeniedView.class.equals(securedClass)) {\r\n            return true;\r\n        }\r\n\r\n        // All other views require authentication\r\n        if (SecurityUtils.isAnonymousUser()) {\r\n            return false;\r\n        }\r\n\r\n        // Allow if no roles are required.\r\n        boolean isSecured = service.hasGroup();\r\n        if (isSecured) {\r\n            // Has Secure\r\n            return true;\r\n        }\r\n        // Allow if SecureClass required\r\n        Secured secured = AnnotationUtils.findAnnotation(securedClass, Secured.class);\r\n        if (Objects.nonNull(secured)) {\r\n            List<String> allowedRoles = Arrays.asList(secured.value());\r\n            Authentication authentication = SecurityContextHolder.getContext().getAuthentication();\r\n\r\n            return authentication.getAuthorities().stream().map(GrantedAuthority::getAuthority)\r\n                    .anyMatch(allowedRoles::contains);\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Checks if the user is logged in.\r\n     *\r\n     * @return true if the user is logged in. False otherwise.\r\n     */\r\n    public static boolean isAnonymousUser() {\r\n        return isAnonymousUser(SecurityContextHolder.getContext().getAuthentication());\r\n    }\r\n\r\n    /**\r\n     * The isAnonymousUser function checks if the user is anonymous.\r\n     *\r\n     * @param Authentication authentication Check if the user is logged in or not\r\n     * @return True if the authentication object is null or an instance of anonymousauthenticationtoken\r\n     * @docauthor Trelent\r\n     */\r\n    private static boolean isAnonymousUser(Authentication authentication) {\r\n        return Objects.isNull(authentication) || (authentication instanceof AnonymousAuthenticationToken);\r\n    }\r\n\r\n    /**\r\n     * Tests if the request is an internal framework request. The test consists of\r\n     * checking if the request parameter is present and if its value is consistent\r\n     * with any of the request types know.\r\n     *\r\n     * @param request {@link HttpServletRequest}\r\n     * @return true if is an internal framework request. False otherwise.\r\n     */\r\n    static boolean isFrameworkInternalRequest(HttpServletRequest request) {\r\n        final String parameterValue = request.getParameter(ApplicationConstants.REQUEST_TYPE_PARAMETER);\r\n        return parameterValue != null\r\n                && Stream.of(RequestType.values()).anyMatch(r -> r.getIdentifier().equals(parameterValue));\r\n    }\r\n\r\n}\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\security\\SecurityUtils.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\security\\ServerConfig.java =====\n```\npackage com.hom.ebmw.configuration.security;\r\n\r\nimport com.fasterxml.jackson.databind.Module;\r\nimport com.fasterxml.jackson.datatype.hibernate5.Hibernate5Module;\r\nimport org.springframework.context.annotation.Bean;\r\nimport org.springframework.context.annotation.Configuration;\r\nimport org.springframework.context.support.PropertySourcesPlaceholderConfigurer;\r\nimport org.springframework.core.io.ClassPathResource;\r\n\r\n\r\n@Configuration\r\npublic class ServerConfig {\r\n\r\n\r\n    /**\r\n     * The placeholderConfigurer function is a Spring Bean that loads the git.properties file from the classpath and makes its properties available to other beans in this configuration.\r\n     * <p>\r\n     * The\r\n     *\r\n     * @return A propertysourcesplaceholderconfigurer object\r\n     * @docauthor Trelent\r\n     */\r\n    @Bean\r\n    protected static PropertySourcesPlaceholderConfigurer placeholderConfigurer() {\r\n        PropertySourcesPlaceholderConfigurer propsConfig\r\n                = new PropertySourcesPlaceholderConfigurer();\r\n        propsConfig.setLocation(new ClassPathResource(\"git.properties\"));\r\n        propsConfig.setIgnoreResourceNotFound(true);\r\n        propsConfig.setIgnoreUnresolvablePlaceholders(true);\r\n        return propsConfig;\r\n    }\r\n\r\n    /**\r\n     * The module function is used to register the Hibernate5Module with Jackson.\r\n     * This module will take care of serializing/deserializing Java 8 date/time classes,\r\n     * including JSR310 and Joda-Time. It also contains support for serializing\r\n     * &quot;enhanced&quot; enums (see http://wiki.fasterxml.com/JacksonFeatureEnumSerialization).\r\n     *\r\n     * @return A jackson module that is registered with the object mapper\r\n     * @docauthor Trelent\r\n     */\r\n    @Bean\r\n    protected Module module() {\r\n        return new Hibernate5Module();\r\n    }\r\n\r\n}\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\security\\ServerConfig.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\security\\Services.java =====\n```\npackage com.hom.ebmw.configuration.security;\r\n\r\nimport com.hom.ebmw.configuration.ApplicationProperty;\r\nimport com.hom.ebmw.graph.service.MSgraphService;\r\nimport com.hom.ebmw.ipim.service.EnumerationService;\r\nimport com.hom.ebmw.ipim.service.IPIMService;\r\nimport com.hom.ebmw.jpa.dao.*;\r\nimport com.hom.ebmw.jpa.dao.impl.*;\r\nimport com.hom.ebmw.utilities.FileTranslatorRepository;\r\nimport com.hom.ebmw.utilities.TranslationProvider;\r\nimport com.hom.ebmw.utilities.enums.SessionParams;\r\nimport com.vaadin.flow.spring.annotation.SpringComponent;\r\nimport lombok.Data;\r\nimport org.springframework.cloud.context.restart.RestartEndpoint;\r\nimport org.springframework.context.ApplicationContext;\r\nimport org.springframework.context.annotation.Lazy;\r\nimport org.springframework.jdbc.core.JdbcTemplate;\r\nimport org.springframework.scheduling.concurrent.ThreadPoolTaskScheduler;\r\n\r\n@SpringComponent\r\npublic @Data class Services {\r\n\r\n    private final ApplicationContext context;\r\n\r\n    @Lazy\r\n    private final MSgraphService graphService;\r\n\r\n    private final ApplicationProperty property;\r\n\r\n    @Lazy\r\n    private final JdbcTemplate template;\r\n\r\n    @Lazy\r\n    private final TranslationProvider translationService;\r\n\r\n    // JPAServices\r\n    @Lazy\r\n    private final RolePermissionDAO rolePermissionService;\r\n\r\n    @Lazy\r\n    private final RoleDAO roleService;\r\n\r\n    @Lazy\r\n    private final PermissionDAO permissionService;\r\n\r\n    @Lazy\r\n    private final LocalCustomerDAO localCustomerService;\r\n\r\n    @Lazy\r\n    private final LocalCustomerCustomRepository localCustomerCustomService;\r\n\r\n    @Lazy\r\n    private final SettingDAO settingServices;\r\n\r\n    @Lazy\r\n    private final SettingParameterDAO settingParameterService;\r\n\r\n    @Lazy\r\n    private final SettingCustomRepository settingCustomServices;\r\n\r\n    @Lazy\r\n    private final ProjectDAO projectServices;\r\n\r\n    @Lazy\r\n    private final ProjectRoleDAO projectRoleServices;\r\n\r\n    @Lazy\r\n    private final UserDAO userServices;\r\n\r\n    @Lazy\r\n    private final AstFileDAO astFileService;\r\n\r\n    @Lazy\r\n    private final DataFileDAO dataFileService;\r\n\r\n    @Lazy\r\n    private final ZinfoFileDAO zinfoFileService;\r\n\r\n    @Lazy\r\n    private final CustomerDAO customerService;\r\n\r\n    @Lazy\r\n    private final StorageDAO storageService;\r\n\r\n    @Lazy\r\n    private final ParameterDAO parameterService;\r\n\r\n    @Lazy\r\n    private final UserParameterDAO userParameterService;\r\n\r\n    @Lazy\r\n    private final CustomerFilterDAO customerFilterService;\r\n\r\n    @Lazy\r\n    private final AssortmentFilterDAO assortmentFilterService;\r\n\r\n    @Lazy\r\n    private final AssortmentDataFileDAO assortmentDataFileService;\r\n\r\n    @Lazy\r\n    private final AssortmentCustomRepository assortmentCustomService;\r\n\r\n    @Lazy\r\n    private final AssortmentDAO assortmentService;\r\n\r\n    @Lazy\r\n    private final FilterDAO filterService;\r\n\r\n    @Lazy\r\n    private final FilterBaseDAO filterBaseService;\r\n\r\n    @Lazy\r\n    private final FilterBaseCustomRepository filterBaseCustomService;\r\n\r\n    @Lazy\r\n    private final FilterBaseBlankGetRepository filterBaseBlankService;\r\n\r\n    @Lazy\r\n    private final FilterBaseGetRepository filterBaseDBService;\r\n\r\n    @Lazy\r\n    private final FilterBaseExportRepository filterBaseExport;\r\n\r\n\r\n    @Lazy\r\n    private final FilterBaseProofRepository filterBaseProofService;\r\n\r\n    @Lazy\r\n    private final ArticleBaseRepository articleBaseService;\r\n\r\n    @Lazy\r\n    private final ArticleBaseGetRepository articleBaseGetService;\r\n\r\n    @Lazy\r\n    private final ArticleBaseQueueDAO articleBaseQueueService;\r\n\r\n    @Lazy\r\n    private final RoleUserDAO roleUserService;\r\n\r\n    @Lazy\r\n    private final FilterBaseUpdateRepository filterBaseUpdateService;\r\n\r\n    @Lazy\r\n    private final ZinfoDAO zinfoService;\r\n\r\n    @Lazy\r\n    private final ZinfoCustomRepository zinfoCustomerSerivce;\r\n\r\n    @Lazy\r\n    private final FileTranslatorRepository fileTranslationRepository;\r\n\r\n    // iPIMServices\r\n    @Lazy\r\n    private final EnumerationService enumerationService;\r\n\r\n    @Lazy\r\n    private final IPIMService iPIMService;\r\n\r\n    @Lazy\r\n    private final CustomRepository customRepository;\r\n\r\n    @Lazy\r\n    private final TemplateDataDAO templateDataRepository;\r\n\r\n    @Lazy\r\n    private final ArticleStatisticDAO articleStatisticRepository;\r\n\r\n    @Lazy\r\n    private final ArticleStatisticCustomRepository articleStatisticCustomRepository;\r\n\r\n    private final ThreadPoolTaskScheduler taskscheduler;\r\n\r\n    private final DelayParameterRepository delayParameterRepository;\r\n\r\n    private final RestartEndpoint restartEndpoint;\r\n\r\n    public Services(SettingDAO settingServices, ApplicationContext context, MSgraphService graphService, ApplicationProperty property, TemplateDataDAO templateDataRepository, FilterBaseBlankGetRepository filterBaseBlankService, JdbcTemplate template, CustomRepository customRepository, CustomerFilterDAO customerFilterService, ArticleStatisticDAO articleStatisticRepository, AstFileDAO astFileService, AssortmentDAO assortmentService, FilterBaseExportRepository filterBaseExport, ZinfoFileDAO zinfoFileService, TranslationProvider translationService, RolePermissionDAO rolePermissionService, EnumerationService enumerationService, ThreadPoolTaskScheduler taskscheduler, AssortmentFilterDAO assortmentFilterService, FilterDAO filterService, FilterBaseGetRepository filterBaseDBService, ArticleBaseGetRepository articleBaseGetService, ZinfoDAO zinfoService, FilterBaseDAO filterBaseService, ProjectDAO projectServices, ZinfoCustomRepository zinfoCustomerSerivce, ParameterDAO parameterService, RoleDAO roleService, PermissionDAO permissionService, SettingParameterDAO settingParameterService, FilterBaseUpdateRepository filterBaseUpdateService, IPIMService iPIMService, RestartEndpoint restartEndpoint, ArticleBaseRepository articleBaseService, ArticleBaseQueueDAO articleBaseQueueService, RoleUserDAO roleUserService, ArticleStatisticCustomRepository articleStatisticCustomRepository, LocalCustomerDAO localCustomerService, ProjectRoleDAO projectRoleServices, UserDAO userServices, LocalCustomerCustomRepository localCustomerCustomService, FileTranslatorRepository fileTranslationRepository, FilterBaseCustomRepository filterBaseCustomService, FilterBaseProofRepository filterBaseProofService, UserParameterDAO userParameterService, AssortmentCustomRepository assortmentCustomService, CustomerDAO customerService, DelayParameterRepository delayParameterRepository, AssortmentDataFileDAO assortmentDataFileService, StorageDAO storageService, SettingCustomRepository settingCustomServices, DataFileDAO dataFileService) {\r\n        this.settingServices = settingServices;\r\n        this.context = context;\r\n        this.graphService = graphService;\r\n        this.property = property;\r\n        this.templateDataRepository = templateDataRepository;\r\n        this.filterBaseBlankService = filterBaseBlankService;\r\n        this.template = template;\r\n        this.customRepository = customRepository;\r\n        this.customerFilterService = customerFilterService;\r\n        this.articleStatisticRepository = articleStatisticRepository;\r\n        this.astFileService = astFileService;\r\n        this.assortmentService = assortmentService;\r\n        this.filterBaseExport = filterBaseExport;\r\n        this.zinfoFileService = zinfoFileService;\r\n        this.translationService = translationService;\r\n        this.rolePermissionService = rolePermissionService;\r\n        this.enumerationService = enumerationService;\r\n        this.taskscheduler = taskscheduler;\r\n        this.assortmentFilterService = assortmentFilterService;\r\n        this.filterService = filterService;\r\n        this.filterBaseDBService = filterBaseDBService;\r\n        this.articleBaseGetService = articleBaseGetService;\r\n        this.zinfoService = zinfoService;\r\n        this.filterBaseService = filterBaseService;\r\n        this.projectServices = projectServices;\r\n        this.zinfoCustomerSerivce = zinfoCustomerSerivce;\r\n        this.parameterService = parameterService;\r\n        this.roleService = roleService;\r\n        this.permissionService = permissionService;\r\n        this.settingParameterService = settingParameterService;\r\n        this.filterBaseUpdateService = filterBaseUpdateService;\r\n        this.iPIMService = iPIMService;\r\n        this.restartEndpoint = restartEndpoint;\r\n        this.articleBaseService = articleBaseService;\r\n        this.articleBaseQueueService = articleBaseQueueService;\r\n        this.roleUserService = roleUserService;\r\n        this.articleStatisticCustomRepository = articleStatisticCustomRepository;\r\n        this.localCustomerService = localCustomerService;\r\n        this.projectRoleServices = projectRoleServices;\r\n        this.userServices = userServices;\r\n        this.localCustomerCustomService = localCustomerCustomService;\r\n        this.fileTranslationRepository = fileTranslationRepository;\r\n        this.filterBaseCustomService = filterBaseCustomService;\r\n        this.filterBaseProofService = filterBaseProofService;\r\n        this.userParameterService = userParameterService;\r\n        this.assortmentCustomService = assortmentCustomService;\r\n        this.customerService = customerService;\r\n        this.delayParameterRepository = delayParameterRepository;\r\n        this.assortmentDataFileService = assortmentDataFileService;\r\n        this.storageService = storageService;\r\n        this.settingCustomServices = settingCustomServices;\r\n        this.dataFileService = dataFileService;\r\n    }\r\n\r\n    /**\r\n     * The close function clears the session of all parameters that are set by the login function.\r\n     * This is done to ensure that no information from a previous user's session is carried over into\r\n     * another user's session. The close function also ensures that when a new user logs in, they will not be able to see any information about the previous users' sessions.\r\n     *\r\n     * @return The following:\r\n     * @docauthor Trelent\r\n     */\r\n    public void close() {\r\n        SessionParams[] params = {SessionParams.ACTIVE_ROLE,\r\n                SessionParams.ACTIVE_PROJECT, SessionParams.ACTIVE_PROJECT_ROLE,\r\n                SessionParams.ACTIVE_CUSTOMER, SessionParams.AUTHORIZATION_REQUEST,\r\n                SessionParams.SPRING_SECURITY_CONTEXT, SessionParams.AUTHORIZED_CLIENTS};\r\n\r\n        SessionUtils session = new SessionUtils(userServices);\r\n\r\n        for (SessionParams param : params) {\r\n            session.clear(param);\r\n        }\r\n\r\n    }\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\security\\Services.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\security\\SessionUtils.java =====\n```\npackage com.hom.ebmw.configuration.security;\r\n\r\nimport com.hom.ebmw.jpa.dao.UserDAO;\r\nimport com.hom.ebmw.jpa.model.User;\r\nimport com.hom.ebmw.pojo.Context;\r\nimport com.hom.ebmw.utilities.enums.Params;\r\nimport com.hom.ebmw.utilities.enums.SessionParams;\r\nimport com.vaadin.flow.server.VaadinService;\r\nimport com.vaadin.flow.server.VaadinServletRequest;\r\nimport com.vaadin.flow.server.VaadinSession;\r\nimport com.vaadin.flow.server.WrappedSession;\r\nimport lombok.extern.slf4j.Slf4j;\r\nimport org.springframework.security.core.context.SecurityContextImpl;\r\nimport org.springframework.security.oauth2.client.authentication.OAuth2AuthenticationToken;\r\nimport org.springframework.security.oauth2.core.user.OAuth2User;\r\nimport org.springframework.security.oauth2.server.resource.authentication.BearerTokenAuthentication;\r\n\r\nimport java.net.URI;\r\nimport java.net.URISyntaxException;\r\nimport java.util.Locale;\r\nimport java.util.Objects;\r\nimport java.util.Optional;\r\n\r\n@Slf4j\r\npublic class SessionUtils {\r\n\r\n    private final UserDAO userService;\r\n    private final VaadinSession vaaadinSession;\r\n\r\n    /**\r\n     * The SessionUtils function is used to get the current user's session.\r\n     *\r\n     * @param UserDAO userService Get the user from the database\r\n     * @return The current vaadinsession\r\n     * @docauthor Trelent\r\n     */\r\n    public SessionUtils(UserDAO userService) {\r\n        this.userService = userService;\r\n        this.vaaadinSession = VaadinSession.getCurrent();\r\n    }\r\n\r\n    /**\r\n     * The getHttpSession function returns the current VaadinSession.\r\n     *\r\n     * @return A wrappedsession object\r\n     * @docauthor Trelent\r\n     */\r\n    public WrappedSession getHttpSession() {\r\n        return vaaadinSession.getSession();\r\n    }\r\n\r\n    /**\r\n     * The getLocale function returns the locale of the current user.\r\n     * If no user is logged in, it will return Locale.GERMANY as default value.\r\n     *\r\n     * @param Context ctx Get the current user from the session\r\n     * @return The locale of the current user\r\n     * @docauthor Trelent\r\n     */\r\n    public Locale getLocale(Context ctx) {\r\n        Locale result = Locale.GERMANY;\r\n\r\n        try {\r\n            User user = ctx.getSession().getCurrentUser(ctx);\r\n            result = Locale.forLanguageTag(user.getLocale());\r\n            if (Objects.isNull(result)) {\r\n                result = Locale.GERMANY;\r\n            }\r\n        } catch (Exception e) {\r\n            result = Locale.GERMANY;\r\n        }\r\n        return result;\r\n    }\r\n\r\n\r\n    /**\r\n     * The setLocale function sets the locale of the user.\r\n     *\r\n     * @param Context ctx Get the current user session\r\n     * @param Locale  locale Set the locale of the user\r\n     * @return Void\r\n     * @docauthor Trelent\r\n     */\r\n    public void setLocale(Context ctx, Locale locale) {\r\n\r\n        User user = ctx.getSession().getCurrentUser(ctx);\r\n        if (user.getGivenName().isEmpty()) {\r\n            user.setGivenName(SecurityUtils.getGivenName());\r\n            user.setSurName(SecurityUtils.getSurName());\r\n        }\r\n        ctx.getUserSession().put(Params.ACTIVE_LOCALE, locale);\r\n        user.setLocale(locale.toLanguageTag());\r\n        userService.save(user);\r\n    }\r\n\r\n    /**\r\n     * The getCurrentUser function is used to retrieve the current user from the database.\r\n     *\r\n     * @param Context ctx Get the session object\r\n     * @return A user object\r\n     * @docauthor Trelent\r\n     */\r\n    public User getCurrentUser(Context ctx) {\r\n        User user = null;\r\n        Optional<User> optUser = userService.findByUserId(getCurrentUserID(ctx));\r\n        if (optUser.isPresent()) {\r\n            user = optUser.get();\r\n        }\r\n        return user;\r\n    }\r\n\r\n    /**\r\n     * The getCurrentURI function returns the current URI of the page.\r\n     *\r\n     * @return The uri of the current page\r\n     * @docauthor Trelent\r\n     */\r\n    public URI getCurrentURI() throws URISyntaxException {\r\n        VaadinServletRequest req = (VaadinServletRequest) VaadinService.getCurrentRequest();\r\n        StringBuffer uriString = req.getRequestURL();\r\n        return new URI(uriString.toString());\r\n    }\r\n\r\n    /**\r\n     * The getCurrentLocale function returns the current locale of the user.\r\n     * If no user is logged in, it will return Locale.GERMANY as default value.\r\n     *\r\n     * @param Context ctx Get the current user\r\n     * @return The locale of the current user\r\n     * @docauthor Trelent\r\n     */\r\n    public Locale getCurrentLocale(Context ctx) {\r\n        Locale current = Locale.GERMANY;\r\n        try {\r\n            User user = getCurrentUser(ctx);\r\n            if (Objects.nonNull(user)) {\r\n                if (user.getLocale().isEmpty()) {\r\n                    user.setLocale(current.toLanguageTag());\r\n                } else {\r\n                    current = Locale.forLanguageTag(user.getLocale());\r\n                }\r\n            }\r\n        } catch (Exception e) {\r\n            log.error(\"could not Find Current UserLocale\");\r\n        }\r\n        return current;\r\n    }\r\n\r\n    /**\r\n     * The getCurrentUserID function is used to get the user ID of the current user.\r\n     *\r\n     * @param Context ctx Get the current user's id\r\n     * @return The user id of the current user\r\n     * @docauthor Trelent\r\n     */\r\n    public String getCurrentUserID(Context ctx) {\r\n        String userId = \"\";\r\n\r\n        Object object = ctx.getHttpAttribute(SessionParams.SPRING_SECURITY_CONTEXT);\r\n        if (object instanceof SecurityContextImpl) {\r\n            SecurityContextImpl context = (SecurityContextImpl) object;\r\n            if (context.getAuthentication() instanceof OAuth2AuthenticationToken) {\r\n                OAuth2AuthenticationToken auth = (OAuth2AuthenticationToken) context.getAuthentication();\r\n                OAuth2User prince = auth.getPrincipal();\r\n                userId = prince.getAttributes().get(\"oid\").toString();\r\n            } else if (context.getAuthentication() instanceof BearerTokenAuthentication) {\r\n                BearerTokenAuthentication auth = (BearerTokenAuthentication) context.getAuthentication();\r\n                userId = auth.getTokenAttributes().get(\"oid\").toString();\r\n            }\r\n\r\n        }\r\n\r\n        return userId;\r\n    }\r\n\r\n    /**\r\n     * The put function is used to add a key-value pair to the session.\r\n     *\r\n     * @param SessionParams key Get the name of the key\r\n     * @param Object        value Set the value of a key\r\n     * @return The previous value associated with key, or null if there was no mapping for key\r\n     * @docauthor Trelent\r\n     */\r\n    public void put(SessionParams key, Object value) {\r\n        put(key.getName(), value);\r\n    }\r\n\r\n    /**\r\n     * The clear function is used to clear the session of a particular key.\r\n     *\r\n     * @param SessionParams key Get the name of the key\r\n     *                      public string get(sessionparams key) {\r\n     *                      return (string)get(key\r\n     * @return Nothing\r\n     * @docauthor Trelent\r\n     */\r\n    public void clear(SessionParams key) {\r\n        put(key.getName(), null);\r\n    }\r\n\r\n    /**\r\n     * The put function is a helper function that allows us to put an object into the session.\r\n     *\r\n     * @param String key Identify the object in the session\r\n     * @param Object value Store the value of a key in the session\r\n     * @return Nothing\r\n     * @docauthor Trelent\r\n     */\r\n    private void put(String key, Object value) {\r\n        getHttpSession().setAttribute(key, value);\r\n    }\r\n\r\n\r\n    /**\r\n     * The exists function checks if a key exists in the session.\r\n     *\r\n     * @param SessionParams key Identify the value that is being searched for\r\n     * @return A boolean value\r\n     * @docauthor Trelent\r\n     */\r\n    public boolean exists(SessionParams key) {\r\n        boolean result = false;\r\n        try {\r\n            Object value = get(key);\r\n            result = Objects.nonNull(value);\r\n        } catch (NullPointerException e) {\r\n            result = false;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * The get function is used to retrieve a value from the session.\r\n     *\r\n     * @param SessionParams key Get the name of the parameter\r\n     * @return The value associated with the key in the session\r\n     * @docauthor Trelent\r\n     */\r\n    @SuppressWarnings(\"unchecked\")\r\n    public <E> E get(SessionParams key) {\r\n        return get(key.getName());\r\n    }\r\n\r\n    /**\r\n     * The get function is used to retrieve an object from the session.\r\n     *\r\n     * @param String key Identify the object in the session\r\n     * @return A value of type e\r\n     * @docauthor Trelent\r\n     */\r\n    @SuppressWarnings(\"unchecked\")\r\n    public <E> E get(String key) {\r\n        return (E) getHttpSession().getAttribute(key);\r\n    }\r\n\r\n    /**\r\n     * The close function invalidates the session, which is a fancy way of saying that it deletes the session.\r\n     * This function is called when a user logs out or closes their browser window.\r\n     *\r\n     * @return Nothing\r\n     * @docauthor Trelent\r\n     */\r\n    public void close() {\r\n        getHttpSession().invalidate();\r\n\r\n    }\r\n\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\security\\SessionUtils.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\security\\TomcatConfiguration.java =====\n```\npackage com.hom.ebmw.configuration.security;\r\n\r\nimport org.apache.coyote.http11.AbstractHttp11JsseProtocol;\r\nimport org.springframework.boot.web.embedded.tomcat.TomcatConnectorCustomizer;\r\nimport org.springframework.context.annotation.Bean;\r\nimport org.springframework.context.annotation.Configuration;\r\n\r\n@Configuration\r\npublic class TomcatConfiguration {\r\n    /**\r\n     * The customizer function is used to customize the Tomcat connector.\r\n     * The function takes a {\r\n     *\r\n     * @return A tomcatconnectorcustomizer\r\n     * @docauthor Trelent\r\n     */\r\n    @Bean\r\n    protected TomcatConnectorCustomizer customizer() {\r\n        return connector -> {\r\n            AbstractHttp11JsseProtocol<?> protocol = (AbstractHttp11JsseProtocol<?>) connector.getProtocolHandler();\r\n            protocol.setKeystorePass(\"eCatadmin\");\r\n            protocol.setTruststorePass(\"eCatadmin\");\r\n        };\r\n    }\r\n}\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\security\\TomcatConfiguration.java =====\n\n===== BEGIN FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\SwaggerConfiguration.java =====\n```\npackage com.hom.ebmw.configuration;\r\n\r\nimport org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties;\r\nimport org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties;\r\nimport org.springframework.boot.actuate.autoconfigure.web.server.ManagementPortType;\r\nimport org.springframework.boot.actuate.endpoint.ExposableEndpoint;\r\nimport org.springframework.boot.actuate.endpoint.web.*;\r\nimport org.springframework.boot.actuate.endpoint.web.annotation.ControllerEndpointsSupplier;\r\nimport org.springframework.boot.actuate.endpoint.web.annotation.ServletEndpointsSupplier;\r\nimport org.springframework.boot.actuate.endpoint.web.servlet.WebMvcEndpointHandlerMapping;\r\nimport org.springframework.context.annotation.Bean;\r\nimport org.springframework.context.annotation.Configuration;\r\nimport org.springframework.core.env.Environment;\r\nimport org.springframework.util.StringUtils;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.Collection;\r\nimport java.util.List;\r\n\r\n@Configuration\r\npublic class SwaggerConfiguration {\r\n\r\n    /* FR 05012023\r\n     * Vaadin 14 MVC frist die Swagger UI\r\n     * Bekannter Patch erst ab Release 23 Hier kÃ¶nnen Seiten vom MVC ausgeschlossen werden\r\n     * Tatu Lund | Release: 23.3.0 |  vaadin.excludeUrls=/swagger-ui/**\r\n     * Quelle: https://stackoverflow.com/questions/71022726/vaadin-blocks-swagger-ui\r\n     */\r\n\r\n    @Bean\r\n    protected WebMvcEndpointHandlerMapping webEndpointServletHandlerMapping(WebEndpointsSupplier webEndpointsSupplier,\r\n                                                                            ServletEndpointsSupplier servletEndpointsSupplier, ControllerEndpointsSupplier controllerEndpointsSupplier,\r\n                                                                            EndpointMediaTypes endpointMediaTypes, CorsEndpointProperties corsProperties,\r\n                                                                            WebEndpointProperties webEndpointProperties, Environment environment) {\r\n        List<ExposableEndpoint<?>> allEndpoints = new ArrayList<ExposableEndpoint<?>>();\r\n        Collection<ExposableWebEndpoint> webEndpoints = webEndpointsSupplier.getEndpoints();\r\n        allEndpoints.addAll(webEndpoints);\r\n        allEndpoints.addAll(servletEndpointsSupplier.getEndpoints());\r\n        allEndpoints.addAll(controllerEndpointsSupplier.getEndpoints());\r\n        String basePath = webEndpointProperties.getBasePath();\r\n        EndpointMapping endpointMapping = new EndpointMapping(basePath);\r\n        boolean shouldRegisterLinksMapping = this.shouldRegisterLinksMapping(webEndpointProperties, environment,\r\n                basePath);\r\n        return new WebMvcEndpointHandlerMapping(endpointMapping, webEndpoints, endpointMediaTypes,\r\n                corsProperties.toCorsConfiguration(), new EndpointLinksResolver(allEndpoints, basePath),\r\n                shouldRegisterLinksMapping, null);\r\n    }\r\n\r\n    private boolean shouldRegisterLinksMapping(WebEndpointProperties webEndpointProperties, Environment environment,\r\n                                               String basePath) {\r\n        return webEndpointProperties.getDiscovery().isEnabled() && (StringUtils.hasText(basePath)\r\n                || ManagementPortType.get(environment).equals(ManagementPortType.DIFFERENT));\r\n    }\r\n}\r\n\n```\n===== END FILE: C:\\Users\\mtheele\\IdeaProjects\\TIP - Assortmenttool_2\\src\\main\\java\\com\\hom\\ebmw\\configuration\\SwaggerConfiguration.java =====\n\n"
  },
  "response" : {
    "id" : "chatcmpl-T2YnwTfkvc7SD2HLqPJ6SIkCan7JMixg",
    "created" : 1762170490,
    "model" : "gpt-oss:120b",
    "object" : "chat.completion",
    "system_fingerprint" : "b1-b0d5299",
    "choices" : [ {
      "finish_reason" : "stop",
      "index" : 0,
      "message" : {
        "content" : "{\n  \"file\": \"project (multiple source files)\",\n  \"issues\": [\n    {\n      \"severity\": \"High\",\n      \"problem\": \"Hardâcoded secrets in source code (Jasypt password & Tomcat keystore passwords).\",\n      \"justification\": \"Embedding passwords in the repo risks credential leakage and enables attackers to decrypt protected properties or TLS keystores.\",\n      \"action\": \"Move passwords to external secret store (e.g., Azure Key Vault, environment variables) and reference them via Spring @Value; add unit tests that verify no secret literals are present.\",\n      \"source\": \"EnCryptConfiguration.stringEncryptor(), TomcatConfiguration.customizer()\",\n      \"component\": \"security\",\n      \"impact_scope\": \"sicherheitskritisch, produktiv relevant\",\n      \"relations\": null,\n      \"evidence\": null\n    },\n    {\n      \"severity\": \"High\",\n      \"problem\": \"Improper use of @Min/@Max on a String property (tempAssortments).\",\n      \"justification\": \"Validation annotations are ignored for nonânumeric types, allowing invalid values that can cause NumberFormatException later.\",\n      \"action\": \"Change property type to Integer and keep @Min/@Max; add fallback validation in ArticleBaseQueueLoader; write tests for invalid config values.\",\n      \"source\": \"ApplicationProperty.tempAssortments, ArticleBaseQueueLoader.startQueue()\",\n      \"component\": \"configuration\",\n      \"impact_scope\": \"prod-relevant\",\n      \"relations\": null,\n      \"evidence\": \"Parse.toInt may throw NPE/NumberFormatException if tempAssortments is nonânumeric\"\n    },\n    {\n      \"severity\": \"Med\",\n      \"problem\": \"Dynamic SQL concatenation in createCacheTable() without sanitisation.\",\n      \"justification\": \"Although tableId originates from config, malicious manipulation could lead to SQL injection or malformed table names.\",\n      \"action\": \"Validate tableId against a whitelist (e.g., numeric pattern) before concatenation; consider using PreparedStatement for DDL if supported; add tests for illegal tableId values.\",\n      \"source\": \"ArticleBaseQueueLoader.createCacheTable(String)\",\n      \"component\": \"data-access\",\n      \"impact_scope\": \"securitykritisch\",\n      \"relations\": null,\n      \"evidence\": null\n    },\n    {\n      \"severity\": \"Med\",\n      \"problem\": \"CSRF protection disabled in HtmlWebSecurityConfigurationAdapter.\",\n      \"justification\": \"Disabling CSRF opens the application to crossâsite request forgery attacks, especially for stateâchanging endpoints.\",\n      \"action\": \"Enable CSRF protection (http.csrf().enable()) and configure token handling for Vaadin; add integration test verifying CSRF token is required.\",\n      \"source\": \"AADOWebAndResourceServerConfig.HtmlWebSecurityConfigurationAdapter.configure(HttpSecurity)\",\n      \"component\": \"security\",\n      \"impact_scope\": \"sicherheitskritisch\",\n      \"relations\": null,\n      \"evidence\": null\n    },\n    {\n      \"severity\": \"Low\",\n      \"problem\": \"Potential NullPointerException in SecurityUtils.getAttributeValue() when authentication is null.\",\n      \"justification\": \"Method assumes SecurityContextHolder.getContext().getAuthentication() is nonânull; can cause NPE during unauthenticated requests.\",\n      \"action\": \"Add null checks for authentication before accessing principal; write tests covering unauthenticated scenarios.\",\n      \"source\": \"SecurityUtils.getAttributeValue(String)\",\n      \"component\": \"security\",\n      \"impact_scope\": \"prod-relevant\",\n      \"relations\": null,\n      \"evidence\": null\n    },\n    {\n      \"severity\": \"Low\",\n      \"problem\": \"SessionUtils stores VaadinSession in a field (vaaadinSession) that may become stale.\",\n      \"justification\": \"If the session expires and a new one is created, the cached reference may point to an invalid session, causing IllegalStateException.\",\n      \"action\": \"Retrieve VaadinSession.getCurrent() inside each method instead of caching; add unit tests simulating session expiration.\",\n      \"source\": \"SessionUtils.vaaadinSession, getHttpSession()\",\n      \"component\": \"session-management\",\n      \"impact_scope\": null,\n      \"relations\": null,\n      \"evidence\": null\n    },\n    {\n      \"severity\": \"Med\",\n      \"problem\": \"ArticleBaseQueueLoader creates many temporary tables on startup without cleanup on failure.\",\n      \"justification\": \"If startQueue aborts after partial creation, leftover tables remain, consuming DB space and causing future conflicts.\",\n      \"action\": \"Wrap table creation in a transaction or add a cleanup routine in a finally block; add integration test that simulates failure and verifies no orphan tables.\",\n      \"source\": \"ArticleBaseQueueLoader.startQueue() / createCacheTable()\",\n      \"component\": \"database\",\n      \"impact_scope\": \"performancekritisch\",\n      \"relations\": null,\n      \"evidence\": null\n    },\n    {\n      \"severity\": \"Low\",\n      \"problem\": \"Inconsistent naming and typos (e.g., 'InitProfil', 'InitalConfig', 'vaaadinSession').\",\n      \"justification\": \"Reduces code readability and may cause confusion or bugs when referenced elsewhere.\",\n      \"action\": \"Rename classes/variables to correct spelling; enforce naming conventions via IDE linting; add codeâreview checklist.\",\n      \"source\": \"InitProfil, InitalConfig, SessionUtils\",\n      \"component\": \"code-quality\",\n      \"impact_scope\": null,\n      \"relations\": null,\n      \"evidence\": null\n    },\n    {\n      \"severity\": \"Low\",\n      \"problem\": \"SwaggerConfiguration overrides Spring Boot actuator endpoint mapping without clear documentation.\",\n      \"justification\": \"Custom endpoint mapping may interfere with actuator health checks in production, leading to unexpected downtime.\",\n      \"action\": \"Document the purpose of the custom mapping; ensure actuator endpoints remain accessible; add tests verifying health endpoint reachable.\",\n      \"source\": \"SwaggerConfiguration.webEndpointServletHandlerMapping()\",\n      \"component\": \"monitoring\",\n      \"impact_scope\": null,\n      \"relations\": null,\n      \"evidence\": null\n    },\n    {\n      \"severity\": \"Med\",\n      \"problem\": \"CustomPermissionEvaluator assumes rolePermission is never null after lookup.\",\n      \"justification\": \"If a user lacks explicit permission entry, getPermission may return null, leading to NullPointerException when accessing rolePerm fields.\",\n      \"action\": \"Add null check after getPermission; treat missing permission as deny; add unit tests for users without permissions.\",\n      \"source\": \"CustomPermissionEvaluator.hasPrivilege()\",\n      \"component\": \"security\",\n      \"impact_scope\": \"prod-relevant\",\n      \"relations\": null,\n      \"evidence\": null\n    }\n  ],\n  \"summary\": {\n    \"overall_rating\": \"3\",\n    \"top_todos\": [\n      \"Externalize all hardâcoded secrets (Jasypt password, keystore passwords).\",\n      \"Fix security misconfigurations: enable CSRF, validate dynamic SQL, and handle missing permissions safely.\",\n      \"Correct configuration property types and add proper validation for numeric values.\"\n    ]\n  }\n}",
        "role" : "assistant",
        "reasoning_content" : "We need to produce JSON review for each file? The prompt: \"Du analysierst jeweils einen Code-Chunk.\" But they gave many files. Probably need a single JSON per file? The schema includes \"file\": path, \"issues\": [...]. Could combine all? But max 10 issues per file/chunk. Probably produce one JSON object per file? However output must be a single JSON object. Might need to aggregate across all files? The schema only supports one file field. Could choose to review one file? The instruction: \"analysierst jeweils einen Code-Chunk.\" Could be per file, but they gave many files. Might need to output for each? But rule 1: \"Antworte immer als ein einziges JSON-Objekt\". So only one object. Could choose the most critical file, maybe pom.xml? But they'd expect review of whole code base? Possibly produce summary with issues across all files aggregated under file \"multiple\". Could set file as \"multiple\" or something. I'll create file: \"project\" and list issues across various files, each issue's source referencing file/line.\n\nNeed max 10 issues total. We'll pick top issues: security config exposing keystore password, hardcoded encryption password, missing validation of property values (tempAssortments as String with Min/Max), potential NPE in ApplicationProperty tempAssortments conversion, using String for numeric property with @Min/@Max which won't work, insecure default exclusion of CSRF disabled, insecure request cache, using plain string for Jasypt password, potential memory leak in ArticleBaseQueueLoader creating many tables, use of raw SQL with concatenation risk injection (tableId), etc.\n\nWe'll list 10 issues with severity.\n\nNow produce JSON."
      },
      "provider_specific_fields" : { }
    } ],
    "usage" : {
      "completion_tokens" : 1853,
      "prompt_tokens" : 25894,
      "total_tokens" : 27747
    },
    "timings" : {
      "cache_n" : 62,
      "prompt_n" : 25832,
      "prompt_ms" : 19206.245,
      "prompt_per_token_ms" : 0.7435059228863424,
      "prompt_per_second" : 1344.9791981722612,
      "predicted_n" : 1853,
      "predicted_ms" : 22391.838,
      "predicted_per_token_ms" : 12.084100377765784,
      "predicted_per_second" : 82.75336754401313
    }
  }
}