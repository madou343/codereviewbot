{
  "timestamp" : "2025-11-03T13:16:14.9593253",
  "label" : "final-aggregation",
  "result_markdown" : {
    "type" : "markdown/text",
    "length" : 7507,
    "lines" : 117,
    "preview_first_line" : "**1️⃣ Top‑Cluster (nach Score absteigend)**  ",
    "body_lines" : [ "**1️⃣ Top‑Cluster (nach Score absteigend)**  ", "", "| Cluster | High/Med/Low | Vorkommen | Score |", "|---|---|---|---|", "| NullPointerException‑Risiken | 8 / 2 / 6 | 16 | **52** |", "| UI‑Thread‑Safety‑Verstöße | 5 / 3 / 0 | 8 | **34** |", "| Eingabe‑/Konfigurations‑Validierung | 3 / 2 / 5 | 10 | **26** |", "| SQL‑Injection / Unsichere dynamische SQL | 3 / 1 / 0 | 4 | **18** |", "| Ressourcen‑Lecks (unclosed Streams, Files, HTTP‑Verbindungen) | 1 / 3 / 4 | 8 | **18** |", "| Hard‑codierte Secrets | 1 / 0 / 0 | 1 | **5** |", "", "---", "", "**2️⃣ Kurzbeispiele pro Cluster**  ", "", "*NullPointerException‑Risiken*  ", "- `SecurityUtils.getAttributeValue()` greift ohne Null‑Check auf `SecurityContextHolder.getContext().getAuthentication()` → NPE bei anonymen Anfragen.  ", "- `BreadBox.getActive()` castet `activeComp` zu `Crumb` ohne `instanceof`‑Prüfung → ClassCastException bzw. NPE bei falschem Component‑Typ.  ", "", "*UI‑Thread‑Safety‑Verstöße*  ", "- `LoaderCrumb.setAssortmentGrid()` registriert einen Selection‑Listener, der `downloadBtn.setEnabled(..)` aufruft, obwohl `downloadBtn` erst später erzeugt wird → NPE aus UI‑Thread‑Race.  ", "- Mehrere Dialoge (z. B. `PromotionBuilderDialog.load()`) starten rohe `Thread`s und rufen danach `ui.access()` auf → Verletzung der Vaadin‑Single‑Thread‑Regel, mögliche Race‑Conditions.  ", "", "*Eingabe‑/Konfigurations‑Validierung*  ", "- `ApplicationProperty.tempAssortments` ist ein `String` mit `@Min/@Max`; Annotationen werden ignoriert → mögliche `NumberFormatException`.  ", "- `MSgraphService.getUsersById()` baut OData‑Filter ohne korrektes Quote‑Handling → fehlerhafte API‑Aufrufe und potenzielle Datenexposition.  ", "", "*SQL‑Injection / Unsichere dynamische SQL*  ", "- `ArticleBaseGetRepository` verwendet String‑Konkatenation für Tabellen‑ und Spaltennamen → Angreifer können beliebige SQL‑Befehle injizieren.  ", "- `FilterBaseCustomRepository` baut Update‑ und Delete‑Statements per String‑Zusammenfügung → gleiche Injection‑Gefahr.  ", "", "*Ressourcen‑Lecks*  ", "- `ExportFileUtils` schreibt mit `FileWriter` ohne `try‑with‑resources`; bei Exception bleiben Dateideskriptoren offen.  ", "- `HttpClientHelper.getResponseStringFromConn` erstellt `BufferedReader` und schließt ihn nicht.  ", "", "*Hard‑codierte Secrets*  ", "- `EnCryptConfiguration.stringEncryptor()` und `TomcatConfiguration.customizer()` enthalten Klartext‑Passwörter für Jasypt und Keystore.  ", "", "---", "", "**3️⃣ Ticket‑Vorlagen**  ", "", "---", "", "**Titel:** NullPointerException‑Risiken in kritischen Utility‑Methoden  ", "**Kurzbeschreibung:** Mehrere Methoden gehen von nicht‑null Objekten aus (z. B. Authentication, Component‑Casts) und werfen bei abweichenden Laufzeitbedingungen NPEs, was zu Anwendungskollapsen führt.  ", "**Komplexitätsklasse:** HIGH  ", "**Mögliche Seiteneffekte:** STABILITY, BEHAVIOR_CHANGE  ", "**Quelle/Komponente:** `SecurityUtils.getAttributeValue()`, `BreadBox.getActive()`, `LoaderCrumb.setDefaultParameterToDataFile()` etc.  ", "**Akzeptanzkriterien:**  ", "- Jeder Zugriff auf potenziell null‑bare Objekte wird mit `Objects.nonNull` bzw. `Optional` geprüft.  ", "- Unit‑Tests decken unauthentifizierte Requests, leere Collections und falsche Component‑Typen ab.  ", "- Keine Methode wirft mehr `NullPointerException` bei gültigen Eingaben.  ", "", "---", "", "**Titel:** UI‑Thread‑Safety‑Verstöße in Vaadin‑Komponenten beheben  ", "**Kurzbeschreibung:** Roh‑Threads greifen auf UI‑Komponenten zu (z. B. `downloadBtn`, Dialog‑Updates), was die Vaadin‑Thread‑Policy verletzt und zu Inkonsistenzen bzw. IllegalStateExceptions führt.  ", "**Komplexitätsklasse:** HIGH  ", "**Mögliche Seiteneffekte:** STABILITY, PERFORMANCE  ", "**Quelle/Komponente:** `LoaderCrumb.setAssortmentGrid()`, `PromotionBuilderDialog.load()`, `PreviewCrumb.loadGrid()` etc.  ", "**Akzeptanzkriterien:**  ", "- Alle Hintergrund‑Tasks nutzen `UI.getCurrent().access(...)` oder einen `ExecutorService` mit UI‑Callback.  ", "- Keine Roh‑Thread‑Instanz mehr im Code‑Base.  ", "- Integration‑Tests prüfen, dass UI‑Updates nach Hintergrund‑Jobs keine Exceptions werfen.  ", "", "---", "", "**Titel:** Fehlende bzw. falsche Eingabe‑ und Konfigurations‑Validierung  ", "**Kurzbeschreibung:** An mehreren Stellen werden Eingaben nicht validiert (z. B. falscher Typ für `@Min/@Max`, unsichere OData‑Filter, fehlende URL‑Parameter‑Checks), wodurch fehlerhafte Daten, Sicherheitslücken und Laufzeit‑Exceptions entstehen können.  ", "**Komplexitätsklasse:** HIGH  ", "**Mögliche Seiteneffekte:** SECURITY, BEHAVIOR_CHANGE, STABILITY  ", "**Quelle/Komponente:** `ApplicationProperty.tempAssortments`, `MSgraphService.getUsersById()`, `ECatView.setParameter()` etc.  ", "**Akzeptanzkriterien:**  ", "- Alle numerischen Property‑Typen nutzen passende Datentypen (Integer) und Bean‑Validation.  ", "- OData‑ und SQL‑Parameter werden über sichere Bindings/Whitelists gebaut.  ", "- URL‑Parameter werden gegen Whitelist/Regex geprüft; fehlende Parameter führen zu klaren Fehlermeldungen.  ", "", "---", "", "**Titel:** Unsichere dynamische SQL – Risiko für SQL‑Injection  ", "**Kurzbeschreibung:** Diverse Repository‑Methoden bauen SQL‑Statements per String‑Konkatenation (z. B. `ArticleBaseGetRepository`, `FilterBaseCustomRepository`, `SQLTemplate`), wodurch Angreifer beliebige SQL einschleusen können.  ", "**Komplexitätsklasse:** HIGH  ", "**Mögliche Seiteneffekte:** SECURITY, STABILITY  ", "**Quelle/Komponente:** `ArticleBaseGetRepository.getArticleAssignedMaterialNotInBasicAssortment`, `FilterBaseCustomRepository.removeByTypeAndAssortment`, `SQLTemplate.reloadGrid()` etc.  ", "**Akzeptanzkriterien:**  ", "- Alle DB‑Abfragen verwenden `PreparedStatement`/`JdbcTemplate` mit Parameter‑Binding.  ", "- Eingaben werden vor Einbindung escaped oder über Whitelist validiert.  ", "- Tests verifizieren, dass schädliche Eingaben zu `DataAccessException` führen und nicht ausgeführt werden.  ", "", "---", "", "**Titel:** Ressourcen‑Lecks durch nicht geschlossene Streams und Writer  ", "**Kurzbeschreibung:** Viele IO‑Operationen (FileWriter, BufferedReader, Zip‑Streams, Http‑Clients) schließen ihre Ressourcen nicht zuverlässig, was zu Dateideskriptor‑ und Speicher‑Lecks führt.  ", "**Komplexitätsklasse:** HIGH  ", "**Mögliche Seiteneffekte:** PERFORMANCE, STABILITY  ", "**Quelle/Komponente:** `ExportFileUtils.buildPriceFile()`, `HttpClientHelper.getResponseStringFromConn()`, `UnzipUtility.unzip()` etc.  ", "**Akzeptanzkriterien:**  ", "- Jede IO‑Operation verwendet `try‑with‑resources` oder schließt im `finally`‑Block.  ", "- Ressourcen‑Leak‑Tests (z. B. mit JUnit‑Temp‑Folder) stellen sicher, dass keine offenen Handles zurückbleiben.  ", "- Logging gibt bei Fehlermeldungen klare Hinweise auf betroffene Ressourcen.  ", "", "---", "", "**Titel:** Hard‑codierte Secrets aus dem Quellcode entfernen  ", "**Kurzbeschreibung:** Passwörter für Jasypt und Tomcat‑Keystore sind im Code hart codiert und können bei Repository‑Zugriffen kompromittiert werden.  ", "**Komplexitätsklasse:** HIGH  ", "**Mögliche Seiteneffekte:** SECURITY, COMPATIBILITY  ", "**Quelle/Komponente:** `EnCryptConfiguration.stringEncryptor()`, `TomcatConfiguration.customizer()`  ", "**Akzeptanzkriterien:**  ", "- Alle Geheimwerte werden aus einem externen Secret‑Store (z. B. Azure Key Vault, Environment‑Variables) geladen.  ", "- Der Code enthält keine Literal‑Passwörter mehr; ein Unit‑Test prüft, dass keine `String`‑Literals mit typischen Passwort‑Mustern vorkommen.  ", "- Integration‑Tests bestätigen, dass die Anwendung ohne lokale Secrets korrekt startet.  ", "", "---  ", "", "*Hinweis:* Jeder Cluster hat genau ein Ticket erhalten – doppelte Ursachen wurden dedupliziert. Sollte in Zukunft kein Finding mehr existieren, würde ein generisches Fallback‑Ticket (z. B. „Qualitätsbaseline herstellen“) erzeugt werden." ]
  }
}